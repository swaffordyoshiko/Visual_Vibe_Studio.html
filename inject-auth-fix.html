<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inject Auth Fix</title>
</head>
<body>
    <h1>Injecting Authentication Fix...</h1>
    <p>This page will automatically inject the authentication fix into the main site.</p>
    
    <script src="comprehensive-auth-ui-fix.js"></script>
    
    <script>
        // This script will inject the fix into the parent window if opened in iframe
        // or provide instructions for manual injection
        
        console.log('üöÄ AUTH FIX INJECTOR: Ready to inject authentication fix');
        
        // If in iframe, try to access parent
        try {
            if (window.parent && window.parent !== window) {
                console.log('üì° Attempting to inject fix into parent window...');
                
                // Copy our fixed functions to parent
                window.parent.openSignInModal = window.openSignInModal;
                window.parent.handleSignIn = window.handleSignIn;
                window.parent.signOut = window.signOut;
                window.parent.updateAuthUI = window.updateAuthUI;
                
                // Run initialization in parent
                if (typeof window.parent.initializeAuth === 'function') {
                    window.parent.initializeAuth();
                }
                
                console.log('‚úÖ Fix injected into parent window');
                
                // Update the parent page
                document.body.innerHTML = '<h1 style="color: green;">‚úÖ Authentication fix injected successfully!</h1><p>The sign-in button and user interface should now work correctly.</p>';
            }
        } catch (e) {
            console.log('‚ö†Ô∏è Cannot access parent window (cross-origin or not in iframe)');
        }
        
        // Provide manual injection instructions
        document.body.innerHTML += `
            <div style="margin: 20px; padding: 20px; background: #f0f8ff; border: 1px solid #0066cc; border-radius: 8px;">
                <h2>Manual Fix Instructions</h2>
                <p>If automatic injection failed, follow these steps:</p>
                <ol>
                    <li>Open the browser Developer Tools (F12)</li>
                    <li>Go to the Console tab</li>
                    <li>Run the following commands:</li>
                </ol>
                <textarea readonly style="width: 100%; height: 100px; font-family: monospace;" onclick="this.select()">
// Copy and paste this into the console:
diagnoseAuthState();
forceUIUpdate();
</textarea>
                <p><strong>Or try these test commands:</strong></p>
                <textarea readonly style="width: 100%; height: 60px; font-family: monospace;" onclick="this.select()">
forceSignIn("test@example.com", "password123");
</textarea>
            </div>
        `;
        
        // Show available functions
        console.log('üîß Available functions injected:');
        console.log('- diagnoseAuthState() - Check system status');
        console.log('- forceUIUpdate() - Fix UI display');  
        console.log('- forceSignIn(email, password) - Test sign-in');
    </script>
</body>
</html>
