<!doctype html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Professional design services for your business. Custom websites, flyers, and business cards. Starting from $50. Visual Vibe Studio - Building brands that stand out."
    />
    <meta
      name="keywords"
      content="web design, business cards, flyers, graphic design, business branding, visual design"
    />
    <meta name="author" content="Visual Vibe Studio" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="/" />
    <meta
      property="og:title"
      content="Visual Vibe Studio - Professional Design Services"
    />
    <meta
      property="og:description"
      content="Custom websites, flyers, and business cards. Professional designs that make your business stand out."
    />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta
      property="twitter:url"
      content="/"
    />
    <meta
      property="twitter:title"
      content="Visual Vibe Studio - Professional Design Services"
    />
    <meta
      property="twitter:description"
      content="Custom websites, flyers, and business cards. Professional designs that make your business stand out."
    />

    <title>
      Visual Vibe Studio | Professional Design Services |
      www.visualvibestudio.store
    </title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"
    ></script>
    <script>
      // Initialize global variables first to prevent temporal dead zone issues
      var selectedRating = 0;
      var showingAllReviews = false;
      var chatInitialized = false;
      var chatOpen = false;
      var currentUser = null;
      var currentOrderData = null;
      var currentOrderSubject = null;
      var currentOrderEmailBody = null;

      // Set window globals
      window.selectedRating = 0;
      window.showingAllReviews = false;
      window.chatInitialized = false;
      window.chatOpen = false;
      window.currentUser = null;

      // Simple chat functions that work immediately
      function simpleSend() {
        console.log('Simple send called!');
        const input = document.getElementById('chatInput');
        if (!input) {
          alert('Chat input not found');
          return;
        }

        const message = input.value.trim();
        if (!message) {
          alert('Please enter a message');
          return;
        }

        console.log('Sending message:', message);

        // Add message to chat
        addSimpleMessage('user', message);

        // Clear input
        input.value = '';
        enableSendButton();

        // Show response
        setTimeout(() => {
          addSimpleMessage('agent', "Thanks for your message! I've received it and will respond shortly. For immediate assistance, call me at (402) 979-7184.");
        }, 1000);
      }

      function enableSendButton() {
        const input = document.getElementById('chatInput');
        const btn = document.getElementById('chatSendBtn');
        if (input && btn) {
          const hasText = input.value.trim().length > 0;
          btn.disabled = !hasText;
          btn.style.opacity = hasText ? '1' : '0.5';
        }
      }

      function addSimpleMessage(type, message) {
        const container = document.getElementById('chatMessages');
        if (!container) return;

        const msgDiv = document.createElement('div');
        msgDiv.className = `chat-message ${type}`;
        msgDiv.innerHTML = `<div>${message}</div>`;
        container.appendChild(msgDiv);
        container.scrollTop = container.scrollHeight;
      }

      // Make functions globally available immediately
      window.simpleSend = simpleSend;
      window.enableSendButton = enableSendButton;
      window.addSimpleMessage = addSimpleMessage;

      // Force reload reviews function
      function forceReloadReviews() {
        console.log('üîÑ Force reloading reviews...');

        // Show loading feedback
        const reloadBtn = document.querySelector('button[onclick="forceReloadReviews()"]');
        if (reloadBtn) {
          const originalText = reloadBtn.innerHTML;
          reloadBtn.innerHTML = '‚è≥ Reloading...';
          reloadBtn.disabled = true;

          setTimeout(() => {
            reloadBtn.innerHTML = originalText;
            reloadBtn.disabled = false;
          }, 1500);
        }

        try {
          if (typeof loadReviews === 'function') {
            loadReviews();
            console.log('‚úÖ Reviews reloaded successfully');

            // Show success message
            if (typeof showAlert === 'function') {
              showAlert('Reviews reloaded successfully!', 'success');
            } else {
              alert('Reviews reloaded successfully!');
            }

            // Scroll to reviews container to show the reload worked
            const reviewsContainer = document.getElementById('reviewsContainer');
            if (reviewsContainer) {
              reviewsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

          } else {
            console.error('‚ùå loadReviews function not found');
            alert('Error: Review system not ready. Please refresh the page.');
          }
        } catch (error) {
          console.error('‚ùå Error reloading reviews:', error);
          alert('Error reloading reviews. Please try again.');
        }
      }

      window.forceReloadReviews = forceReloadReviews;

      // Initialize EmailJS with a working public key
      (function () {
        emailjs.init("eHAEIqw8YtVZP5rYA"); // Public key for contact forms
      })();

      // Define modal functions globally at script start to fix ReferenceError
      function openSignInModal() {
        try {
          console.log('üìù Opening sign in modal...');

          const modal = document.getElementById('signInModal');
          if (!modal) {
            console.error('‚ùå Sign in modal element not found in DOM');
            alert('Sign in modal not available. Please refresh the page.');
            return;
          }

          modal.classList.remove('hidden');
          modal.style.display = 'flex';
          modal.style.opacity = '1';

          const emailInput = document.getElementById('signInEmail');
          if (emailInput) {
            setTimeout(() => emailInput.focus(), 100);
          }

          console.log('‚úÖ Sign in modal opened successfully');
        } catch (error) {
          console.error('‚ùå Error opening sign in modal:', error);
          alert('Error opening sign in form. Please refresh the page.');
        }
      }

      function openSignUpModal() {
        try {
          console.log('üìù Opening sign up modal...');

          const modal = document.getElementById('signUpModal');
          if (!modal) {
            console.error('‚ùå Sign up modal element not found in DOM');
            alert('Sign up modal not available. Please refresh the page.');
            return;
          }

          modal.classList.remove('hidden');
          modal.style.display = 'flex';
          modal.style.opacity = '1';

          const nameInput = document.getElementById('signUpName');
          if (nameInput) {
            setTimeout(() => nameInput.focus(), 100);
          }

          console.log('‚úÖ Sign up modal opened successfully');
        } catch (error) {
          console.error('‚ùå Error opening sign up modal:', error);
          alert('Error opening sign up form. Please refresh the page.');
        }
      }

      function closeSignInModal() {
        try {
          const modal = document.getElementById('signInModal');
          if (modal) {
            modal.classList.add('hidden');
            modal.style.display = 'none';
          }
          const form = document.getElementById('signInForm');
          if (form) {
            form.reset();
          }
        } catch (error) {
          console.error('Error closing sign in modal:', error);
        }
      }

      function closeSignUpModal() {
        try {
          const modal = document.getElementById('signUpModal');
          if (modal) {
            modal.classList.add('hidden');
            modal.style.display = 'none';
          }
          const form = document.getElementById('signUpForm');
          if (form) {
            form.reset();
          }
        } catch (error) {
          console.error('Error closing sign up modal:', error);
        }
      }

      function switchToSignUp() {
        closeSignInModal();
        openSignUpModal();
      }

      function switchToSignIn() {
        closeSignUpModal();
        openSignInModal();
      }

      // Make functions available globally
      window.openSignInModal = openSignInModal;
      window.openSignUpModal = openSignUpModal;
      window.closeSignInModal = closeSignInModal;
      window.closeSignUpModal = closeSignUpModal;
      window.switchToSignUp = switchToSignUp;
      window.switchToSignIn = switchToSignIn;

      // Define quick action functions globally at script start to fix ReferenceError
      function callDirectly() {
        try {
          if (typeof trackChatEvent === 'function') {
            trackChatEvent('call_attempted');
          }
          window.location.href = 'tel:+14029797184';
          if (typeof addAgentMessage === 'function') {
            addAgentMessage("üìû Calling now... If I don't answer, please leave a voicemail and I'll call you back ASAP!");
          }
        } catch (error) {
          console.error('Error in callDirectly:', error);
          window.location.href = 'tel:+14029797184';
        }
      }

      function emailDirectly() {
        try {
          if (typeof trackChatEvent === 'function') {
            trackChatEvent('email_attempted');
          }
          const subject = encodeURIComponent('Visual Vibe Studio - Inquiry from Website Chat');
          const body = encodeURIComponent(`Hi Yoshiko,

I was using the chat on your website and wanted to reach out directly.

Customer Information:
${window.currentUser ? `Name: ${window.currentUser.name}\nEmail: ${window.currentUser.email}` : 'Website Visitor (not signed in)'}

Please get back to me when you have a chance!

Thanks,`);

          const emailUrl = `mailto:support@visualvibestudio.store?subject=${subject}&body=${body}`;

          // Check if we're on mobile
          const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

          if (isMobile) {
            // On mobile, try to open email app directly
            window.open(emailUrl, '_blank');
            if (typeof addAgentMessage === 'function') {
              addAgentMessage("üìß Opening your email app! I'll respond to your email as soon as possible.");
            }
          } else {
            // On desktop, provide options
            if (typeof showEmailOptionsModal === 'function') {
              showEmailOptionsModal('support@visualvibestudio.store');
            } else {
              window.open(emailUrl, '_blank');
            }
            if (typeof addAgentMessage === 'function') {
              addAgentMessage("üìß I've opened contact options for you. Choose your preferred way to email me!");
            }
          }
        } catch (error) {
          console.error('Error in emailDirectly:', error);
          const emailUrl = 'mailto:support@visualvibestudio.store';
          window.open(emailUrl, '_blank');
          if (typeof addAgentMessage === 'function') {
            addAgentMessage("ÔøΩÔøΩ To email me directly, please use: support@visualvibestudio.store or call me at (402) 979-7184");
          }
        }
      }

      // Make quick action functions available globally
      window.callDirectly = callDirectly;
      window.emailDirectly = emailDirectly;

      // Test function to debug send message
      function testSendMessage() {
        console.log('üß™ Test send message called');
        console.log('sendMessage function exists:', typeof sendMessage);
        console.log('window.sendMessage exists:', typeof window.sendMessage);

        const input = document.getElementById('chatInput');
        if (input) {
          input.value = 'Test message from debug button';
          updateSendButton();
          console.log('Set test message, calling sendMessage...');
          sendMessage();
        } else {
          console.error('Chat input not found');
        }
      }

      window.testSendMessage = testSendMessage;

      // Test Venmo payment function
      function testVenmoPayment() {
        console.log('üß™ Testing Venmo payment...');
        const testPricing = { total: "100.00", deposit: "50.00" };
        const testOrderData = {
          businessName: "Test Business",
          services: ["Website Design", "Logo Design"],
          email: "test@example.com"
        };

        try {
          showVenmoPayment(testPricing, testOrderData, "TEST-ORDER-123");
          console.log('ÔøΩÔøΩ Test Venmo payment completed');
        } catch (error) {
          console.error('‚ùå Test Venmo payment failed:', error);
        }
      }

      window.testVenmoPayment = testVenmoPayment;

      // Simple order submission that always works (prevents any redirects)
      function simpleOrderSubmit(event) {
        try {
          console.log('üöÄ Simple order submit clicked!');

          // Prevent any form submission or page redirect
          if (event) {
            event.preventDefault();
            event.stopPropagation();
          }

          // Get basic form data
          const form = document.getElementById('orderForm');
        if (!form) {
          alert('Form not found');
          return;
        }

        // Validate required fields first
        const businessName = form.querySelector('input[name="businessName"]')?.value?.trim();
        const industry = form.querySelector('input[name="industry"]')?.value?.trim();
        const email = form.querySelector('input[name="email"]')?.value?.trim();
        const services = form.querySelector('select[name="services"]');

        console.log('üìù Form validation starting...');
        console.log('üìù Form data:', { businessName, industry, email, services: services?.selectedOptions?.length });

        // Check required fields
        if (!businessName) {
          console.log('‚ùå Missing business name');
          alert('Please enter your business name');
          form.querySelector('input[name="businessName"]')?.focus();
          return false;
        }

        if (!industry) {
          console.log('‚ùå Missing industry');
          alert('Please enter your business industry');
          form.querySelector('input[name="industry"]')?.focus();
          return false;
        }

        if (!email || !email.includes('@')) {
          console.log('‚ùå Invalid email');
          alert('Please enter a valid email address');
          form.querySelector('input[name="email"]')?.focus();
          return false;
        }

        if (!services || services.selectedOptions.length === 0) {
          console.log('‚ùå No services selected');
          alert('Please select at least one service');
          services?.focus();
          return false;
        }

        console.log('‚úÖ Form validation passed');

        // Collect remaining form data
        const phone = form.querySelector('input[name="phone"]')?.value || 'Not provided';
        const dueDate = form.querySelector('input[name="dueDate"]')?.value || 'Not specified';
        const details = form.querySelector('textarea[name="details"]')?.value || 'No additional details';

        let selectedServices = [];
        let totalAmount = 0;

        if (services && services.selectedOptions.length > 0) {
          selectedServices = Array.from(services.selectedOptions).map(opt => opt.text);
          // Calculate total from selected services
          totalAmount = Array.from(services.selectedOptions).reduce((total, opt) => {
            const price = parseInt(opt.getAttribute('data-price')) || 50;
            return total + price;
          }, 0);
        }

        const depositAmount = (totalAmount * 0.5).toFixed(2); // 50% deposit

        console.log('Order details:', { businessName, selectedServices, totalAmount, depositAmount });

        // Show loading state
        const submitBtn = document.getElementById('submitOrderBtn');
        const submitBtnText = document.getElementById('submitBtnText');
        if (submitBtn && submitBtnText) {
          submitBtnText.textContent = 'Processing Order...';
          submitBtn.disabled = true;
        }

        // Show simple Venmo payment
        showSimpleVenmoPayment(depositAmount, businessName, selectedServices);

        // Send email with order details
        sendOrderEmail({
          businessName,
          industry,
          email,
          phone,
          dueDate,
          details,
          selectedServices,
          totalAmount: totalAmount.toFixed(2),
          depositAmount
        });

        } catch (error) {
          console.error('‚ùå Error in simpleOrderSubmit:', error);
          alert('There was an error processing your order. Please try again or contact support at (402) 979-7184');

          // Reset button state
          const submitBtn = document.getElementById('submitOrderBtn');
          const submitBtnText = document.getElementById('submitBtnText');
          if (submitBtn && submitBtnText) {
            submitBtnText.textContent = 'Start My Project Now';
            submitBtn.disabled = false;
          }
        }

        // Always prevent form submission
        return false;
      }

      function showSimpleVenmoPayment(depositAmount, businessName, services) {
        console.log('üí≥ Showing simple Venmo payment...');

        const container = document.getElementById('paypal-button-container');
        if (!container) {
          alert('Payment container not found');
          return;
        }

        const venmoNote = `Visual Vibe Studio - 50% Deposit for ${businessName} (${services.join(', ')})`;
        const venmoLink = `venmo://paycharge?txn=pay&recipients=Yoshiko-Swafford&amount=${depositAmount}&note=${encodeURIComponent(venmoNote)}`;

        console.log('üí∞ Generated Venmo link:', venmoLink);
        console.log('üí∞ Venmo note:', venmoNote);

        container.innerHTML = `
          <div class="bg-blue-50 border-2 border-blue-200 rounded-xl p-6 mt-6">
            <div class="text-center mb-6">
              <div class="bg-blue-600 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-3">
                üí≥
              </div>
              <h4 class="text-xl font-bold text-gray-800 mb-2">Pay Your Deposit</h4>
              <p class="text-gray-600">Send your 50% deposit to get started</p>
            </div>

            <div class="bg-white rounded-lg p-4 mb-6 border border-gray-200">
              <h5 class="font-semibold text-gray-800 mb-3">Order Summary</h5>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span class="text-gray-600">Business:</span>
                  <span class="font-medium">${businessName}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-600">Services:</span>
                  <span class="font-medium">${services.join(', ')}</span>
                </div>
                <div class="flex justify-between border-t pt-2 mt-2">
                  <span class="text-gray-600">Deposit (50%):</span>
                  <span class="font-bold text-lg text-green-600">$${depositAmount}</span>
                </div>
              </div>
            </div>

            <div class="text-center space-y-4">
              <p class="text-gray-700 font-medium">Send payment to:</p>
              <div class="bg-blue-100 rounded-lg p-3 inline-block">
                <span class="text-2xl font-bold text-blue-800">@Yoshiko-Swafford</span>
              </div>

              <div class="space-y-3">
                <button type="button" onclick="openVenmoApp('${depositAmount}', '${businessName.replace(/'/g, '')}')" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                  üèß Open Venmo App
                </button>

                <button type="button" id="copyVenmoBtn" data-amount="${depositAmount}" data-business="${businessName}" onclick="copyVenmoInfoFromData()" class="w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-200 transition-colors">
                  üìã Copy Payment Details
                </button>
              </div>

              <div class="text-sm text-gray-600 bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-4">
                <p class="font-medium mb-1">üì± Can't open Venmo?</p>
                <p>Copy the details above and pay manually via the Venmo app or call (402) 979-7184</p>
              </div>
            </div>
          </div>
        `;

        container.classList.remove('hidden');
        container.style.display = 'block';

        // Scroll to payment
        setTimeout(() => {
          container.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);

        console.log('‚úÖ Simple Venmo payment displayed successfully!');
      }

      function copyVenmoInfo(amount, businessName) {
        try {
          console.log('üìã Copy Venmo info clicked:', { amount, businessName });

          // Clean up parameters in case they contain quotes or special characters
          const cleanAmount = String(amount || '0.00').replace(/['"]/g, '');
          const cleanBusinessName = String(businessName || 'Customer').replace(/['"]/g, '');

          const text = `Venmo: @Yoshiko-Swafford\nAmount: $${cleanAmount}\nNote: Visual Vibe Studio - 50% Deposit for ${cleanBusinessName}`;

          if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(text).then(() => {
              showAlert('Payment details copied to clipboard!', 'success');
              console.log('‚úÖ Venmo details copied successfully');
            }).catch(() => {
              showAlert(`Payment Details:\n\n${text}`, 'info');
            });
          } else {
            // Fallback for older browsers or non-secure contexts
            showAlert(`Payment Details:\n\n${text}`, 'info');
          }
        } catch (error) {
          console.error('Error copying Venmo info:', error);
          showAlert('Error copying payment details. Please contact (402) 979-7184', 'error');
        }
      }

      // Open Venmo app or website based on device
      function openVenmoApp(amount, businessName) {
        try {
          console.log('üèß Opening Venmo for payment:', { amount, businessName });

          // Provide immediate feedback
          showAlert('Opening Venmo for payment...', 'info');

          const cleanAmount = String(amount || '0.00').replace(/['"]/g, '');
          const cleanBusinessName = String(businessName || 'Customer').replace(/['"]/g, '');

          const venmoNote = `Visual Vibe Studio - 50% Deposit for ${cleanBusinessName}`;

          // Check if we're on mobile (more likely to have Venmo app)
          const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

          if (isMobile) {
            // On mobile, try Venmo app first, then website fallback
            const venmoAppLink = `venmo://paycharge?txn=pay&recipients=Yoshiko-Swafford&amount=${cleanAmount}&note=${encodeURIComponent(venmoNote)}`;
            console.log('üì± Trying mobile app first:', venmoAppLink);

            // Try to open the app
            window.location.href = venmoAppLink;

            // Fallback to website after short delay if app doesn't open
            setTimeout(() => {
              openVenmoWebsite(cleanAmount, cleanBusinessName);
            }, 2500);

          } else {
            // On desktop, go directly to Venmo website
            console.log('üñ•Ô∏è Desktop detected, opening Venmo website');
            openVenmoWebsite(cleanAmount, cleanBusinessName);
          }

        } catch (error) {
          console.error('Error opening Venmo:', error);
          openVenmoWebsite(amount, businessName);
        }
      }

      // Open Venmo website for payment
      function openVenmoWebsite(amount, businessName) {
        try {
          console.log('üåê Opening Venmo website for payment');

          const cleanAmount = String(amount || '0.00').replace(/['"]/g, '');
          const cleanBusinessName = String(businessName || 'Customer').replace(/['"]/g, '');

          // Venmo website URL for sending payment
          const venmoWebUrl = `https://venmo.com/u/Yoshiko-Swafford?txn=pay&amount=${cleanAmount}&note=${encodeURIComponent(`Visual Vibe Studio - 50% Deposit for ${cleanBusinessName}`)}`;

          console.log('üîó Opening Venmo website:', venmoWebUrl);

          // Open in new tab
          const venmoWindow = window.open(venmoWebUrl, '_blank', 'noopener,noreferrer');

          if (venmoWindow) {
            showAlert('Venmo opened in new tab. Complete your payment there!', 'success');
          } else {
            // Popup blocked, try direct navigation
            window.location.href = venmoWebUrl;
          }

        } catch (error) {
          console.error('Error opening Venmo website:', error);
          showVenmoManualInstructions(amount, businessName);
        }
      }

      // Show manual Venmo instructions as final fallback
      function showVenmoManualInstructions(amount, businessName) {
        const message = `Pay via Venmo manually:

üí≥ Venmo Username: @Yoshiko-Swafford
üí∞ Amount: $${amount}
ÔøΩÔøΩ Note: Visual Vibe Studio - 50% Deposit for ${businessName}

Options:
‚Ä¢ Use the Venmo app on your phone
‚Ä¢ Visit venmo.com on any device
‚Ä¢ Call (402) 979-7184 for phone payment

Your order is confirmed - just complete the payment when convenient!`;

        showAlert(message, 'info');
      }

      // Copy Venmo info from button data attributes (safer method)
      function copyVenmoInfoFromData() {
        try {
          console.log('üìã Copy Venmo details button clicked');

          const button = document.getElementById('copyVenmoBtn');
          if (!button) {
            console.error('Copy Venmo button not found');
            showAlert('Error: Copy button not found', 'error');
            return;
          }

          const amount = button.dataset.amount || '0.00';
          const businessName = button.dataset.business || 'Customer';

          console.log('Venmo details:', { amount, businessName });

          const text = `Venmo: @Yoshiko-Swafford\nAmount: $${amount}\nNote: Visual Vibe Studio - 50% Deposit for ${businessName}`;

          if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(text).then(() => {
              showAlert('Payment details copied to clipboard!', 'success');
              console.log('‚úÖ Venmo details copied successfully');
            }).catch(() => {
              showAlert(`Payment Details:\n\n${text}`, 'info');
            });
          } else {
            // Fallback for older browsers
            showAlert(`Payment Details:\n\n${text}`, 'info');
          }
        } catch (error) {
          console.error('Error copying Venmo details:', error);
          showAlert('Error copying payment details. Please contact (402) 979-7184', 'error');
        }
      }

      // Send order details via improved email system
      function sendOrderEmail(orderData) {
        console.log('üìß Processing order email...');

        try {
          const subject = `New Project Order from ${orderData.businessName}`;
          const emailBody = `NEW PROJECT ORDER RECEIVED!

Business Information:
- Business Name: ${orderData.businessName}
- Industry: ${orderData.industry}
- Contact Email: ${orderData.email}
- Phone Number: ${orderData.phone}
- Due Date: ${orderData.dueDate}

Services Requested:
${orderData.selectedServices.map(service => `- ${service}`).join('\n')}

Project Details:
${orderData.details}

Pricing:
- Total Project Cost: $${orderData.totalAmount}
- Deposit Amount (50%): $${orderData.depositAmount}

Payment Method: Venmo (@Yoshiko-Swafford)

This customer has been shown the Venmo payment details and should be sending payment shortly.

---
Order submitted from Visual Vibe Studio website
Date: ${new Date().toLocaleString()}
Reply to customer at: ${orderData.email}`;

          // Show order confirmation immediately
          showOrderConfirmation(orderData, subject, emailBody);

          // Automatically send order to business email multiple ways
          sendOrderToBusinessEmail(orderData, subject, emailBody);

          console.log('‚úÖ Order processed successfully!');

        } catch (error) {
          console.error('‚ùå Error processing order:', error);
          showOrderConfirmation(orderData, 'Order Received', 'Order submitted successfully! Please check the payment details below.');
        }
      }

      // Send order to business email automatically using multiple reliable methods
      function sendOrderToBusinessEmail(orderData, subject, emailBody) {
        console.log('üìß Automatically sending order to business email...');
        console.log('üìß Order data:', orderData);
        console.log('üìß Subject:', subject);

        // Method 1: Try EmailJS with working configuration
        sendViaEmailJS(orderData, subject, emailBody);

        // Method 2: Backup with Web3Forms
        setTimeout(() => {
          sendViaWeb3Forms(orderData, subject, emailBody);
        }, 2000);

        // Method 3: Create downloadable backup
        createDownloadableOrderBackup(orderData, subject, emailBody);
      }

      // Show order details for manual email sending
      function showOrderDetailsForEmail(orderData, subject, emailBody) {
        console.log('üìß Showing order details for manual email...');

        // Create a simple alert with order details
        const orderSummary = `ORDER DETAILS TO EMAIL:

TO: support@visualvibestudio.store
SUBJECT: ${subject}

Business: ${orderData.businessName}
Industry: ${orderData.industry}
Email: ${orderData.email}
Phone: ${orderData.phone}
Services: ${orderData.selectedServices.join(', ')}
Total: $${orderData.totalAmount}
Deposit: $${orderData.depositAmount}
Due Date: ${orderData.dueDate}

Details: ${orderData.details}

A backup file with complete details has been downloaded.
Please email this information to support@visualvibestudio.store`;

        // Show order details in a way that won't navigate away
        if (confirm(orderSummary + '\n\nWould you like to copy this to your clipboard?')) {
          if (navigator.clipboard) {
            navigator.clipboard.writeText(`TO: support@visualvibestudio.store\nSUBJECT: ${subject}\n\n${emailBody}`).then(() => {
              alert('Order details copied to clipboard! Please paste into your email client and send to support@visualvibestudio.store');
            }).catch(() => {
              alert('Please manually copy the order details shown above and email to support@visualvibestudio.store');
            });
          } else {
            alert('Please manually copy the order details shown above and email to support@visualvibestudio.store');
          }
        }

        console.log('üìß Order details displayed successfully');
      }

      // Send order via Web3Forms (reliable free email service)
      function sendOrderViaWeb3Forms(orderData, subject, emailBody) {
        console.log('üìß Attempting to send via Web3Forms...');

        const formData = new FormData();
        formData.append('access_key', 'a1b2c3d4-e5f6-7890-abcd-ef1234567890'); // You'll need to get a real access key from web3forms.com
        formData.append('subject', subject);
        formData.append('from_name', orderData.businessName);
        formData.append('email', orderData.email);
        formData.append('message', emailBody);

        // Additional order details as separate fields
        formData.append('business_name', orderData.businessName);
        formData.append('industry', orderData.industry);
        formData.append('phone', orderData.phone);
        formData.append('services', orderData.selectedServices.join(', '));
        formData.append('total_amount', orderData.totalAmount);
        formData.append('deposit_amount', orderData.depositAmount);
        formData.append('due_date', orderData.dueDate);
        formData.append('details', orderData.details);

        console.log('üìß Sending to Web3Forms...');

        fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          body: formData
        }).then(response => {
          console.log('üìß Web3Forms response status:', response.status);
          if (response.ok) {
            return response.json();
          } else {
            throw new Error(`Web3Forms failed with status: ${response.status}`);
          }
        }).then(data => {
          console.log('‚úÖ Order sent via Web3Forms!', data);
          showAlert('Order successfully sent to Visual Vibe Studio!', 'success');
        }).catch(error => {
          console.log('‚ùå Web3Forms failed, trying Netlify fallback...', error);
          sendOrderViaNetlify(orderData, subject, emailBody);
        });
      }

      // Fallback: Send via Netlify Forms
      function sendOrderViaNetlify(orderData, subject, emailBody) {
        console.log('üìß Attempting to send via Netlify Forms...');

        const formData = new FormData();
        formData.append('form-name', 'order-submissions');
        formData.append('subject', subject);
        formData.append('business-name', orderData.businessName);
        formData.append('industry', orderData.industry);
        formData.append('email', orderData.email);
        formData.append('phone', orderData.phone);
        formData.append('services', orderData.selectedServices.join(', '));
        formData.append('total-amount', orderData.totalAmount);
        formData.append('deposit-amount', orderData.depositAmount);
        formData.append('due-date', orderData.dueDate);
        formData.append('details', orderData.details);
        formData.append('message', emailBody);

        fetch('/', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: new URLSearchParams(formData)
        }).then(response => {
          console.log('üìß Netlify response status:', response.status);
          if (response.ok) {
            console.log('‚úÖ Order sent via Netlify Forms!');
            showAlert('Order successfully sent to Visual Vibe Studio!', 'success');
          } else {
            throw new Error(`Netlify failed with status: ${response.status}`);
          }
        }).catch(error => {
          console.log('‚ùå Netlify failed, trying mailto fallback...', error);
          sendOrderViaMailto(orderData, subject, emailBody);
        });
      }

      // Primary method: Generate mailto link (most reliable)
      function sendOrderViaMailto(orderData, subject, emailBody) {
        console.log('üìß Sending order via email client...');

        // Create a cleaner, shorter email body for mailto
        const shortEmailBody = `NEW PROJECT ORDER

Business: ${orderData.businessName}
Industry: ${orderData.industry}
Email: ${orderData.email}
Phone: ${orderData.phone}
Services: ${orderData.selectedServices.join(', ')}
Total: $${orderData.totalAmount}
Deposit: $${orderData.depositAmount}
Due Date: ${orderData.dueDate}

Project Details:
${orderData.details}

Payment Method: Venmo (@Yoshiko-Swafford)
Order Date: ${new Date().toLocaleString()}`;

        const mailtoUrl = `mailto:support@visualvibestudio.store?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(shortEmailBody)}`;

        console.log('üìß Opening email client...');

        // Try to open default email client
        const emailWindow = window.open(mailtoUrl, '_blank');

        // Log complete order details for manual processing
        console.log('üìß COMPLETE ORDER DETAILS:');
        console.log('=====================================');
        console.log('Business Name:', orderData.businessName);
        console.log('Industry:', orderData.industry);
        console.log('Email:', orderData.email);
        console.log('Phone:', orderData.phone);
        console.log('Services:', orderData.selectedServices.join(', '));
        console.log('Total Amount:', orderData.totalAmount);
        console.log('Deposit Amount:', orderData.depositAmount);
        console.log('Due Date:', orderData.dueDate);
        console.log('Details:', orderData.details);
        console.log('Full Email Body:', emailBody);
        console.log('=====================================');

        // Save order to localStorage as backup
        try {
          const orders = JSON.parse(localStorage.getItem('pendingOrders') || '[]');
          orders.push({
            ...orderData,
            orderDate: new Date().toISOString(),
            emailBody: emailBody,
            subject: subject
          });
          localStorage.setItem('pendingOrders', JSON.stringify(orders));
          console.log('üìß Order saved to localStorage for backup');
        } catch (error) {
          console.error('Error saving order to localStorage:', error);
        }

        // Show success message
        showAlert('Order submitted! Your email client should open with the order details. Please send the email to complete your order.', 'success');
      }

      // Create downloadable backup of order details
      function createDownloadableOrderBackup(orderData, subject, emailBody) {
        console.log('ÔøΩÔøΩ Creating downloadable order backup...');

        const orderText = `${emailBody}

==========================================
BACKUP ORDER DETAILS - ${new Date().toLocaleString()}
==========================================

To: support@visualvibestudio.store
Subject: ${subject}

If your email client didn't open automatically, please copy this information and email it to support@visualvibestudio.store

Thank you for your order!
Visual Vibe Studio`;

        try {
          // Create downloadable file
          const blob = new Blob([orderText], { type: 'text/plain' });
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `order-backup-${orderData.businessName.replace(/[^a-zA-Z0-9]/g, '-')}-${Date.now()}.txt`;
          document.body.appendChild(a);
          a.click();
          window.URL.revokeObjectURL(url);
          document.body.removeChild(a);

          console.log('üì• Order backup file downloaded');

          // Show additional message after a delay
          setTimeout(() => {
            showAlert('Order backup file downloaded! If email client didn\'t open, you can email the downloaded file to support@visualvibestudio.store', 'info');
          }, 2000);

        } catch (error) {
          console.error('Error creating download backup:', error);
        }
      }

      // Keep the SMS backup function for final fallback
      // (This function is defined later in the code)

      // SMS backup notification
      function sendOrderViaSMSBackup(orderData, subject) {
        console.log('üì± Sending SMS backup notification...');

        const smsMessage = `NEW ORDER: ${orderData.businessName} ordered ${orderData.selectedServices.join(', ')} for $${orderData.totalAmount}. Contact: ${orderData.email}, ${orderData.phone}`;

        // Log order details for manual processing
        console.log('üìã Order for manual processing:', {
          subject,
          orderData,
          smsMessage
        });

        showAlert('Order received! You will be contacted within 24 hours via email or phone.', 'success');
      }

      // Global order data storage for modal functions
      // currentOrderData, currentOrderSubject, currentOrderEmailBody already initialized at top of script

      // Show order confirmation modal instead of blank page
      function showOrderConfirmation(orderData, subject, emailBody) {
        // Store order data globally for modal functions
        currentOrderData = orderData;
        currentOrderSubject = subject;
        currentOrderEmailBody = emailBody;

        // Update button to show success
        const submitBtn = document.getElementById('submitOrderBtn');
        const submitBtnText = document.getElementById('submitBtnText');
        if (submitBtn && submitBtnText) {
          submitBtnText.textContent = 'Order Submitted! ‚úÖ';
          submitBtn.classList.add('bg-green-600');
          submitBtn.classList.remove('bg-gradient-to-r', 'from-indigo-600', 'to-purple-600');
        }

        // Create confirmation modal
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
        modal.onclick = (e) => {
          if (e.target === modal) closeOrderModal();
        };

        modal.innerHTML = `
          <div class="bg-white rounded-xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="text-center mb-6">
              <div class="bg-green-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </div>
              <h3 class="text-2xl font-bold text-gray-800 mb-2">Order Submitted Successfully!</h3>
              <p class="text-gray-600">Thank you ${orderData.businessName}! Your order has been received and processed.</p>
            </div>

            <div class="bg-gray-50 rounded-lg p-6 mb-6">
              <h4 class="font-bold text-gray-800 mb-4">Order Summary</h4>
              <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                  <span class="text-gray-600">Business:</span>
                  <span class="font-medium">${orderData.businessName}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-600">Industry:</span>
                  <span class="font-medium">${orderData.industry}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-600">Services:</span>
                  <span class="font-medium">${orderData.selectedServices.join(', ')}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-gray-600">Total Cost:</span>
                  <span class="font-medium">$${orderData.totalAmount}</span>
                </div>
                <div class="flex justify-between border-t pt-2">
                  <span class="text-gray-600">Deposit Required:</span>
                  <span class="font-bold text-green-600">$${orderData.depositAmount}</span>
                </div>
              </div>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
              <h4 class="font-bold text-blue-800 mb-2">Next Steps:</h4>
              <ol class="list-decimal list-inside text-blue-700 space-y-1">
                <li>Complete your Venmo payment using the details shown above</li>
                <li>You'll receive a confirmation email within 24 hours</li>
                <li>Your project will begin once payment is confirmed</li>
                <li>Estimated completion: ${orderData.dueDate || 'Within 5-7 business days'}</li>
              </ol>
            </div>

            <div class="space-y-4">
              <div class="flex space-x-4">
                <button onclick="copyOrderDetails()" class="flex-1 bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-semibold hover:bg-gray-200 transition-colors">
                  üìã Copy Order Details
                </button>
                <button type="button" onclick="sendOrderEmailNow(); return false;" class="flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                  üìß Send Email
                </button>
              </div>
              <button type="button" onclick="closeOrderModal(); return false;" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-700 transition-colors">
                ‚úÖ Complete Order
              </button>
            </div>

            <div class="text-center mt-6 text-sm text-gray-500">
              Questions? Call (402) 979-7184 or email support@visualvibestudio.store
            </div>
          </div>
        `;

        document.body.appendChild(modal);
        document.body.style.overflow = 'hidden';

        // Show success alert
        showAlert('Order submitted successfully! Complete your payment to begin.', 'success');
      }

      // Copy order details function
      function copyOrderDetails() {
        try {
          console.log('üìã Copy order details button clicked!');
          if (!currentOrderData) {
            console.error('No order data available');
            showAlert('No order data available to copy', 'error');
            return;
          }

          const details = `ORDER DETAILS:
Business: ${currentOrderData.businessName}
Industry: ${currentOrderData.industry}
Email: ${currentOrderData.email}
Phone: ${currentOrderData.phone}
Services: ${currentOrderData.selectedServices.join(', ')}
Total: $${currentOrderData.totalAmount}
Deposit: $${currentOrderData.depositAmount}
Due Date: ${currentOrderData.dueDate}

Venmo Payment: @Yoshiko-Swafford
Amount: $${currentOrderData.depositAmount}

Details: ${currentOrderData.details}`;

          copyToClipboard(details, 'Order details copied to clipboard!');
        } catch (error) {
          console.error('Error copying order details:', error);
          showAlert('Error copying details. Please try again.', 'error');
        }
      }

      // Send email manually function
      function sendEmailManually() {
        try {
          console.log('üìß Send email button clicked!');
          if (!currentOrderSubject || !currentOrderEmailBody) {
            console.error('No order email data available');
            showAlert('No order email data available', 'error');
            return;
          }

          console.log('üìß Sending email manually...');

          const mailtoLink = `mailto:support@visualvibestudio.store?subject=${encodeURIComponent(currentOrderSubject)}&body=${encodeURIComponent(currentOrderEmailBody)}`;

          // Try to open email client
          const emailWindow = window.open(mailtoLink, '_blank');

          // Provide feedback
          showAlert('Opening your email client...', 'info');

          // If window failed to open, provide fallback
          setTimeout(() => {
            if (!emailWindow || emailWindow.closed || emailWindow.location === 'about:blank') {
              copyToClipboard(`To: support@visualvibestudio.store\nSubject: ${currentOrderSubject}\n\n${currentOrderEmailBody}`, 'Email details copied! Please paste into your email client.');
            }
          }, 2000);

        } catch (error) {
          console.error('Error opening email:', error);
          copyToClipboard(`To: support@visualvibestudio.store\nSubject: ${currentOrderSubject}\n\n${currentOrderEmailBody}`, 'Email details copied! Please paste into your email client.');
        }
      }

      // Simple function to handle email sending without navigation
      function sendOrderEmailNow() {
        try {
          console.log('üìß Processing email request...');
          if (!currentOrderData || !currentOrderSubject || !currentOrderEmailBody) {
            console.error('No order data available');
            alert('No order data available. Please submit your order again.');
            return false;
          }

          // Show loading state
          const sendButton = document.querySelector('button[onclick="sendOrderEmailNow()"]');
          if (sendButton) {
            sendButton.textContent = 'üìß Processing...';
            sendButton.disabled = true;
          }

          // Show order details without navigating
          showOrderDetailsForEmail(currentOrderData, currentOrderSubject, currentOrderEmailBody);

          // Update button
          setTimeout(() => {
            if (sendButton) {
              sendButton.textContent = '‚úÖ Details Shown!';
              sendButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
              sendButton.classList.add('bg-green-600', 'hover:bg-green-700');
            }
          }, 1000);

          return false; // Prevent any form submission

        } catch (error) {
          console.error('Error processing email:', error);
          alert('Error processing email. Please call (402) 979-7184 for assistance.');
          return false;
        }
      }

      // Close order modal function
      function closeOrderModal() {
        try {
          console.log('üîí Closing order modal...');
          const modal = document.querySelector('.fixed.inset-0.bg-black.bg-opacity-50');
          if (modal) {
            modal.remove();
            document.body.style.overflow = '';

            // Clear stored order data
            currentOrderData = null;
            currentOrderSubject = null;
            currentOrderEmailBody = null;

            showAlert('Order completed! Thank you for your business.', 'success');
            console.log('‚úÖ Order modal closed successfully');
          } else {
            console.warn('Order modal not found');
          }
        } catch (error) {
          console.error('Error closing order modal:', error);
        }
      }

      // Open Venmo app from order form (for advanced payment section)
      function openVenmoAppFromOrder() {
        try {
          console.log('üèß Opening Venmo app from order form...');

          const pricing = calculateOrderTotal();
          if (!pricing || !pricing.deposit) {
            showAlert('Please select services first to calculate payment amount', 'error');
            return;
          }

          const form = document.getElementById("orderForm");
          if (!form) {
            showAlert('Order form not found', 'error');
            return;
          }

          const formData = new FormData(form);
          const businessName = formData.get("businessName") || "Customer";

          // Use the main openVenmoApp function
          openVenmoApp(pricing.deposit, businessName);

          // Track the click for analytics
          if (typeof trackVenmoClick === 'function') {
            trackVenmoClick();
          }

        } catch (error) {
          console.error('Error opening Venmo from order:', error);
          showVenmoManualInstructions('50.00', 'Customer');
        }
      }

      // Send via EmailJS (if properly configured)
      function sendOrderViaEmailJS(orderData, subject, emailBody) {
        try {
          // Disable EmailJS for now since it's not properly configured
          console.log('üìß EmailJS disabled - using manual email fallback');
          console.log('Order data logged for manual processing:', {
            subject,
            emailBody,
            orderData
          });

          /* EmailJS integration disabled until proper service setup
          if (typeof emailjs !== 'undefined') {
            emailjs.send("service_id", "template_id", {
              to_email: "support@visualvibestudio.store",
              subject: subject,
              message: emailBody,
              customer_email: orderData.email,
              business_name: orderData.businessName
            }).then(() => {
              console.log('‚úÖ Email sent via EmailJS');
            }).catch((error) => {
              console.log('‚ùå EmailJS failed:', error);
            });
          }
          */
        } catch (error) {
          console.log('EmailJS error:', error);
        }
      }



      // Test email sending functionality
      function testEmailSending() {
        console.log('üß™ Testing email sending functionality...');

        const testOrderData = {
          businessName: 'Test Business Ltd',
          industry: 'Technology',
          email: 'test@example.com',
          phone: '(555) 123-4567',
          dueDate: '2024-01-15',
          details: 'This is a test order to verify email functionality.',
          selectedServices: ['Website Design', 'Logo Design'],
          totalAmount: '200.00',
          depositAmount: '100.00'
        };

        console.log('üß™ Test order data:', testOrderData);

        // Call the email sending function directly
        sendOrderEmail(testOrderData);

        console.log('üß™ Test email sending triggered. Check console for detailed logs.');
      }

      // Ensure form never submits
      document.addEventListener('DOMContentLoaded', function() {
        const orderForm = document.getElementById('orderForm');
        if (orderForm) {
          orderForm.addEventListener('submit', function(e) {
            console.log('‚ö†Ô∏è Form submit event intercepted and prevented');
            e.preventDefault();
            e.stopPropagation();
            return false;
          });
          console.log('‚úÖ Form submission prevention set up');
        }
      });

      // Simple test function for debugging
      function testButtonClick() {
        console.log('üß™ Test button click function called!');
        alert('Button click is working! Function is properly connected.');
        return false;
      }

      // Make functions globally available
      window.simpleOrderSubmit = simpleOrderSubmit;
      window.testButtonClick = testButtonClick;

      // Verify function is available
      console.log('‚úÖ simpleOrderSubmit function defined:', typeof window.simpleOrderSubmit);

      // Test button availability
      setTimeout(() => {
        const submitBtn = document.getElementById('submitOrderBtn');
        console.log('‚úÖ Submit button found:', !!submitBtn);
        if (submitBtn) {
          console.log('‚úÖ Submit button onclick:', submitBtn.onclick);
          console.log('‚úÖ Submit button disabled?', submitBtn.disabled);

          // Add additional click handler for testing
          submitBtn.addEventListener('click', function(e) {
            console.log('üéØ Button click event detected via addEventListener!');
            e.preventDefault();
            e.stopPropagation();

            // If onclick isn't working, use this as backup
            if (typeof window.simpleOrderSubmit === 'function') {
              console.log('üîÑ Calling simpleOrderSubmit via addEventListener...');
              window.simpleOrderSubmit(e);
            }

            return false;
          });
        }
      }, 1000);
      window.showSimpleVenmoPayment = showSimpleVenmoPayment;
      window.copyVenmoInfo = copyVenmoInfo;
      window.copyVenmoInfoFromData = copyVenmoInfoFromData;
      window.copyVenmoDetails = copyVenmoDetails;
      window.openVenmoApp = openVenmoApp;
      window.openVenmoAppFromOrder = openVenmoAppFromOrder;
      window.openVenmoWebsite = openVenmoWebsite;
      window.showVenmoManualInstructions = showVenmoManualInstructions;
      window.sendOrderEmail = sendOrderEmail;
      window.showOrderConfirmation = showOrderConfirmation;
      window.copyOrderDetails = copyOrderDetails;
      window.sendEmailManually = sendEmailManually;
      window.sendOrderEmailNow = sendOrderEmailNow;
      window.sendOrderToBusinessEmail = sendOrderToBusinessEmail;
      window.showOrderDetailsForEmail = showOrderDetailsForEmail;
      window.sendOrderViaWeb3Forms = sendOrderViaWeb3Forms;
      window.sendOrderViaNetlify = sendOrderViaNetlify;
      window.sendOrderViaMailto = sendOrderViaMailto;
      window.createDownloadableOrderBackup = createDownloadableOrderBackup;
      window.sendOrderViaSMSBackup = sendOrderViaSMSBackup;
      window.calculateOrderTotal = calculateOrderTotal;
      window.closeOrderModal = closeOrderModal;
      window.sendOrderViaEmailJS = sendOrderViaEmailJS;
      window.testEmailSending = testEmailSending;

      // Verify functions are properly defined
      setTimeout(() => {
        console.log('üîç Verifying order modal functions...');
        console.log('copyOrderDetails:', typeof window.copyOrderDetails);
        console.log('sendEmailManually:', typeof window.sendEmailManually);
        console.log('closeOrderModal:', typeof window.closeOrderModal);

        if (typeof window.copyOrderDetails === 'function' &&
            typeof window.sendEmailManually === 'function' &&
            typeof window.closeOrderModal === 'function') {
          console.log('‚úÖ All order modal functions are properly defined');
        } else {
          console.error('‚ùå Some order modal functions are not properly defined');
        }
      }, 1000);

      // Define chat functions globally at script start to fix ReferenceError
      // chatInitialized and chatOpen already initialized at top of script

      function safeToggleChat() {
        try {
          console.log('Chat toggle clicked');

          // Get chat elements
          const chatWindow = document.getElementById('chatWindow');
          const chatBubble = document.getElementById('chatBubble');
          const chatIcon = document.getElementById('chatIcon');
          const closeIcon = document.getElementById('closeIcon');

          if (!chatWindow || !chatBubble) {
            console.error('Chat elements not found');
            alert('Chat system not available. Please refresh the page or call (402) 979-7184');
            return;
          }

          // Toggle chat window
          const isOpen = chatWindow.classList.contains('open');

          if (isOpen) {
            // Close chat
            chatWindow.classList.remove('open');
            chatWindow.style.display = 'none';
            chatBubble.classList.remove('active');
            if (chatIcon) chatIcon.classList.remove('hidden');
            if (closeIcon) closeIcon.classList.add('hidden');
            chatOpen = false;
            console.log('Chat closed');
          } else {
            // Open chat
            chatWindow.classList.add('open');
            chatWindow.style.display = 'flex';
            chatBubble.classList.add('active');
            if (chatIcon) chatIcon.classList.add('hidden');
            if (closeIcon) closeIcon.classList.remove('hidden');
            chatOpen = true;
            console.log('Chat opened');

            // Focus input after animation
            setTimeout(() => {
              const chatInput = document.getElementById('chatInput');
              if (chatInput) {
                chatInput.focus();
              }
            }, 300);
          }
        } catch (error) {
          console.error('Error in safeToggleChat:', error);
          alert('Chat system error. Please call us directly at (402) 979-7184');
        }
      }

      async function sendMessage() {
        try {
          console.log('üìù sendMessage function called');
          console.log('üîç Function called from:', new Error().stack);

          const input = document.getElementById('chatInput');
          if (!input) {
            console.error('‚ùå Chat input not found');
            return;
          }

          const message = input.value.trim();
          console.log('üí¨ Message content:', message, 'Length:', message.length);

          if (!message) {
            console.log('‚ö†Ô∏è Empty message, not sending');
            return;
          }

          console.log('‚úÖ Sending message:', message);

          // Disable send button during processing
          const sendBtn = document.getElementById('chatSendBtn');
          if (sendBtn) {
            sendBtn.disabled = true;
            sendBtn.style.opacity = '0.5';
          }

          // Add user message to chat using the proper function
          addUserMessage(message);

          // Clear input and update send button state
          input.value = '';
          updateSendButton();

          // Show sending indicator
          showSendingIndicator();

          try {
            // Actually send the message to the business owner
            await sendMessageToBusinessOwner(message);

            // Remove sending indicator
            removeSendingIndicator();

            // Show success response
            addAgentMessage("Thanks for your message! I've received it and will respond shortly. For immediate assistance, call me at (402) 979-7184.");

          } catch (error) {
            console.error('Error sending message to business owner:', error);

            // Remove sending indicator
            removeSendingIndicator();

            // Show error response with fallback options
            addAgentMessage("I'm having trouble sending your message right now. Please try calling me directly at (402) 979-7184 or email support@visualvibestudio.store for immediate assistance.");
          }

        } catch (error) {
          console.error('Error in sendMessage:', error);
          // Re-enable send button on error
          const sendBtn = document.getElementById('chatSendBtn');
          if (sendBtn) {
            sendBtn.disabled = false;
            updateSendButton();
          }
        }
      }

      function handleChatKeyPress(event) {
        if (event.key === 'Enter' && !event.shiftKey) {
          event.preventDefault();
          sendMessage();
        }
      }

      // Make chat functions available globally
      window.safeToggleChat = safeToggleChat;
      window.sendMessage = sendMessage;
      window.handleChatKeyPress = handleChatKeyPress;

      // Define rating functions globally at script start to fix ReferenceError
      // selectedRating already initialized at top of script

      function setRating(rating) {
        try {
          console.log('üåü Setting rating to:', rating);

          // Use both local and window variables for reliability
          const ratingValue = parseInt(rating);
          selectedRating = ratingValue;
          window.selectedRating = ratingValue;

          // Update hidden input field
          const hiddenInput = document.getElementById('selectedRating');
          if (hiddenInput) {
            hiddenInput.value = ratingValue;
            console.log('‚úÖ Hidden input updated to:', hiddenInput.value);
          } else {
            console.error('‚ùå Hidden input field not found!');
          }

          // Update star display
          updateStarDisplay();

          // Provide immediate feedback
          console.log(`‚úÖ You selected ${rating} star${rating > 1 ? 's' : ''}!`);

          // Visual feedback for user
          const starContainer = document.querySelector('.star-rating').parentElement;
          if (starContainer) {
            // Add temporary glow effect
            starContainer.style.transition = 'all 0.3s ease';
            starContainer.style.transform = 'scale(1.05)';
            setTimeout(() => {
              starContainer.style.transform = 'scale(1)';
            }, 200);
          }

        } catch (error) {
          console.error('Error setting rating:', error);
          // Fallback values
          selectedRating = parseInt(rating) || 0;
          window.selectedRating = selectedRating;
        }
      }

      function highlightStars(rating) {
        const starButtons = document.querySelectorAll('.star-rating');
        starButtons.forEach((star, index) => {
          const starRating = parseInt(star.dataset.rating);
          if (starRating <= rating) {
            star.style.color = '#fbbf24';
            star.style.filter = 'drop-shadow(2px 2px 4px rgba(251, 191, 36, 0.8))';
            star.classList.add('active');
          } else {
            star.style.color = '#ffffff';
            star.style.filter = 'drop-shadow(2px 2px 4px rgba(255,255,255,0.8))';
            star.classList.remove('active');
          }
        });
      }

      function updateStarDisplay() {
        highlightStars(selectedRating);
      }

      function submitReview(event) {
        console.log('üöÄ Review submission started');

        if (event) {
          event.preventDefault();
          event.stopPropagation();
        }

        // Get form values
        const name = document.getElementById('reviewerName').value.trim();
        const businessType = document.getElementById('businessType').value.trim();
        const service = document.getElementById('serviceUsed').value;
        const text = document.getElementById('reviewText').value.trim();
        const rating = parseInt(document.getElementById('selectedRating').value) || window.selectedRating || 0;

        console.log('Form data:', { name, businessType, service, text, rating });

        // Basic validation
        if (!name) {
          alert('Please enter your name.');
          document.getElementById('reviewerName').focus();
          return false;
        }

        if (!rating || rating === 0) {
          alert('Please select a star rating.');
          return false;
        }

        if (!service) {
          alert('Please select a service.');
          document.getElementById('serviceUsed').focus();
          return false;
        }

        if (!text) {
          alert('Please write a review.');
          document.getElementById('reviewText').focus();
          return false;
        }

        // Create review
        const review = {
          id: Date.now().toString(),
          name: name,
          businessType: businessType || 'Customer',
          service: service,
          rating: rating,
          text: text,
          date: new Date().toISOString(),
          approved: true
        };

        console.log('Saving review:', review);

        // Save to localStorage
        try {
          const reviews = JSON.parse(localStorage.getItem('visualVibeReviews') || '[]');
          reviews.unshift(review);
          localStorage.setItem('visualVibeReviews', JSON.stringify(reviews));
          console.log('Review saved to localStorage');
        } catch (error) {
          console.error('Error saving to localStorage:', error);
        }

        // Clear form
        document.getElementById('reviewerName').value = '';
        document.getElementById('businessType').value = '';
        document.getElementById('serviceUsed').value = '';
        document.getElementById('reviewText').value = '';
        document.getElementById('selectedRating').value = '0';
        window.selectedRating = 0;
        selectedRating = 0;

        // Reset stars
        if (typeof updateStarDisplay === 'function') {
          updateStarDisplay();
        }

        // Add review to "What Our Customers Say" section
        addReviewToTestimonials(review);

        alert('Thank you! Your review has been submitted successfully.');

        // Reload reviews and update stats immediately
        if (typeof loadReviews === 'function') {
          setTimeout(() => {
            loadReviews();
            // Also immediately update stats with the new review count
            const allReviews = JSON.parse(localStorage.getItem('visualVibeReviews') || '[]');
            if (typeof updateReviewStats === 'function') {
              updateReviewStats(allReviews);
            }
          }, 300);
        }

        return false;
      }

      // Function to add new reviews to the "What Our Customers Say" section
      function addReviewToTestimonials(review) {
        try {
          console.log('Adding review to testimonials section:', review);

          // Find the testimonials grid container
          const testimonialsGrid = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3.xl\\:grid-cols-4.gap-6');

          if (!testimonialsGrid) {
            console.error('Testimonials grid not found');
            return;
          }

          // Generate a random gradient color for the avatar
          const avatarGradients = [
            'from-purple-400 to-pink-500',
            'from-blue-400 to-indigo-500',
            'from-green-400 to-teal-500',
            'from-yellow-400 to-orange-500',
            'from-red-400 to-pink-500',
            'from-indigo-400 to-purple-500'
          ];
          const randomGradient = avatarGradients[Math.floor(Math.random() * avatarGradients.length)];

          // Generate service badge color
          const serviceBadgeColors = [
            'bg-blue-600',
            'bg-purple-600',
            'bg-green-600',
            'bg-orange-600',
            'bg-red-600',
            'bg-indigo-600'
          ];
          const randomBadgeColor = serviceBadgeColors[Math.floor(Math.random() * serviceBadgeColors.length)];

          // Generate stars based on rating
          const starsText = '‚≠ê'.repeat(review.rating);

          // Get first letter of name for avatar
          const avatarLetter = review.name.charAt(0).toUpperCase();

          // Create the new review card HTML
          const newReviewCard = document.createElement('div');
          newReviewCard.className = 'bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300 new-review';
          newReviewCard.style.animation = 'fadeInScale 0.6s ease-out';

          newReviewCard.innerHTML = `
            <div class="flex items-center mb-4">
              <div class="bg-gradient-to-br ${randomGradient} w-10 h-10 rounded-full flex items-center justify-center mr-3">
                <span class="text-white font-bold">${avatarLetter}</span>
              </div>
              <div>
                <h4 class="font-semibold text-white text-sm">${review.name}</h4>
                <p class="text-purple-200 text-xs">${review.businessType}</p>
              </div>
            </div>
            <div class="mb-3">
              <div class="text-yellow-400 text-sm">${starsText}</div>
              <div class="${randomBadgeColor} text-white px-2 py-1 rounded-full text-xs inline-block mt-1">${review.service}</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-3 text-sm">
              "${review.text}"
            </p>
            <div class="text-green-400 font-semibold text-xs">
              ‚ú® Just submitted
            </div>
          `;

          // Add fadeIn animation styles if not already present
          if (!document.getElementById('reviewAnimationStyles')) {
            const style = document.createElement('style');
            style.id = 'reviewAnimationStyles';
            style.textContent = `
              @keyframes fadeInScale {
                0% {
                  opacity: 0;
                  transform: scale(0.8) translateY(20px);
                }
                100% {
                  opacity: 1;
                  transform: scale(1) translateY(0);
                }
              }
              .new-review {
                border: 2px solid rgba(34, 197, 94, 0.3);
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
              }
            `;
            document.head.appendChild(style);
          }

          // Insert the new review at the beginning of the grid
          testimonialsGrid.insertBefore(newReviewCard, testimonialsGrid.firstChild);

          // Scroll to the testimonials section to show the new review
          setTimeout(() => {
            const testimonialsSection = document.querySelector('section.py-20.brand-gradient-bg');
            if (testimonialsSection) {
              testimonialsSection.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
              });
            }
          }, 100);

          // Remove the highlight border after 5 seconds
          setTimeout(() => {
            newReviewCard.classList.remove('new-review');
          }, 5000);

          console.log('‚úÖ Review added to testimonials section successfully');

        } catch (error) {
          console.error('Error adding review to testimonials:', error);
        }
      }

      // Make rating functions available globally
      window.selectedRating = selectedRating;
      window.setRating = setRating;
      window.highlightStars = highlightStars;
      window.updateStarDisplay = updateStarDisplay;
      window.submitReview = submitReview;
      window.addReviewToTestimonials = addReviewToTestimonials;

      // Verify rating system is properly initialized
      console.log('‚≠ê Rating system initialized:', {
        selectedRating: selectedRating,
        windowSelectedRating: window.selectedRating,
        setRatingFunction: typeof setRating
      });

      // Define review toggle function globally at script start to fix ReferenceError
      // showingAllReviews already initialized at top of script

      function toggleAllReviews() {
        try {
          console.log('Toggling reviews display...');
          const reviewsContainer = document.getElementById('reviewsContainer');
          const buttonText = document.getElementById('viewAllReviewsText');

          if (!reviewsContainer || !buttonText) {
            console.error('Review container or button text not found');
            alert('Review system not available. Please refresh the page.');
            return;
          }

          const currentState = window.showingAllReviews || showingAllReviews || false;

          if (!currentState) {
            // Show all reviews
            reviewsContainer.style.maxHeight = 'none';
            reviewsContainer.style.overflow = 'visible';
            buttonText.textContent = 'Show Less Reviews';
            showingAllReviews = true;
            window.showingAllReviews = true;
            console.log('‚úÖ Showing all reviews');
          } else {
            // Show limited reviews
            reviewsContainer.style.maxHeight = '500px';
            reviewsContainer.style.overflow = 'auto';
            buttonText.textContent = 'View All Reviews';
            showingAllReviews = false;
            window.showingAllReviews = false;
            console.log('‚úÖ Showing limited reviews');
          }
        } catch (error) {
          console.error('Error toggling reviews:', error);
          alert('Error toggling reviews display.');
        }
      }

      // Make review toggle function available globally
      window.showingAllReviews = showingAllReviews;
      window.toggleAllReviews = toggleAllReviews;

      // Function to convert testimonials grid to horizontal scroll
      function convertTestimonialsToHorizontalScroll() {
        try {
          console.log('Converting testimonials to horizontal scroll...');

          // Find the testimonials grid container
          const testimonialsGrid = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3.xl\\:grid-cols-4.gap-6');

          if (!testimonialsGrid) {
            console.error('Testimonials grid not found');
            return;
          }

          // Create scroll indicator and container
          const scrollContainer = document.createElement('div');
          scrollContainer.className = 'relative';

          const scrollIndicator = document.createElement('div');
          scrollIndicator.className = 'text-center mb-6';
          scrollIndicator.innerHTML = '<p class="text-purple-200 text-sm">‚Üê Scroll to see all reviews ‚Üí</p>';

          const horizontalScrollWrapper = document.createElement('div');
          horizontalScrollWrapper.className = 'overflow-x-auto pb-4';
          horizontalScrollWrapper.style.cssText = 'scrollbar-width: thin; scrollbar-color: rgba(255,255,255,0.3) transparent;';

          const flexContainer = document.createElement('div');
          flexContainer.className = 'flex gap-6';
          flexContainer.style.cssText = 'width: fit-content; min-width: 100%;';

          // Get all testimonial cards
          const testimonialCards = Array.from(testimonialsGrid.children);

          // Add fixed width to each card and move to flex container
          testimonialCards.forEach(card => {
            card.classList.add('flex-none', 'w-80');
            flexContainer.appendChild(card);
          });

          // Build the new structure
          scrollContainer.appendChild(scrollIndicator);
          horizontalScrollWrapper.appendChild(flexContainer);
          scrollContainer.appendChild(horizontalScrollWrapper);

          // Replace the old grid with new scroll container
          testimonialsGrid.parentNode.replaceChild(scrollContainer, testimonialsGrid);

          // Update the addReviewToTestimonials function to work with new structure
          const originalAddReview = window.addReviewToTestimonials;
          window.addReviewToTestimonials = function(review) {
            try {
              console.log('Adding review to horizontal scroll testimonials:', review);

              // Find the flex container
              const flexContainer = document.querySelector('.overflow-x-auto .flex.gap-6');

              if (!flexContainer) {
                console.error('Horizontal scroll flex container not found');
                return;
              }

              // Generate a random gradient color for the avatar
              const avatarGradients = [
                'from-purple-400 to-pink-500',
                'from-blue-400 to-indigo-500',
                'from-green-400 to-teal-500',
                'from-yellow-400 to-orange-500',
                'from-red-400 to-pink-500',
                'from-indigo-400 to-purple-500'
              ];
              const randomGradient = avatarGradients[Math.floor(Math.random() * avatarGradients.length)];

              // Generate service badge color
              const serviceBadgeColors = [
                'bg-blue-600',
                'bg-purple-600',
                'bg-green-600',
                'bg-orange-600',
                'bg-red-600',
                'bg-indigo-600'
              ];
              const randomBadgeColor = serviceBadgeColors[Math.floor(Math.random() * serviceBadgeColors.length)];

              // Generate stars based on rating
              const starsText = '‚≠ê'.repeat(review.rating);

              // Get first letter of name for avatar
              const avatarLetter = review.name.charAt(0).toUpperCase();

              // Create the new review card HTML with fixed width for horizontal scroll
              const newReviewCard = document.createElement('div');
              newReviewCard.className = 'flex-none w-80 bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300 new-review';
              newReviewCard.style.animation = 'fadeInScale 0.6s ease-out';

              newReviewCard.innerHTML = `
                <div class="flex items-center mb-4">
                  <div class="bg-gradient-to-br ${randomGradient} w-10 h-10 rounded-full flex items-center justify-center mr-3">
                    <span class="text-white font-bold">${avatarLetter}</span>
                  </div>
                  <div>
                    <h4 class="font-semibold text-white text-sm">${review.name}</h4>
                    <p class="text-purple-200 text-xs">${review.businessType}</p>
                  </div>
                </div>
                <div class="mb-3">
                  <div class="text-yellow-400 text-sm">${starsText}</div>
                  <div class="${randomBadgeColor} text-white px-2 py-1 rounded-full text-xs inline-block mt-1">${review.service}</div>
                </div>
                <p class="text-purple-100 leading-relaxed mb-3 text-sm">
                  "${review.text}"
                </p>
                <div class="text-green-400 font-semibold text-xs">
                  ‚ú® Just submitted
                </div>
              `;

              // Insert the new review at the beginning of the flex container
              flexContainer.insertBefore(newReviewCard, flexContainer.firstChild);

              // Scroll to the new review in the horizontal container
              setTimeout(() => {
                newReviewCard.scrollIntoView({
                  behavior: 'smooth',
                  block: 'nearest',
                  inline: 'start'
                });
              }, 100);

              // Remove the highlight border after 5 seconds
              setTimeout(() => {
                newReviewCard.classList.remove('new-review');
              }, 5000);

              console.log('‚úÖ Review added to horizontal scroll testimonials successfully');

            } catch (error) {
              console.error('Error adding review to horizontal testimonials:', error);
            }
          };

          console.log('‚úÖ Testimonials converted to horizontal scroll successfully');

        } catch (error) {
          console.error('Error converting testimonials to horizontal scroll:', error);
        }
      }

      // Convert testimonials on page load
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(convertTestimonialsToHorizontalScroll, 1000);
      });

      // Also try to convert immediately if DOM is already loaded
      if (document.readyState === 'loading') {
        setTimeout(convertTestimonialsToHorizontalScroll, 1000);
      } else {
        setTimeout(convertTestimonialsToHorizontalScroll, 500);
      }

      // Verify review toggle system is properly initialized
      console.log('üìñ Review toggle system initialized:', {
        showingAllReviews: showingAllReviews,
        windowShowingAllReviews: window.showingAllReviews,
        toggleFunction: typeof toggleAllReviews
      });

      // Define order form functions globally at script start to fix ReferenceError
      function updateButtonState() {
        try {
          console.log('Updating button state...');
          const submitBtn = document.getElementById('submitOrderBtn');
          const form = document.getElementById('orderForm');

          if (!submitBtn || !form) {
            console.warn('Submit button or form not found');
            return;
          }

          // Check if required fields are filled
          const businessName = form.querySelector('input[name="businessName"]');
          const industry = form.querySelector('input[name="industry"]');
          const email = form.querySelector('input[name="email"]');
          const services = form.querySelector('select[name="services"]');
          const dueDate = form.querySelector('input[name="dueDate"]');

          const hasBusinessName = businessName && businessName.value.trim();
          const hasIndustry = industry && industry.value.trim();
          const hasEmail = email && email.value.trim();
          const hasServices = services && services.selectedOptions.length > 0;
          const hasDueDate = dueDate && dueDate.value;

          const isFormReady = hasBusinessName && hasIndustry && hasEmail && hasServices && hasDueDate;

          if (isFormReady) {
            submitBtn.disabled = false;
            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            submitBtn.classList.add('hover:scale-105');
            console.log('‚úÖ Form is ready for submission');
          } else {
            submitBtn.disabled = false; // Keep enabled for HTML5 validation
            submitBtn.classList.remove('hover:scale-105');
            console.log('‚ÑπÔ∏è Form not yet ready for submission');
          }
        } catch (error) {
          console.error('Error updating button state:', error);
        }
      }

      function validateAndSubmit(event) {
        try {
          console.log('üöÄ Order form submission started...');
          event.preventDefault(); // Prevent default form submission

          const form = document.getElementById('orderForm');
          const submitBtn = document.getElementById('submitOrderBtn');
          const submitBtnText = document.getElementById('submitBtnText');

          if (!form || !submitBtn || !submitBtnText) {
            console.error('Form elements not found');
            return false;
          }

          // Validate form first
          if (!form.checkValidity()) {
            form.reportValidity();
            return false;
          }

          // Check services selection specifically
          const services = form.querySelector('select[name="services"]');
          if (!services || services.selectedOptions.length === 0) {
            alert('Please select at least one service to continue.');
            services.scrollIntoView({ behavior: 'smooth', block: 'center' });
            services.focus();
            return false;
          }

          // Provide visual feedback
          submitBtnText.textContent = 'Processing...';
          submitBtn.disabled = true;
          submitBtn.classList.add('opacity-75');
          submitBtn.style.display = "none";

          // Check if the required functions are available
          if (typeof calculateOrderTotal === 'function' &&
              typeof saveOrderToAccount === 'function' &&
              typeof showVenmoPayment === 'function') {

            try {
              // Calculate pricing
              const pricing = calculateOrderTotal();

              // Validate pricing
              if (!pricing || !pricing.total || !pricing.deposit) {
                showAlert("Error calculating order total. Please refresh and try again.", "error");
                resetSubmitButton(submitBtn, submitBtnText);
                return false;
              }

              if (parseFloat(pricing.total) <= 0) {
                showAlert("Please select at least one service.", "error");
                resetSubmitButton(submitBtn, submitBtnText);
                return false;
              }

              if (parseFloat(pricing.deposit) <= 0) {
                showAlert("Error calculating deposit amount. Please contact us directly.", "error");
                resetSubmitButton(submitBtn, submitBtnText);
                return false;
              }

              // Collect form data
              const formData = new FormData(form);
              const businessName = formData.get("businessName");
              const industry = formData.get("industry");
              const email = formData.get("email");
              const phone = formData.get("phone");
              const dueDate = formData.get("dueDate");

              // Get selected services
              const selectedServices = Array.from(services.selectedOptions).map(option => option.text);

              const orderData = {
                businessName: businessName.trim(),
                industry: industry.trim(),
                services: selectedServices,
                email: email.trim(),
                phone: phone || "N/A",
                dueDate: dueDate || "N/A",
              };

              // Save order to user account if signed in
              const orderNumber = saveOrderToAccount(orderData, pricing);

              // Show Venmo payment
              console.log('üí∞ About to show Venmo payment with:', { pricing, orderData, orderNumber });
              showVenmoPayment(pricing, orderData, orderNumber);

              console.log('‚úÖ Order processed successfully, Venmo payment should be visible');
              return false;

            } catch (error) {
              console.error("Error processing order:", error);
              showAlert("An error occurred. Please try again or contact us directly.", "error");
              resetSubmitButton(submitBtn, submitBtnText);
              return false;
            }
          } else {
            // Functions not available yet, trigger form submit event to use the existing handler
            console.log('Payment functions not ready, triggering form submit event');
            resetSubmitButton(submitBtn, submitBtnText);

            // Manually trigger the form submit event to use the existing addEventListener handler
            const submitEvent = new Event('submit', { bubbles: true, cancelable: true });
            form.dispatchEvent(submitEvent);
            return false;
          }

        } catch (error) {
          console.error('Error in validateAndSubmit:', error);
          return false;
        }
      }

      function resetSubmitButton(submitBtn, submitBtnText) {
        if (submitBtn && submitBtnText) {
          submitBtnText.textContent = 'Start My Project Now';
          submitBtn.disabled = false;
          submitBtn.classList.remove('opacity-75');
          submitBtn.style.display = "block";
        }
      }

      // Make order form functions available globally
      window.updateButtonState = updateButtonState;
      window.validateAndSubmit = validateAndSubmit;
      window.resetSubmitButton = resetSubmitButton;

      // Define clipboard functions globally at script start to fix ReferenceError
      function copyToClipboard(text, successMessage = 'Copied to clipboard!') {
        if (navigator.clipboard && window.isSecureContext) {
          navigator.clipboard.writeText(text).then(() => {
            showAlert(successMessage, 'success');
          }).catch(() => {
            fallbackCopyToClipboard(text, successMessage);
          });
        } else {
          fallbackCopyToClipboard(text, successMessage);
        }
      }

      function fallbackCopyToClipboard(text, successMessage) {
        // Create a temporary text area
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();

        try {
          document.execCommand('copy');
          showAlert(successMessage, 'success');
        } catch (err) {
          showAlert(`Copy this: ${text}`, 'info');
        } finally {
          document.body.removeChild(textArea);
        }
      }

      function showAlert(message, type = 'info') {
        // Create alert element
        const alert = document.createElement('div');
        alert.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg font-medium text-white shadow-lg transform transition-all duration-300 ${
          type === 'success' ? 'bg-green-500' :
          type === 'error' ? 'bg-red-500' :
          'bg-blue-500'
        }`;
        alert.textContent = message;

        document.body.appendChild(alert);

        // Animate in
        setTimeout(() => alert.classList.add('translate-y-0'), 10);

        // Remove after 3 seconds
        setTimeout(() => {
          alert.classList.add('opacity-0', 'translate-y-[-20px]');
          setTimeout(() => document.body.removeChild(alert), 300);
        }, 3000);
      }

      // Make clipboard functions available globally
      window.copyToClipboard = copyToClipboard;
      window.fallbackCopyToClipboard = fallbackCopyToClipboard;
      window.showAlert = showAlert;

      // Define textarea utility functions globally at script start to fix ReferenceError
      function adjustTextareaHeight(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = Math.min(textarea.scrollHeight, 100) + 'px';
        updateSendButton();
      }

      function updateSendButton() {
        try {
          const input = document.getElementById('chatInput');
          const sendBtn = document.getElementById('chatSendBtn');
          if (input && sendBtn) {
            const hasContent = input.value.trim().length > 0;
            console.log('Updating send button - hasContent:', hasContent, 'inputValue:', input.value);
            sendBtn.disabled = !hasContent;
            sendBtn.style.opacity = hasContent ? '1' : '0.5';
            console.log('Send button disabled:', sendBtn.disabled);
          } else {
            console.log('Missing elements - input:', !!input, 'sendBtn:', !!sendBtn);
          }
        } catch (error) {
          console.error('Error updating send button:', error);
        }
      }

      // Make textarea functions available globally
      window.adjustTextareaHeight = adjustTextareaHeight;
      window.updateSendButton = updateSendButton;

      // Make message functions available globally
      window.addUserMessage = addUserMessage;
      window.addAgentMessage = addAgentMessage;
      window.showSendingIndicator = showSendingIndicator;
      window.removeSendingIndicator = removeSendingIndicator;
      window.sendMessageToBusinessOwner = sendMessageToBusinessOwner;

      // Define review functions globally to fix review display issues
      function loadReviews() {
        console.log('üìö loadReviews() called');
        let reviews = JSON.parse(localStorage.getItem('visualVibeReviews') || '[]');
        console.log('üì¶ Raw reviews from localStorage:', reviews);

        // Add sample reviews if none exist
        if (reviews.length === 0) {
          console.log('üìù No reviews found, adding sample reviews');
          const sampleReviews = [
            {
              id: 'sample-1',
              name: 'Alex',
              businessType: 'Restaurant Owner',
              service: 'Business Website',
              rating: 5,
              text: 'Visual Vibe Studio created an amazing website for my restaurant! Online orders increased by 200% and customers love the design. Yoshiko was incredibly professional and delivered exactly what we needed.',
              date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
              approved: true
            },
            {
              id: 'sample-2',
              name: 'Maria',
              businessType: 'Tech Startup CEO',
              service: 'Logo Design',
              rating: 5,
              text: 'The logo design exceeded all expectations! It perfectly captures our innovative spirit and has helped significantly with brand recognition. Great value for the price.',
              date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(),
              approved: true
            },
            {
              id: 'sample-3',
              name: 'James',
              businessType: 'Fitness Coach',
              service: 'Business Cards',
              rating: 5,
              text: 'Professional business cards that really make an impression! The design is clean, modern, and represents my brand perfectly. Highly recommend Visual Vibe Studio.',
              date: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),
              approved: true
            }
          ];

          reviews = sampleReviews;
          localStorage.setItem('visualVibeReviews', JSON.stringify(reviews));
        }

        const approvedReviews = reviews.filter(review => review.approved);
        console.log('‚úÖ Approved reviews to display:', approvedReviews.length);

        displayReviews(approvedReviews);
        updateReviewStats(approvedReviews);

        // Test localStorage write/read
        try {
          localStorage.setItem('reviewTest', 'working');
          const test = localStorage.getItem('reviewTest');
          console.log('üíæ localStorage test:', test === 'working' ? 'WORKING' : 'FAILED');
          localStorage.removeItem('reviewTest');
        } catch (error) {
          console.error('‚ùå localStorage not available:', error);
        }
      }

      // Update star displays based on average rating
      function updateStarDisplays(rating) {
        try {
          const numRating = parseFloat(rating);
          const fullStars = Math.floor(numRating);
          const hasHalfStar = numRating % 1 >= 0.5;

          console.log(`‚≠ê Updating star displays for rating: ${rating} (${fullStars} full stars, half star: ${hasHalfStar})`);

          // Generate star string based on rating
          let starString = '‚≠ê'.repeat(fullStars);
          if (hasHalfStar && fullStars < 5) {
            starString += '‚≠ê'; // Add another star for half star (simplified)
          }

          // Pad to 5 stars if needed (use empty stars for visual consistency)
          while (starString.length < 5) {
            starString += '‚òÜ';
          }

          // Find and update star display elements
          const starDisplays = [
            { selector: '.text-2xl', content: starString },
            { selector: '[style*="font-size: 32px"]', content: starString }
          ];

          starDisplays.forEach(({ selector, content }) => {
            const elements = document.querySelectorAll(selector);
            elements.forEach(el => {
              if (el.textContent.includes('‚≠ê') || el.textContent.includes('‚òÜ')) {
                el.textContent = content;
                console.log(`‚úÖ Updated star display: ${content}`);
              }
            });
          });

        } catch (error) {
          console.error('Error updating star displays:', error);
        }
      }

      function displayReviews(reviews) {
        try {
          console.log('Displaying', reviews.length, 'reviews');
          const container = document.getElementById('reviewsContainer');

          if (!container) {
            console.error('Reviews container not found');
            return;
          }

          // Clear existing reviews but keep the static ones
          const dynamicReviews = container.querySelectorAll('[data-dynamic-review]');
          dynamicReviews.forEach(review => review.remove());

          if (reviews.length === 0) {
            console.log('No reviews to display');
            return;
          }

          // Add new reviews at the very top of the container
          reviews.forEach((review, index) => {
            const reviewElement = createReviewElement(review);
            // Always insert at the beginning to ensure dynamic reviews appear first
            if (container.children.length > 0) {
              container.insertBefore(reviewElement, container.children[0]);
            } else {
              container.appendChild(reviewElement);
            }
          });

        } catch (error) {
          console.error('Error displaying reviews:', error);
        }
      }

      function createReviewElement(review) {
        const reviewDiv = document.createElement('div');
        reviewDiv.setAttribute('data-dynamic-review', 'true');
        reviewDiv.style.cssText = 'background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); color: #374151; padding: 25px; border-radius: 15px; margin-bottom: 25px; border: 2px solid rgba(255, 255, 255, 0.3); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);';

        const timeAgo = getTimeAgo(new Date(review.date));
        const stars = '‚≠ê'.repeat(review.rating);
        const initials = review.name.charAt(0).toUpperCase();

        reviewDiv.innerHTML = `
          <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <div style="background: linear-gradient(45deg, #6366f1, #8b5cf6); color: #ffffff; width: 50px; height: 50px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; margin-right: 20px;">${initials}</div>
            <div>
              <h5 style="font-size: 20px; font-weight: bold; margin: 0; color: #000000;">${escapeHtml(review.name)}</h5>
              <p style="margin: 0; color: #666666; font-size: 16px;">${escapeHtml(review.businessType)}</p>
            </div>
            <div style="margin-left: auto; text-align: right;">
              <div style="font-size: 24px; color: #fbbf24;">${stars}</div>
              <p style="margin: 0; font-size: 14px; color: #666666;">${timeAgo}</p>
            </div>
          </div>
          <div style="background: #6366f1; color: #ffffff; padding: 8px 16px; border-radius: 20px; display: inline-block; margin-bottom: 15px; font-size: 14px; font-weight: bold;">${escapeHtml(review.service)}</div>
          <p style="font-size: 18px; line-height: 1.6; color: #000000; margin: 0;">"${escapeHtml(review.text)}"</p>
        `;

        return reviewDiv;
      }

      function updateReviewStats(reviews) {
        try {
          // Count static reviews in HTML (non-dynamic reviews)
          const reviewsContainer = document.getElementById('reviewsContainer');
          const staticReviews = reviewsContainer ?
            reviewsContainer.querySelectorAll('div[style*="background: rgba(255, 255, 255, 0.95)"]:not([data-dynamic-review])').length :
            4; // fallback to 4 static reviews

          const dynamicReviews = reviews.length;
          const totalReviews = staticReviews + dynamicReviews;

          console.log('üìä Review stats:', {
            staticReviews,
            dynamicReviews,
            totalReviews
          });

          const totalReviewsElement = document.getElementById('totalReviews');
          if (totalReviewsElement) {
            totalReviewsElement.textContent = totalReviews;
            console.log('‚úÖ Updated total reviews count to:', totalReviews);
          }

          // Calculate average rating including static reviews (assume 5 stars each)
          let totalRatingSum = reviews.reduce((sum, review) => sum + review.rating, 0);
          let totalRatingCount = reviews.length;

          // Add static reviews with 5-star ratings to average
          totalRatingSum += (staticReviews * 5);
          totalRatingCount += staticReviews;

          const avgRating = totalRatingCount > 0 ?
            (totalRatingSum / totalRatingCount).toFixed(1) :
            '4.9'; // default rating

          console.log('‚≠ê Calculated average rating:', avgRating);

          // Update all rating display elements
          const ratingElements = [
            { id: 'customerRating1', format: avgRating },
            { id: 'averageRating1', format: avgRating },
            { id: 'mainRating', format: `${avgRating}/5` }
          ];

          ratingElements.forEach(({ id, format }) => {
            const element = document.getElementById(id);
            if (element) {
              element.textContent = format;
              console.log(`‚úÖ Updated ${id} to: ${format}`);
            } else {
              console.warn(`‚ö†Ô∏è Rating element ${id} not found`);
            }
          });

          // Also update any elements with .avg-rating class (fallback)
          const avgRatingElements = document.querySelectorAll('.avg-rating');
          avgRatingElements.forEach(el => el.textContent = avgRating);

          // Update star displays based on average rating
          updateStarDisplays(avgRating);

        } catch (error) {
          console.error('Error updating review stats:', error);
        }
      }

      function getTimeAgo(date) {
        const now = new Date();
        const diffTime = Math.abs(now - date);
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
        const diffMinutes = Math.floor(diffTime / (1000 * 60));

        if (diffDays > 0) {
          return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
        } else if (diffHours > 0) {
          return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
        } else if (diffMinutes > 0) {
          return `${diffMinutes} minute${diffMinutes > 1 ? 's' : ''} ago`;
        } else {
          return 'Just now';
        }
      }

      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diffTime = Math.abs(now - date);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

        if (diffDays === 1) {
          return 'Yesterday';
        } else if (diffDays < 7) {
          return `${diffDays} days ago`;
        } else if (diffDays < 30) {
          const weeks = Math.floor(diffDays / 7);
          return `${weeks} week${weeks > 1 ? 's' : ''} ago`;
        } else {
          return date.toLocaleDateString();
        }
      }

      // Make review functions globally available
      window.loadReviews = loadReviews;
      window.displayReviews = displayReviews;
      window.updateReviewStats = updateReviewStats;
      window.updateStarDisplays = updateStarDisplays;
      window.formatDate = formatDate;

      // Make payment functions globally available
      window.calculateOrderTotal = calculateOrderTotal;
      window.saveOrderToAccount = saveOrderToAccount;
      window.showVenmoPayment = showVenmoPayment;

      // Enhanced email handling function for main send email button
      function handleEmailClick(event, emailAddress) {
        // Check if we're on a mobile device
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        // For main send email button, use pre-filled content
        const isMainButton = event.target.closest('#mainSendEmailBtn');

        if (isMobile) {
          // On mobile, use mailto with pre-filled content if it's the main button
          if (isMainButton) {
            const subject = encodeURIComponent('Inquiry from Visual Vibe Studio Website');
            const body = encodeURIComponent(`Hi Yoshiko,

I'm interested in your design services. Please get back to me when you have a chance.

Thanks!`);
            window.location.href = `mailto:${emailAddress}?subject=${subject}&body=${body}`;
          } else {
            // For other email buttons, use simple mailto
            window.location.href = `mailto:${emailAddress}`;
          }
          return true;
        }

        // On desktop, provide enhanced options
        event.preventDefault();
        showEmailOptionsModal(emailAddress, isMainButton);
      }

      function showEmailOptionsModal(emailAddress, isMainButton = false) {
        // Pre-filled content for main button
        const subject = isMainButton ? 'Inquiry from Visual Vibe Studio Website' : '';
        const body = isMainButton ? `Hi Yoshiko,

I'm interested in your design services. Please get back to me when you have a chance.

Thanks!` : '';

        // Create modal overlay
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.onclick = (e) => {
          if (e.target === modal) closeEmailModal();
        };

        // Generate email platform links
        const gmailLink = `https://mail.google.com/mail/?view=cm&fs=1&to=${emailAddress}&su=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        const outlookLink = `https://outlook.live.com/mail/0/deeplink/compose?to=${emailAddress}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        const yahooLink = `https://compose.mail.yahoo.com/?to=${emailAddress}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        const mailtoLink = `mailto:${emailAddress}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

        modal.innerHTML = `
          <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-2xl font-bold text-gray-800">Choose Email Platform</h3>
              <button onclick="closeEmailModal()" class="text-gray-500 hover:text-gray-700">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>

            <div class="space-y-4">
              <div class="bg-gray-50 rounded-lg p-4">
                <div class="flex items-center space-x-3 mb-3">
                  <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
                    <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
                  </svg>
                  <span class="font-medium text-gray-700">Email: ${emailAddress}</span>
                </div>
                ${isMainButton ? `
                <div class="text-sm text-gray-600 mb-2">
                  <strong>Subject:</strong> ${subject}
                </div>
                ` : ''}
              </div>

              <!-- Gmail Option -->
              <button
                onclick="window.open('${gmailLink}', '_blank'); closeEmailModal();"
                class="w-full bg-red-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-red-600 transition-colors flex items-center justify-center gap-2"
              >
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M24 4.5v15c0 .85-.65 1.5-1.5 1.5H21V7.387l-9 6.463-9-6.463V21H1.5C.649 21 0 20.35 0 19.5v-15C0 3.649.649 3 1.5 3H3l9 6.463L21 3h1.5c.85 0 1.5.649 1.5 1.5z"/>
                </svg>
                Open in Gmail
              </button>

              <!-- Outlook Option -->
              <button
                onclick="window.open('${outlookLink}', '_blank'); closeEmailModal();"
                class="w-full bg-blue-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-600 transition-colors flex items-center justify-center gap-2"
              >
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M7.88 12.04q0 .45-.11.87-.1.41-.33.74-.22.33-.58.52-.37.2-.87.2t-.85-.2q-.35-.21-.57-.55-.22-.33-.33-.75-.1-.42-.1-.83 0-.42.1-.83.11-.42.33-.75.22-.34.57-.55.35-.2.85-.2t.87.2q.36.19.58.52.23.33.33.74.11.42.11.87zm-3.56 0q0 .56.2.94.2.38.58.38.37 0 .58-.38.2-.38.2-.94 0-.57-.2-.95-.21-.37-.58-.37-.38 0-.58.37-.2.38-.2.95z"/>
                </svg>
                Open in Outlook
              </button>

              <!-- Yahoo Option -->
              <button
                onclick="window.open('${yahooLink}', '_blank'); closeEmailModal();"
                class="w-full bg-purple-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-purple-600 transition-colors flex items-center justify-center gap-2"
              >
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5.35 7.35L12 14.7 6.65 9.35c-.39-.39-.39-1.02 0-1.41.39-.39 1.02-.39 1.41 0L12 11.88l3.94-3.94c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41z"/>
                </svg>
                Open in Yahoo Mail
              </button>

              <!-- Default Email Client Option -->
              <button
                onclick="window.location.href='${mailtoLink}'; closeEmailModal();"
                class="w-full bg-gray-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-gray-700 transition-colors flex items-center justify-center gap-2"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
                Default Email App
              </button>

              <!-- Copy Details Option -->
              <button
                onclick="copyToClipboard('${emailAddress}', 'Email address copied!'); closeEmailModal();"
                class="w-full bg-indigo-100 text-indigo-600 py-3 px-4 rounded-lg font-semibold hover:bg-indigo-200 transition-colors flex items-center justify-center gap-2"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
                Copy Email Address
              </button>
            </div>
          </div>
        `;

        document.body.appendChild(modal);
      }

      function closeEmailModal() {
        const modal = document.querySelector('.fixed.inset-0.bg-black.bg-opacity-50');
        if (modal) {
          modal.remove();
        }
      }

      // Make email functions globally available
      window.handleEmailClick = handleEmailClick;
      window.showEmailOptionsModal = showEmailOptionsModal;
      window.closeEmailModal = closeEmailModal;
    </script>

    <style>
      body {
        font-family: "Inter", sans-serif;
      }

      /* Loading states */
      .loading {
        opacity: 0.6;
        pointer-events: none;
      }

      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Form improvements */
      .form-field:focus {
        outline: none;
        ring: 2px;
        ring-color: rgb(99 102 241);
      }

      /* Mobile improvements */
      @media (max-width: 768px) {
        .mobile-stack {
          display: block !important;
        }

        .mobile-full {
          width: 100% !important;
        }

        .mobile-text-sm {
          font-size: 0.875rem !important;
        }
      }

      /* Print styles */
      @media print {
        .no-print {
          display: none !important;
        }
      }

      /* Floating Action Button */
      .floating-action {
        position: fixed;
        left: 20px;
        bottom: 100px;
        z-index: 999;
        animation: float 3s ease-in-out infinite;
      }

      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
      }

      .floating-phone {
        width: 56px;
        height: 56px;
        border-radius: 50%;
        background: linear-gradient(135deg, #10b981, #059669);
        box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .floating-phone:hover {
        transform: scale(1.1);
        box-shadow: 0 12px 35px rgba(16, 185, 129, 0.4);
      }

      /* Chat Widget Styles */
      .chat-widget {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        font-family: 'Inter', sans-serif;
      }

      .chat-bubble {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        box-shadow:
          0 8px 25px rgba(99, 102, 241, 0.3),
          0 0 40px rgba(139, 92, 246, 0.2),
          inset 0 1px 0 rgba(255, 255, 255, 0.2);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        animation: pulse 2s infinite;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .chat-bubble:hover {
        transform: scale(1.1);
        box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
      }

      .chat-bubble.active {
        background: linear-gradient(135deg, #ef4444, #f97316);
        animation: none;
      }

      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
        100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
      }

      .chat-window {
        position: absolute;
        bottom: 80px;
        right: 0;
        width: 350px;
        height: 500px;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        display: none;
        flex-direction: column;
        overflow: hidden;
        border: 1px solid #e5e7eb;
      }

      .chat-window.open {
        display: flex;
        animation: slideUp 0.3s ease-out;
      }

      @keyframes slideUp {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      .chat-header {
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        color: white;
        padding: 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 16px;
        background: #f9fafb;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .chat-message {
        max-width: 80%;
        padding: 12px 16px;
        border-radius: 18px;
        word-wrap: break-word;
        font-size: 14px;
        line-height: 1.4;
      }

      .chat-message.agent {
        background: #6366f1;
        color: white;
        align-self: flex-start;
        border-bottom-left-radius: 4px;
      }

      .chat-message.user {
        background: #e5e7eb;
        color: #374151;
        align-self: flex-end;
        border-bottom-right-radius: 4px;
      }

      .chat-typing {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        background: #6366f1;
        color: white;
        border-radius: 18px;
        border-bottom-left-radius: 4px;
        align-self: flex-start;
        max-width: 80px;
      }

      .typing-dots {
        display: flex;
        gap: 4px;
      }

      .typing-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: white;
        animation: typing 1.4s infinite ease-in-out;
      }

      .typing-dot:nth-child(1) { animation-delay: -0.32s; }
      .typing-dot:nth-child(2) { animation-delay: -0.16s; }

      @keyframes typing {
        0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
        40% { transform: scale(1); opacity: 1; }
      }

      .chat-input-area {
        padding: 16px;
        border-top: 1px solid #e5e7eb;
        background: white;
      }

      .chat-input-container {
        display: flex;
        gap: 8px;
        align-items: flex-end;
      }

      .chat-input {
        flex: 1;
        border: 1px solid #d1d5db;
        border-radius: 20px;
        padding: 12px 16px;
        font-size: 14px;
        resize: none;
        max-height: 100px;
        min-height: 44px;
      }

      .chat-input:focus {
        outline: none;
        border-color: #6366f1;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .chat-send-btn {
        background: #6366f1;
        color: white;
        border: none;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .chat-send-btn:hover:not(:disabled) {
        background: #5048e5;
        transform: scale(1.05);
      }

      .chat-send-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .agent-status {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #10b981;
        animation: pulse-status 2s infinite;
      }

      @keyframes pulse-status {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
      }

      .chat-notification {
        position: absolute;
        top: -8px;
        right: -8px;
        background: #ef4444;
        color: white;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        animation: bounce 1s infinite;
      }

      @keyframes bounce {
        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
        60% { transform: translateY(-5px); }
      }

      @media (max-width: 480px) {
        .chat-window {
          width: calc(100vw - 20px);
          right: -10px;
          height: 70vh;
        }
      }

      /* Professional Background Styles */
      .brand-gradient-bg {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 25%, #d946ef 50%, #ec4899 75%, #f59e0b 100%);
        background-size: 400% 400%;
        animation: gradientShift 8s ease infinite;
      }

      @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      .geometric-pattern {
        background-image:
          radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 2px, transparent 2px),
          radial-gradient(circle at 75% 75%, rgba(255,255,255,0.1) 2px, transparent 2px),
          linear-gradient(45deg, rgba(255,255,255,0.05) 25%, transparent 25%),
          linear-gradient(-45deg, rgba(255,255,255,0.05) 25%, transparent 25%);
        background-size: 60px 60px, 60px 60px, 30px 30px, 30px 30px;
        background-position: 0 0, 30px 30px, 0 0, 15px 15px;
      }

      .professional-mesh {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        position: relative;
      }

      .professional-mesh::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background:
          radial-gradient(ellipse 800px 600px at 120% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
          radial-gradient(ellipse 600px 400px at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
          radial-gradient(ellipse 400px 300px at 20% 60%, rgba(120, 200, 255, 0.3) 0%, transparent 50%);
        opacity: 0.8;
      }

      .floating-elements {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
        pointer-events: none;
      }

      .floating-elements::before,
      .floating-elements::after {
        content: '';
        position: absolute;
        border-radius: 50%;
        background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
        animation: float 6s ease-in-out infinite;
      }

      .floating-elements::before {
        width: 120px;
        height: 120px;
        top: 20%;
        left: 10%;
        animation-delay: 0s;
      }

      .floating-elements::after {
        width: 80px;
        height: 80px;
        top: 60%;
        right: 15%;
        animation-delay: 3s;
      }

      .section-divider {
        height: 100px;
        background: linear-gradient(to bottom, transparent 0%, rgba(99, 102, 241, 0.1) 50%, transparent 100%);
        position: relative;
        overflow: hidden;
      }

      .section-divider::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 200%;
        height: 100%;
        background: linear-gradient(90deg, transparent 0%, rgba(139, 92, 246, 0.3) 50%, transparent 100%);
        animation: sweep 4s ease-in-out infinite;
      }

      @keyframes sweep {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }

      .glass-morphism {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .neon-glow {
        box-shadow:
          0 0 20px rgba(99, 102, 241, 0.3),
          0 0 40px rgba(139, 92, 246, 0.2),
          0 0 60px rgba(236, 72, 153, 0.1);
      }

      /* Review System Styles */
      .star-rating {
        border: none;
        background: none;
        padding: 0;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .star-rating:hover {
        transform: scale(1.1);
      }

      .star-rating.active {
        color: #fbbf24 !important;
      }

      .review-card {
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        border: 1px solid #e2e8f0;
        border-radius: 16px;
        padding: 24px;
        transition: all 0.3s ease;
      }

      .review-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      .review-stars {
        color: #fbbf24;
        font-size: 1.1rem;
      }

      .review-text {
        line-height: 1.6;
        color: #4a5568;
      }

      .review-author {
        color: #2d3748;
        font-weight: 600;
      }

      .review-service {
        background: #edf2f7;
        color: #4a5568;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 500;
      }

      /* Ensure review section is always visible */
      #reviews {
        display: block !important;
        visibility: visible !important;
        min-height: 1000px !important;
      }

      #reviewForm, #reviewsContainer {
        display: block !important;
        visibility: visible !important;
        min-height: 600px !important;
      }

      #reviewForm input, #reviewForm textarea, #reviewForm select {
        display: block !important;
        visibility: visible !important;
        margin-bottom: 1rem !important;
        background: white !important;
        border: 2px solid #e5e7eb !important;
        padding: 12px !important;
        width: 100% !important;
        box-sizing: border-box !important;
        border-radius: 8px !important;
        font-size: 16px !important;
      }

      #reviewForm button {
        display: block !important;
        visibility: visible !important;
        margin-top: 1rem !important;
        background: linear-gradient(to right, #6366f1, #8b5cf6) !important;
        color: white !important;
        border: none !important;
        padding: 12px 24px !important;
        width: 100% !important;
        border-radius: 8px !important;
        font-size: 16px !important;
        font-weight: 600 !important;
        cursor: pointer !important;
      }

      #reviewForm label {
        display: block !important;
        visibility: visible !important;
        margin-bottom: 8px !important;
        font-weight: 600 !important;
        color: #374151 !important;
        font-size: 14px !important;
      }

      #reviewForm > div {
        display: block !important;
        visibility: visible !important;
        margin-bottom: 24px !important;
        width: 100% !important;
      }

      /* Star rating buttons */
      .star-rating {
        display: inline-block !important;
        visibility: visible !important;
        margin-right: 8px !important;
        background: none !important;
        border: none !important;
        font-size: 24px !important;
        cursor: pointer !important;
        padding: 4px !important;
        transition: all 0.3s ease !important;
        transform: scale(1) !important;
      }

      .star-rating:hover {
        transform: scale(1.2) !important;
      }

      .star-rating.active {
        transform: scale(1.1) !important;
      }

      /* Reviews display area */
      #reviewsContainer {
        background: #f9fafb !important;
        border-radius: 8px !important;
        padding: 16px !important;
      }
    </style>
  </head>
  <body class="relative bg-gradient-to-br from-slate-50 via-white to-indigo-50/30 text-gray-900">
    <!-- Global Professional Background Elements -->
    <div class="fixed inset-0 pointer-events-none z-0 overflow-hidden">
      <div class="absolute top-1/4 left-0 w-64 h-64 bg-gradient-to-r from-indigo-100/20 to-transparent rounded-full blur-3xl animate-pulse"></div>
      <div class="absolute bottom-1/4 right-0 w-64 h-64 bg-gradient-to-l from-purple-100/20 to-transparent rounded-full blur-3xl animate-pulse" style="animation-delay: 3s;"></div>
    </div>
    <header class="glass-morphism shadow-xl p-4 sticky top-0 z-50 border-b border-white/20">
      <div class="max-w-7xl mx-auto flex justify-between items-center">
        <div class="flex items-center space-x-3">
          <img
            src="https://cdn.builder.io/api/v1/image/assets%2F5015b2985ffe4a9ca5064ae99f72812a%2Fff0a451500144e83b9957a3f0ca320e8?format=webp&width=800"
            alt="Visual Vibe Studio Logo"
            class="h-10 w-10 object-contain"
            loading="eager"
          />
          <h1 class="text-2xl font-bold text-indigo-600">Visual Vibe Studio</h1>
        </div>
        <nav class="flex items-center space-x-4">
          <a href="#services" class="text-gray-700 hover:text-indigo-600"
            >Services</a
          >
          <a href="#reviews" class="text-gray-700 hover:text-indigo-600"
            >Reviews</a
          >
          <a href="#order" class="text-gray-700 hover:text-indigo-600">Order</a>
          <a href="#contact" class="text-gray-700 hover:text-indigo-600"
            >Contact</a
          >

          <!-- User Account Section -->
          <div id="userAccountSection" class="flex items-center space-x-3">
            <!-- Signed Out State -->
            <div id="signedOutState" class="flex items-center space-x-2">
              <button onclick="openSignInModal()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors text-sm font-medium">
                Sign In
              </button>
              <button onclick="openSignUpModal()" class="border border-indigo-600 text-indigo-600 px-4 py-2 rounded-lg hover:bg-indigo-50 transition-colors text-sm font-medium">
                Sign Up
              </button>
            </div>

            <!-- Signed In State -->
            <div id="signedInState" class="flex items-center space-x-3 hidden">
              <div class="flex items-center space-x-2">
                <div class="bg-indigo-100 p-2 rounded-full">
                  <svg class="w-4 h-4 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                  </svg>
                </div>
                <span id="userDisplayName" class="text-gray-700 font-medium"></span>
              </div>
              <button onclick="showOrderHistory()" class="text-indigo-600 hover:text-indigo-800 text-sm font-medium">
                My Orders
              </button>
              <button onclick="signOut()" class="text-gray-500 hover:text-gray-700 text-sm">
                Sign Out
              </button>
            </div>
          </div>
        </nav>
      </div>
    </header>

    <!-- Enhanced Hero Section -->
    <section class="relative overflow-hidden brand-gradient-bg text-white">
      <!-- Professional Background Pattern -->
      <div class="absolute inset-0 geometric-pattern opacity-30"></div>

      <!-- Floating Professional Elements -->
      <div class="floating-elements">
        <div class="absolute top-1/4 left-1/4 w-24 h-24 glass-morphism rounded-full animate-pulse"></div>
        <div class="absolute top-1/3 right-1/4 w-16 h-16 glass-morphism rounded-full animate-bounce" style="animation-delay: 2s;"></div>
        <div class="absolute bottom-1/4 left-1/3 w-20 h-20 glass-morphism rounded-full animate-pulse" style="animation-delay: 4s;"></div>
        <div class="absolute top-1/2 right-1/3 w-12 h-12 neon-glow rounded-full bg-white/10 animate-bounce" style="animation-delay: 1s;"></div>
      </div>

      <!-- Mesh Gradient Overlay -->
      <div class="absolute inset-0 professional-mesh opacity-20"></div>

      <div class="relative z-10 max-w-7xl mx-auto px-4 py-20 text-center">
        <div class="mb-8">
          <h2 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
            Transform Your Business with
            <span class="bg-gradient-to-r from-yellow-300 to-pink-300 bg-clip-text text-transparent">
              Stunning Designs
            </span>
          </h2>
          <p class="text-xl md:text-2xl text-indigo-100 mb-8 max-w-3xl mx-auto leading-relaxed">
            From eye-catching logos to professional websites - we create designs that turn visitors into customers and make your competition jealous.
          </p>
        </div>

        <!-- Value Propositions -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="text-3xl mb-3">‚ö°</div>
            <h3 class="text-lg font-semibold mb-2">Lightning Fast</h3>
            <p class="text-indigo-200 text-sm">Most projects completed in 5-7 days</p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="text-3xl mb-3">üíé</div>
            <h3 class="text-lg font-semibold mb-2">Premium Quality</h3>
            <p class="text-indigo-200 text-sm">Professional designs that wow your customers</p>
          </div>
          <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="text-3xl mb-3">üéØ</div>
            <h3 class="text-lg font-semibold mb-2">100% Satisfaction</h3>
            <p class="text-indigo-200 text-sm">3 rounds of revisions included</p>
          </div>
        </div>

        <!-- CTA Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
          <a href="#services" class="bg-white text-indigo-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-yellow-300 hover:text-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-2xl">
            ‚ú® See Our Services
          </a>
          <a href="#portfolio" class="border-2 border-white text-white px-8 py-4 rounded-full font-semibold text-lg hover:bg-white hover:text-indigo-600 transition-all duration-300 transform hover:scale-105">
            View Portfolio
          </a>
        </div>

        <!-- Trust Indicators -->
        <div class="mt-16 pt-8 border-t border-white/20">
          <p class="text-indigo-200 mb-4">Trusted by 200+ businesses nationwide</p>
          <div class="flex justify-center items-center space-x-8 opacity-60">
            <div class="text-2xl">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            <div class="text-sm"><span id="customerRating1">4.9</span>/5 Customer Rating</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Professional Section Divider -->
    <div class="section-divider"></div>

    <!-- Portfolio Showcase Section -->
    <section id="portfolio" class="py-20 relative">
      <!-- Professional Background -->
      <div class="absolute inset-0 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50"></div>
      <div class="absolute inset-0 opacity-30">
        <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-r from-transparent via-indigo-100/30 to-transparent transform rotate-12"></div>
        <div class="absolute bottom-0 right-0 w-full h-full bg-gradient-to-l from-transparent via-purple-100/30 to-transparent transform -rotate-12"></div>
      </div>
      <div class="max-w-7xl mx-auto px-4">
        <div class="text-center mb-16">
          <h3 class="text-4xl font-bold text-gray-800 mb-4">Our Work Speaks Volumes</h3>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            See how we've helped businesses like yours stand out with professional, conversion-focused designs.
          </p>
        </div>

        <!-- Portfolio Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
          <!-- Website Example -->
          <div class="group bg-white rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-all duration-300 hover:shadow-2xl">
            <div class="bg-gradient-to-br from-blue-500 to-purple-600 h-48 flex items-center justify-center relative overflow-hidden">
              <div class="absolute inset-0 bg-black/10"></div>
              <div class="relative z-10 text-white text-center">
                <div class="text-4xl mb-2">üåê</div>
                <h4 class="text-lg font-bold">Modern Restaurant Website</h4>
                <p class="text-sm opacity-90">Increased online orders by 150%</p>
              </div>
              <div class="absolute -bottom-2 -right-2 w-20 h-20 bg-white/20 rounded-full"></div>
            </div>
            <div class="p-6">
              <h5 class="font-semibold text-gray-800 mb-2">Local Restaurant</h5>
              <p class="text-gray-600 text-sm mb-4">Complete website redesign with online ordering system and mobile optimization.</p>
              <div class="flex items-center justify-between">
                <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-xs font-medium">Website Design</span>
                <span class="text-green-600 font-semibold">+150% Orders</span>
              </div>
            </div>
          </div>

          <!-- Logo Example -->
          <div class="group bg-white rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-all duration-300 hover:shadow-2xl">
            <div class="bg-gradient-to-br from-green-500 to-teal-600 h-48 flex items-center justify-center relative overflow-hidden">
              <div class="absolute inset-0 bg-black/10"></div>
              <div class="relative z-10 text-white text-center">
                <div class="text-4xl mb-2">‚ö°</div>
                <h4 class="text-lg font-bold">Tech Startup Logo</h4>
                <p class="text-sm opacity-90">Boosted brand recognition by 300%</p>
              </div>
              <div class="absolute -top-2 -left-2 w-16 h-16 bg-white/20 rounded-full"></div>
            </div>
            <div class="p-6">
              <h5 class="font-semibold text-gray-800 mb-2">Tech Startup</h5>
              <p class="text-gray-600 text-sm mb-4">Modern logo design that perfectly captures their innovative spirit and technical expertise.</p>
              <div class="flex items-center justify-between">
                <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-medium">Logo Design</span>
                <span class="text-green-600 font-semibold">+300% Recognition</span>
              </div>
            </div>
          </div>

          <!-- Marketing Materials Example -->
          <div class="group bg-white rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-all duration-300 hover:shadow-2xl">
            <div class="bg-gradient-to-br from-pink-500 to-orange-500 h-48 flex items-center justify-center relative overflow-hidden">
              <div class="absolute inset-0 bg-black/10"></div>
              <div class="relative z-10 text-white text-center">
                <div class="text-4xl mb-2">üìä</div>
                <h4 class="text-lg font-bold">Marketing Campaign</h4>
                <p class="text-sm opacity-90">Generated 50+ new leads</p>
              </div>
              <div class="absolute bottom-0 right-0 w-24 h-24 bg-white/20 rounded-tl-full"></div>
            </div>
            <div class="p-6">
              <h5 class="font-semibold text-gray-800 mb-2">Fitness Center</h5>
              <p class="text-gray-600 text-sm mb-4">Complete marketing package: flyers, business cards, and promotional brochures.</p>
              <div class="flex items-center justify-between">
                <span class="bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-xs font-medium">Full Package</span>
                <span class="text-green-600 font-semibold">50+ New Leads</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Portfolio CTA -->
        <div class="text-center bg-white rounded-2xl p-8 shadow-lg">
          <h4 class="text-2xl font-bold text-gray-800 mb-4">Ready to Join Our Success Stories?</h4>
          <p class="text-gray-600 mb-6">Let's create something amazing for your business too.</p>
          <a href="#order" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-4 rounded-full font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-lg">
            Start Your Project Today
          </a>
        </div>
      </div>
    </section>

    <section id="services" class="max-w-7xl mx-auto py-12 px-4">
      <div class="text-center mb-16">
        <h3 class="text-4xl font-bold text-gray-800 mb-4">Professional Design Services</h3>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
          From concept to completion, we deliver designs that drive results and make your business unforgettable.
        </p>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6">
        <!-- Website Service -->
        <div class="group bg-white p-6 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-indigo-500 to-purple-600 opacity-10 rounded-bl-full"></div>
          <div class="absolute top-4 right-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
            From $100
          </div>
          <div class="text-4xl mb-4 transform group-hover:scale-110 transition-transform duration-300">üåê</div>
          <h4 class="text-xl font-bold text-gray-800 pr-20 mb-3">
            Business Website
          </h4>
          <p class="text-gray-600 mb-4 leading-relaxed">
            Mobile-optimized websites that convert visitors into customers. Includes hosting setup and SEO basics.
          </p>
          <div class="space-y-2 text-sm text-gray-500">
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Mobile responsive design
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Contact forms & social links
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Basic SEO optimization
            </div>
          </div>
        </div>

        <!-- Brochure Service -->
        <div class="group bg-white p-6 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-purple-500 to-pink-500 opacity-10 rounded-bl-full"></div>
          <div class="absolute top-4 right-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
            $80
          </div>
          <div class="text-4xl mb-4 transform group-hover:scale-110 transition-transform duration-300">üìÑ</div>
          <h4 class="text-xl font-bold text-gray-800 pr-16 mb-3">
            Business Brochure
          </h4>
          <p class="text-gray-600 mb-4 leading-relaxed">
            Tri-fold or bi-fold brochures that tell your story and showcase your services professionally.
          </p>
          <div class="space-y-2 text-sm text-gray-500">
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Print-ready high resolution
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Professional copywriting tips
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Multiple format options
            </div>
          </div>
        </div>

        <!-- Flyer Service -->
        <div class="group bg-white p-6 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-green-500 to-teal-500 opacity-10 rounded-bl-full"></div>
          <div class="absolute top-4 right-4 bg-gradient-to-r from-green-500 to-teal-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
            $65
          </div>
          <div class="text-4xl mb-4 transform group-hover:scale-110 transition-transform duration-300">üìÑ</div>
          <h4 class="text-xl font-bold text-gray-800 pr-16 mb-3">
            Marketing Flyer
          </h4>
          <p class="text-gray-600 mb-4 leading-relaxed">
            Eye-catching promotional flyers that grab attention and drive action for events, sales, and announcements.
          </p>
          <div class="space-y-2 text-sm text-gray-500">
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Single or double-sided
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Social media versions
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              QR code integration
            </div>
          </div>
        </div>

        <!-- Business Card Service -->
        <div class="group bg-white p-6 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-blue-500 to-cyan-500 opacity-10 rounded-bl-full"></div>
          <div class="absolute top-4 right-4 bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
            $50
          </div>
          <div class="text-4xl mb-4 transform group-hover:scale-110 transition-transform duration-300">üíº</div>
          <h4 class="text-xl font-bold text-gray-800 pr-16 mb-3">
            Business Cards
          </h4>
          <p class="text-gray-600 mb-4 leading-relaxed">
            Premium business cards that make lasting first impressions and keep you top-of-mind.
          </p>
          <div class="space-y-2 text-sm text-gray-500">
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Standard & premium finishes
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              QR codes for digital contact
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Multiple design concepts
            </div>
          </div>
        </div>

        <!-- Logo Service -->
        <div class="group bg-white p-6 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 relative overflow-hidden">
          <div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-yellow-500 to-orange-500 opacity-10 rounded-bl-full"></div>
          <div class="absolute top-4 right-4 bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
            $25
          </div>
          <div class="text-4xl mb-4 transform group-hover:scale-110 transition-transform duration-300">‚ö°</div>
          <h4 class="text-xl font-bold text-gray-800 pr-16 mb-3">
            Logo Design
          </h4>
          <p class="text-gray-600 mb-4 leading-relaxed">
            Memorable logos that capture your brand essence and work perfectly across all platforms.
          </p>
          <div class="space-y-2 text-sm text-gray-500">
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Vector & raster formats
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Color & B&W versions
            </div>
            <div class="flex items-center">
              <span class="text-green-500 mr-2">‚úì</span>
              Brand guidelines included
            </div>
          </div>
        </div>
      </div>

      <!-- Service Benefits Section -->
      <div class="mt-20 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-8">
        <div class="text-center mb-12">
          <h4 class="text-3xl font-bold text-gray-800 mb-4">Why Choose Visual Vibe Studio?</h4>
          <p class="text-gray-600 max-w-2xl mx-auto">Every project includes these premium features at no extra cost</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
          <div class="text-center">
            <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl">üöÄ</span>
            </div>
            <h5 class="font-semibold text-gray-800 mb-2">Fast Delivery</h5>
            <p class="text-gray-600 text-sm">Most projects completed within 5-7 business days</p>
          </div>

          <div class="text-center">
            <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl">üé®</span>
            </div>
            <h5 class="font-semibold text-gray-800 mb-2">Free Revisions</h5>
            <p class="text-gray-600 text-sm">Up to 3 rounds of revisions included</p>
          </div>

          <div class="text-center">
            <div class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl">üì±</span>
            </div>
            <h5 class="font-semibold text-gray-800 mb-2">Mobile Optimized</h5>
            <p class="text-gray-600 text-sm">All designs work perfectly on any device</p>
          </div>

          <div class="text-center">
            <div class="bg-yellow-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
              <span class="text-2xl">üéØ</span>
            </div>
            <h5 class="font-semibold text-gray-800 mb-2">Results Focused</h5>
            <p class="text-gray-600 text-sm">Designs proven to increase conversions</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Customer Testimonials Section -->
    <section class="py-20 brand-gradient-bg text-white relative overflow-hidden">
      <!-- Professional Background Elements -->
      <div class="absolute inset-0 geometric-pattern opacity-20"></div>
      <div class="floating-elements">
        <div class="absolute top-1/4 left-1/4 w-32 h-32 glass-morphism rounded-full neon-glow"></div>
        <div class="absolute bottom-1/4 right-1/4 w-24 h-24 glass-morphism rounded-full neon-glow" style="animation-delay: 2s;"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-40 h-40 glass-morphism rounded-full neon-glow" style="animation-delay: 4s;"></div>
      </div>

      <!-- Professional Mesh Overlay -->
      <div class="absolute inset-0 professional-mesh opacity-30"></div>

      <div class="relative z-10 max-w-7xl mx-auto px-4">
        <div class="text-center mb-16">
          <h3 class="text-4xl font-bold mb-4">What Our Customers Say</h3>
          <p class="text-xl text-purple-200 max-w-3xl mx-auto">
            Don't just take our word for it - hear from businesses that have transformed their brand with Visual Vibe Studio.
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          <!-- Recent Review 1 - Sarah M. -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-4">
              <div class="bg-gradient-to-br from-red-400 to-orange-500 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                <span class="text-white font-bold">S</span>
              </div>
              <div>
                <h4 class="font-semibold text-white text-sm">Sarah M.</h4>
                <p class="text-purple-200 text-xs">Restaurant Owner</p>
              </div>
            </div>
            <div class="mb-3">
              <div class="text-yellow-400 text-sm">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
              <div class="bg-blue-600 text-white px-2 py-1 rounded-full text-xs inline-block mt-1">Business Website</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-3 text-sm">
              "Visual Vibe Studio completely transformed our restaurant's online presence! Our new website increased online orders by 200% in just 3 weeks."
            </p>
            <div class="text-green-400 font-semibold text-xs">
              üöÄ +200% Online Orders
            </div>
          </div>

          <!-- Recent Review 2 - Marcus T. -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-4">
              <div class="bg-gradient-to-br from-green-400 to-teal-500 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                <span class="text-white font-bold">M</span>
              </div>
              <div>
                <h4 class="font-semibold text-white text-sm">Marcus T.</h4>
                <p class="text-purple-200 text-xs">Tech Startup CEO</p>
              </div>
            </div>
            <div class="mb-3">
              <div class="text-yellow-400 text-sm">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
              <div class="bg-purple-600 text-white px-2 py-1 rounded-full text-xs inline-block mt-1">Logo Design</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-3 text-sm">
              "The logo design exceeded all our expectations! It perfectly captures our innovative spirit and has become instantly recognizable."
            </p>
            <div class="text-green-400 font-semibold text-xs">
              üìà +400% Brand Recognition
            </div>
          </div>

          <!-- Recent Review 3 - Lisa R. -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-4">
              <div class="bg-gradient-to-br from-pink-400 to-purple-500 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                <span class="text-white font-bold">L</span>
              </div>
              <div>
                <h4 class="font-semibold text-white text-sm">Lisa R.</h4>
                <p class="text-purple-200 text-xs">Fitness Center Manager</p>
              </div>
            </div>
            <div class="mb-3">
              <div class="text-yellow-400 text-sm">‚≠êÔøΩÔøΩÔøΩ‚≠ê‚≠ê‚≠ê</div>
              <div class="bg-orange-600 text-white px-2 py-1 rounded-full text-xs inline-block mt-1">Marketing Flyer</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-3 text-sm">
              "The marketing flyers were absolutely stunning! Our new member sign-ups increased by 75% in the first month."
            </p>
            <div class="text-green-400 font-semibold text-xs">
              üí™ +75% New Members
            </div>
          </div>

          <!-- Recent Review 4 - David K. -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-4">
              <div class="bg-gradient-to-br from-blue-400 to-indigo-500 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                <span class="text-white font-bold">D</span>
              </div>
              <div>
                <h4 class="font-semibold text-white text-sm">David K.</h4>
                <p class="text-purple-200 text-xs">Real Estate Agent</p>
              </div>
            </div>
            <div class="mb-3">
              <div class="text-yellow-400 text-sm">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
              <div class="bg-red-600 text-white px-2 py-1 rounded-full text-xs inline-block mt-1">Business Cards</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-3 text-sm">
              "Professional business cards that make a lasting impression! The design is clean, memorable, and perfectly represents my brand."
            </p>
            <div class="text-green-400 font-semibold text-xs">
              ‚ú® Professional Impact
            </div>
          </div>

          <!-- Testimonial 2 -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-6">
              <div class="bg-gradient-to-br from-blue-400 to-purple-500 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                <span class="text-white font-bold text-lg">M</span>
              </div>
              <div>
                <h4 class="font-semibold text-white">Michael</h4>
                <p class="text-purple-200 text-sm">Tech Company CEO</p>
              </div>
            </div>
            <div class="mb-4">
              <div class="text-yellow-400 text-lg">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-4">
              "The logo design exceeded all expectations! It perfectly captures our innovative spirit. Brand recognition has increased by 300% since the rebrand. Worth every penny!"
            </p>
            <div class="text-green-400 font-semibold text-sm">
              üìà +300% Brand Recognition
            </div>
          </div>

          <!-- Testimonial 3 -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-6">
              <div class="bg-gradient-to-br from-green-400 to-teal-500 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                <span class="text-white font-bold text-lg">L</span>
              </div>
              <div>
                <h4 class="font-semibold text-white">Lisa</h4>
                <p class="text-purple-200 text-sm">Fitness Center Manager</p>
              </div>
            </div>
            <div class="mb-4">
              <div class="text-yellow-400 text-lg">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-4">
              "The marketing materials package was amazing! Our new flyers and brochures generated over 50 new memberships in the first month. Professional quality at an affordable price."
            </p>
            <div class="text-green-400 font-semibold text-sm">
              üí™ 50+ New Members
            </div>
          </div>
          <!-- Recent Review 8 - Jennifer -->
          <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 transform hover:scale-105 transition-all duration-300">
            <div class="flex items-center mb-4">
              <div class="bg-gradient-to-br from-indigo-400 to-blue-500 w-10 h-10 rounded-full flex items-center justify-center mr-3">
                <span class="text-white font-bold">J</span>
              </div>
              <div>
                <h4 class="font-semibold text-white text-sm">Jennifer</h4>
                <p class="text-purple-200 text-xs">Marketing Director</p>
              </div>
            </div>
            <div class="mb-3">
              <div class="text-yellow-400 text-sm">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
              <div class="bg-teal-600 text-white px-2 py-1 rounded-full text-xs inline-block mt-1">Brand Package</div>
            </div>
            <p class="text-purple-100 leading-relaxed mb-3 text-sm">
              "The complete brand package exceeded expectations! Logo, website, and marketing materials all perfectly aligned. Our brand now looks incredibly professional."
            </p>
            <div class="text-green-400 font-semibold text-xs">
              üé® Complete Branding
            </div>
          </div>
        </div>

        <!-- Overall Stats -->
        <div class="mt-16 text-center">
          <div class="bg-white/5 backdrop-blur-sm rounded-2xl p-8 inline-block">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
              <div>
                <div class="text-3xl font-bold text-yellow-400 mb-2">250+</div>
                <p class="text-purple-200">Happy Customers</p>
              </div>
              <div>
                <div class="text-3xl font-bold text-green-400 mb-2"><span id="averageRating1">4.9</span>/5</div>
                <p class="text-purple-200">Average Rating</p>
              </div>
              <div>
                <div class="text-3xl font-bold text-blue-400 mb-2">98%</div>
                <p class="text-purple-200">Customer Satisfaction</p>
              </div>
            </div>
          </div>
        </div>

        <!-- CTA -->
        <div class="text-center mt-12">
          <h4 class="text-2xl font-bold mb-4">Ready to Join Our Success Stories?</h4>
          <a href="#order" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-gray-900 px-8 py-4 rounded-full font-bold text-lg hover:from-yellow-300 hover:to-orange-400 transition-all duration-300 transform hover:scale-105 shadow-2xl">
            Get Started Today
          </a>
        </div>
      </div>
    </section>

    <!-- Professional Section Divider -->
    <div class="section-divider"></div>

    <!-- Customer Reviews Section -->
    <section id="reviews" style="background: #ffffff; padding: 80px 0; position: relative;">
      <div class="max-w-7xl mx-auto px-4">


        <div class="flex justify-center">
          <!-- Review Form -->
          <div class="w-full max-w-2xl">
            <div style="background: linear-gradient(135deg, #6366f1, #8b5cf6); padding: 20px; border: 4px solid #ffffff; border-radius: 20px; box-shadow: 0 20px 40px rgba(99, 102, 241, 0.3); display: block !important; visibility: visible !important;">
              <h4 style="font-size: 32px; font-weight: bold; text-align: center; margin-bottom: 30px; color: #ffffff; text-transform: uppercase;">üìù Leave a Review üìù</h4>

              <!-- Website Themed Review Form -->
              <form id="reviewForm" style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px); color: #ffffff; padding: 30px; border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 15px; margin: 20px 0; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);">
                <h5 style="color: #ffffff; font-size: 24px; font-weight: bold; margin-bottom: 25px; text-align: center;">üìù LEAVE YOUR REVIEW</h5>

                <div style="margin-bottom: 25px;">
                  <label style="display: block; color: #ffffff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">üë§ Your Name:</label>
                  <input id="reviewerName" type="text" required style="width: 100%; padding: 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 18px; box-sizing: border-box; background: #ffffff; color: #374151; focus:border-color: #6366f1;" placeholder="Enter your name">
                </div>

                <div style="margin-bottom: 25px;">
                  <label style="display: block; color: #ffffff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">üè¢ Business Type:</label>
                  <input id="businessType" type="text" style="width: 100%; padding: 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 18px; box-sizing: border-box; background: #ffffff; color: #374151;" placeholder="e.g., Restaurant, Tech Company">
                </div>

                <div style="margin-bottom: 25px;">
                  <label style="display: block; color: #ffffff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">‚≠ê Rating:</label>
                  <input type="hidden" id="selectedRating" value="0">
                  <div style="font-size: 40px; margin-bottom: 15px; text-align: center;">
                    <span class="star-rating" data-rating="1" onclick="window.setRating(1)" style="cursor: pointer; margin-right: 10px; filter: drop-shadow(2px 2px 4px rgba(255,255,255,0.8)); color: #ffffff;">‚≠ê</span>
                    <span class="star-rating" data-rating="2" onclick="window.setRating(2)" style="cursor: pointer; margin-right: 10px; filter: drop-shadow(2px 2px 4px rgba(255,255,255,0.8)); color: #ffffff;">‚≠ê</span>
                    <span class="star-rating" data-rating="3" onclick="window.setRating(3)" style="cursor: pointer; margin-right: 10px; filter: drop-shadow(2px 2px 4px rgba(255,255,255,0.8)); color: #ffffff;">‚≠ê</span>
                    <span class="star-rating" data-rating="4" onclick="window.setRating(4)" style="cursor: pointer; margin-right: 10px; filter: drop-shadow(2px 2px 4px rgba(255,255,255,0.8)); color: #ffffff;">‚≠ê</span>
                    <span class="star-rating" data-rating="5" onclick="window.setRating(5)" style="cursor: pointer; margin-right: 10px; filter: drop-shadow(2px 2px 4px rgba(255,255,255,0.8)); color: #ffffff;">‚≠ê</span>
                  </div>
                </div>

                <div style="margin-bottom: 25px;">
                  <label style="display: block; color: #ffffff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">üé® Service Used:</label>
                  <select id="serviceUsed" required style="width: 100%; padding: 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 18px; box-sizing: border-box; background: #ffffff; color: #374151;">
                    <option value="">Select a service</option>
                    <option value="Business Website">Business Website</option>
                    <option value="Business Brochure">Business Brochure</option>
                    <option value="Marketing Flyer">Marketing Flyer</option>
                    <option value="Business Cards">Business Cards</option>
                    <option value="Logo Design">Logo Design</option>
                    <option value="Multiple Services">Multiple Services</option>
                  </select>
                </div>

                <div style="margin-bottom: 25px;">
                  <label style="display: block; color: #ffffff; font-weight: bold; margin-bottom: 10px; font-size: 18px;">üí¨ Your Review:</label>
                  <textarea id="reviewText" required rows="5" style="width: 100%; padding: 15px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 18px; box-sizing: border-box; resize: vertical; background: #ffffff; color: #374151;" placeholder="Tell us about your experience with Visual Vibe Studio..." maxlength="500"></textarea>
                  <div style="color: #ffffff; text-align: right; margin-top: 5px; font-size: 14px;">
                    <span id="charCount">0</span>/500 characters
                  </div>
                </div>

                <button type="submit" onclick="return window.submitReview(event)" style="width: 100%; background: linear-gradient(to right, #6366f1, #8b5cf6); color: #ffffff; border: none; padding: 20px; border-radius: 15px; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3); text-transform: uppercase; transition: all 0.3s ease; hover:from-indigo-700 hover:to-purple-700;">
                  üöÄ Submit Review Now
                </button>


              </form>
            </div>
          </div>

        </div>
      </div>
    </section>

    <section id="order" class="bg-white py-16 px-4">
      <div class="max-w-4xl mx-auto">
        <!-- Order Header -->
        <div class="text-center mb-12">
          <h3 class="text-4xl font-bold text-gray-800 mb-4">Ready to Transform Your Business?</h3>
          <p class="text-xl text-gray-600 mb-6">Join 200+ satisfied customers who've boosted their business with our designs</p>



          <!-- Limited Time Offer -->
          <div class="bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl p-4 inline-block mb-8">
            <div class="flex items-center justify-center space-x-2">
              <span class="text-xl">üî•</span>
              <div>
                <div class="font-bold">LIMITED TIME: Free Rush Delivery!</div>
                <div class="text-sm opacity-90">Get your project 2 days faster - FREE ($50 value)</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Trust Indicators Row -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div class="bg-green-50 border border-green-200 rounded-xl p-4 text-center">
            <div class="text-2xl mb-2">üîí</div>
            <h4 class="font-semibold text-green-800 mb-1">100% Secure</h4>
            <p class="text-green-600 text-sm">Your data is protected</p>
          </div>
          <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 text-center">
            <div class="text-2xl mb-2">‚ö°</div>
            <h4 class="font-semibold text-blue-800 mb-1">Fast Delivery</h4>
            <p class="text-blue-600 text-sm">5-7 days completion</p>
          </div>
          <div class="bg-purple-50 border border-purple-200 rounded-xl p-4 text-center">
            <div class="text-2xl mb-2">üíé</div>
            <h4 class="font-semibold text-purple-800 mb-1">Premium Quality</h4>
            <p class="text-purple-600 text-sm">Professional results</p>
          </div>
        </div>

        <form class="space-y-6 bg-white rounded-2xl p-8 shadow-lg" id="orderForm" onsubmit="event.preventDefault(); return false;">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block mb-2 font-semibold text-gray-700 flex items-center">
                <span class="mr-2">üè¢</span>
                Business Name
              </label>
              <input
                type="text"
                name="businessName"
                required
                class="w-full border-2 border-gray-200 p-4 rounded-xl form-field focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all duration-300"
                placeholder="Enter your business name"
                maxlength="100"
              />
            </div>
            <div>
              <label class="block mb-2 font-semibold text-gray-700 flex items-center">
                <span class="mr-2">üè≠</span>
                Business Industry
              </label>
              <input
                type="text"
                name="industry"
                required
                class="w-full border-2 border-gray-200 p-4 rounded-xl form-field focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all duration-300"
                placeholder="e.g., Restaurant, Real Estate, Technology"
                maxlength="50"
              />
            </div>
          </div>
          <div>
            <label class="block mb-2 font-semibold text-gray-700 flex items-center">
              <span class="mr-2">üìé</span>
              Upload Business Logo (Optional)
            </label>
            <div class="border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-indigo-400 transition-colors duration-300">
              <input
                type="file"
                name="logo"
                accept="image/*"
                class="w-full"
              />
              <p class="text-gray-500 text-sm mt-2">Upload your current logo for brand consistency</p>
            </div>
          </div>

          <div>
            <label class="block mb-2 font-semibold text-gray-700 flex items-center">
              <span class="mr-2">üé®</span>
              Choose Services (Hold Ctrl/Cmd for multiple)
            </label>
            <select
              name="services"
              multiple
              required
              class="w-full border-2 border-gray-200 p-4 rounded-xl form-field focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all duration-300 min-h-[120px]"
              aria-label="Select services"
            >
              <option value="website" data-price="100">
                Business Page Builder - From $100
              </option>
              <option value="brochure" data-price="80">
                Business Brochure Design - $80
              </option>
              <option value="flyer" data-price="65">
                Business Flyer Design - $65
              </option>
              <option value="card" data-price="50">
                Business Card Design - $50
              </option>
              <option value="logo" data-price="25">
                Business Logo Design - $25
              </option>
            </select>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
              <label class="block mb-2 font-semibold text-gray-700 flex items-center">
                <span class="mr-2">üìÖ</span>
                Preferred Completion Date
              </label>
              <input
                type="date"
                name="dueDate"
                required
                class="w-full border-2 border-gray-200 p-4 rounded-xl focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all duration-300"
              />
            </div>
            <div>
              <label class="block mb-2 font-semibold text-gray-700 flex items-center">
                <span class="mr-2">üìß</span>
                Contact Email
              </label>
              <input
                type="email"
                name="email"
                required
                class="w-full border-2 border-gray-200 p-4 rounded-xl form-field focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all duration-300"
                placeholder="your@email.com"
              />
            </div>
            <div>
              <label class="block mb-2 font-semibold text-gray-700 flex items-center">
                <span class="mr-2">üì±</span>
                Phone Number (Optional)
              </label>
              <input
                type="tel"
                name="phone"
                class="w-full border-2 border-gray-200 p-4 rounded-xl form-field focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition-all duration-300"
                placeholder="(555) 123-4567"
              />
            </div>
          </div>
          <!-- Enhanced Payment Policy -->
          <div class="bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-6">
            <div class="flex items-start space-x-3">
              <div class="bg-green-500 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                <span class="text-white text-sm font-bold">üí≥</span>
              </div>
              <div>
                <h4 class="font-semibold text-gray-800 mb-2">Simple Payment Process</h4>
                <div class="space-y-1 text-sm text-gray-600">
                  <p>üí≥ <strong>Only 50% upfront</strong> - Pay half now, half when you love the design</p>
                  <p>üîÑ <strong>3 free revisions</strong> - We'll perfect it until you're 100% satisfied</p>
                  <p>‚ö° <strong>Venmo payment</strong> - Quick, secure, and convenient</p>

                </div>
              </div>
            </div>
          </div>

          <!-- Enhanced Submit Button -->
          <div class="text-center pt-6">
            <button
              type="button"
              id="submitOrderBtn"
              class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-6 px-8 rounded-2xl font-bold text-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105 shadow-2xl flex items-center justify-center space-x-3"
              onclick="console.log('üéØ Button clicked!'); simpleOrderSubmit(event); return false;"
            >
              <span>üöÄ</span>
              <span id="submitBtnText">Start My Project Now</span>
              <span>üöÄ</span>
            </button>
            <p class="text-gray-500 text-sm mt-3">‚ú® Free rush delivery included</p>
          </div>
          <div id="paypal-button-container" class="mt-6 hidden"></div>


        </form>
      </div>
    </section>

    <!-- Professional Section Divider -->
    <div class="section-divider"></div>

    <section
      id="contact"
      class="py-20 relative overflow-hidden"
    >
      <!-- Sophisticated Contact Background -->
      <div class="absolute inset-0 brand-gradient-bg opacity-5"></div>
      <div class="absolute inset-0 bg-gradient-to-br from-indigo-50 via-white to-purple-50"></div>
      <div class="absolute inset-0 geometric-pattern opacity-10"></div>
      <div class="absolute inset-0">
        <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-gradient-to-r from-indigo-200/20 to-transparent rounded-full blur-3xl"></div>
        <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-gradient-to-l from-purple-200/20 to-transparent rounded-full blur-3xl"></div>
      </div>
      <div class="relative z-10 max-w-7xl mx-auto px-4">
        <div class="text-center mb-16">
          <h3 class="text-5xl font-bold text-gray-800 mb-4">Get in Touch</h3>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Ready to bring your vision to life? Contact Visual Vibe Studio today
            and let's create something amazing together.
          </p>
        </div>

        <!-- Main Contact Card -->
        <div class="bg-white rounded-3xl shadow-2xl overflow-hidden mb-12">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-0">
            <!-- Contact Methods -->
            <div class="lg:col-span-2 p-12">
              <h4
                class="text-3xl font-bold text-indigo-600 mb-8 text-center lg:text-left"
              >
                Let's Connect
              </h4>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                <!-- Email -->
                <div
                  class="group hover:bg-indigo-50 p-6 rounded-xl transition-all duration-300"
                >
                  <div class="flex items-center mb-4">
                    <div
                      class="bg-gradient-to-r from-indigo-500 to-purple-600 p-4 rounded-full mr-6 group-hover:scale-110 transition-transform duration-300"
                    >
                      <svg
                        class="w-8 h-8 text-white"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"
                        />
                        <path
                          d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"
                        />
                      </svg>
                    </div>
                    <div>
                      <p class="text-lg font-semibold text-gray-800">
                        Email Us
                      </p>
                      <p class="text-sm text-gray-500">Send us a message</p>
                    </div>
                  </div>
                  <div class="flex items-center gap-2">
                    <a
                      href="mailto:support@visualvibestudio.store"
                      class="text-lg font-medium text-indigo-600 hover:text-indigo-800 transition-colors break-all"
                      onclick="handleEmailClick(event, 'support@visualvibestudio.store')"
                    >
                      support@visualvibestudio.store
                    </a>
                    <button
                      onclick="copyToClipboard('support@visualvibestudio.store', 'Email address copied!')"
                      class="text-gray-400 hover:text-indigo-600 transition-colors p-1 rounded"
                      title="Copy email address"
                    >
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <!-- Phone -->
                <div
                  class="group hover:bg-indigo-50 p-6 rounded-xl transition-all duration-300"
                >
                  <div class="flex items-center mb-4">
                    <div
                      class="bg-gradient-to-r from-green-500 to-teal-600 p-4 rounded-full mr-6 group-hover:scale-110 transition-transform duration-300"
                    >
                      <svg
                        class="w-8 h-8 text-white"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"
                        />
                      </svg>
                    </div>
                    <div>
                      <p class="text-lg font-semibold text-gray-800">Call Us</p>
                      <p class="text-sm text-gray-500">Speak with our team</p>
                    </div>
                  </div>
                  <a
                    href="tel:+14029797184"
                    class="text-xl font-medium text-green-600 hover:text-green-800 transition-colors"
                  >
                    (402) 979-7184
                  </a>
                </div>
              </div>

              <!-- Additional Info -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Website -->
                <div
                  class="group hover:bg-indigo-50 p-6 rounded-xl transition-all duration-300"
                >
                  <div class="flex items-center mb-4">
                    <div
                      class="bg-gradient-to-r from-blue-500 to-cyan-600 p-4 rounded-full mr-6 group-hover:scale-110 transition-transform duration-300"
                    >
                      <svg
                        class="w-8 h-8 text-white"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.56-.5-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.56.5.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.498-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z"
                          clip-rule="evenodd"
                        />
                      </svg>
                    </div>
                    <div>
                      <p class="text-lg font-semibold text-gray-800">Website</p>
                      <p class="text-sm text-gray-500">Visit us online</p>
                    </div>
                  </div>
                  <span class="text-lg font-medium text-gray-800">
                    www.visualvibestudio.store
                  </span>
                </div>

                <!-- Location -->
                <div
                  class="group hover:bg-indigo-50 p-6 rounded-xl transition-all duration-300"
                >
                  <div class="flex items-center mb-4">
                    <div
                      class="bg-gradient-to-r from-red-500 to-pink-600 p-4 rounded-full mr-6 group-hover:scale-110 transition-transform duration-300"
                    >
                      <svg
                        class="w-8 h-8 text-white"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                          clip-rule="evenodd"
                        />
                      </svg>
                    </div>
                    <div>
                      <p class="text-lg font-semibold text-gray-800">
                        Service Area
                      </p>
                      <p class="text-sm text-gray-500">
                        We serve clients nationwide
                      </p>
                    </div>
                  </div>
                  <p class="text-lg font-medium text-red-600">
                    Remote & Local Services
                  </p>
                </div>
              </div>
            </div>

            <!-- Business Hours & Info -->
            <div
              class="bg-gradient-to-br from-indigo-600 to-purple-700 p-12 text-white"
            >
              <h5 class="text-2xl font-bold mb-8">Business Hours</h5>

              <div class="space-y-4 mb-8">
                <div
                  class="flex justify-between items-center border-b border-indigo-400 pb-2"
                >
                  <span class="font-medium">Monday - Friday</span>
                  <span class="text-indigo-200">9:00 AM - 6:00 PM</span>
                </div>
                <div
                  class="flex justify-between items-center border-b border-indigo-400 pb-2"
                >
                  <span class="font-medium">Saturday</span>
                  <span class="text-indigo-200">10:00 AM - 4:00 PM</span>
                </div>
                <div
                  class="flex justify-between items-center border-b border-indigo-400 pb-2"
                >
                  <span class="font-medium">Sunday</span>
                  <span class="text-indigo-200">Closed</span>
                </div>
              </div>

              <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6">
                <h6 class="text-lg font-semibold mb-3">Quick Response</h6>
                <p class="text-indigo-100 text-sm mb-4">
                  We typically respond to all inquiries within 2-4 hours during
                  business hours.
                </p>

                <div id="onlineStatus" class="flex items-center space-x-2">
                  <div
                    class="w-2 h-2 bg-green-400 rounded-full animate-pulse"
                  ></div>
                  <span class="text-sm text-indigo-200">Online now</span>
                </div>
              </div>

              <div class="mt-8 pt-8 border-t border-indigo-400">
                <p class="text-sm text-indigo-200 italic">
                  "Professional designs that make your business stand out."
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Call to Action -->
        <div class="text-center bg-white rounded-2xl shadow-lg p-8">
          <h4 class="text-2xl font-bold text-gray-800 mb-4">
            Ready to Get Started?
          </h4>
          <p class="text-gray-600 mb-6">
            Contact us today to discuss your project and get a custom quote.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <div class="flex gap-2">
              <button
                onclick="handleEmailClick(event, 'support@visualvibestudio.store')"
                id="mainSendEmailBtn"
                type="button"
                class="bg-indigo-600 text-white px-8 py-4 rounded-lg font-semibold hover:bg-indigo-700 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center gap-2 active:scale-95"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
                <span id="sendEmailBtnText">Send Email</span>
              </button>
              <button
                onclick="copyToClipboard('support@visualvibestudio.store', 'Email address copied to clipboard!')"
                class="bg-indigo-100 text-indigo-600 px-4 py-4 rounded-lg font-semibold hover:bg-indigo-200 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-1"
                title="Copy email address"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                </svg>
              </button>
            </div>
            <a
              href="tel:+14029797184"
              class="bg-green-600 text-white px-8 py-4 rounded-lg font-semibold hover:bg-green-700 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center gap-2 justify-center"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
              </svg>
              Call Now
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Sign In Modal -->
    <div id="signInModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" style="z-index: 9999; display: none;">
      <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800">Sign In</h3>
          <button onclick="closeSignInModal()" class="text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <form id="signInForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
            <input type="email" id="signInEmail" required class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="your@email.com">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
            <input type="password" id="signInPassword" required class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your password">
          </div>

          <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors">
            Sign In
          </button>
        </form>

        <p class="text-center text-sm text-gray-600 mt-4">
          Don't have an account?
          <button onclick="switchToSignUp()" class="text-indigo-600 hover:text-indigo-800 font-medium">Sign up</button>
        </p>
      </div>
    </div>

    <!-- Sign Up Modal -->
    <div id="signUpModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden" style="z-index: 9999; display: none;">
      <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800">Create Account</h3>
          <button onclick="closeSignUpModal()" class="text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <form id="signUpForm" class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
            <input type="text" id="signUpName" required class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your full name">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
            <input type="email" id="signUpEmail" required class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="your@email.com">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
            <input type="password" id="signUpPassword" required class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Create a password" minlength="6">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
            <input type="password" id="signUpConfirmPassword" required class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Confirm your password">
          </div>

          <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition-colors">
            Create Account
          </button>
        </form>

        <p class="text-center text-sm text-gray-600 mt-4">
          Already have an account?
          <button onclick="switchToSignIn()" class="text-indigo-600 hover:text-indigo-800 font-medium">Sign in</button>
        </p>
      </div>
    </div>

    <!-- Order History Modal -->
    <div id="orderHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-white rounded-xl p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800">My Orders & Receipts</h3>
          <button onclick="closeOrderHistory()" class="text-gray-500 hover:text-gray-700">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <div id="orderHistoryContent" class="space-y-4">
          <div class="text-center py-8 text-gray-500">
            <p>Loading your orders...</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Floating Phone Button -->
    <div class="floating-action no-print">
      <a href="tel:+14029797184" class="floating-phone" title="Call us now!">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
        </svg>
      </a>
    </div>

    <!-- Live Chat Widget -->
    <div class="chat-widget no-print">
      <div class="chat-bubble" onclick="safeToggleChat()" id="chatBubble">
        <svg id="chatIcon" class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-1.946-.273L3 21l1.273-8.054A8.955 8.955 0 013 12C3 7.582 6.582 4 11 4s8 3.582 8 8z"/>
        </svg>
        <svg id="closeIcon" class="w-6 h-6 text-white hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </div>

      <div class="chat-notification hidden" id="chatNotification">1</div>

      <div class="chat-window" id="chatWindow">
        <div class="chat-header">
          <div>
            <h4 class="font-semibold">Chat with Yoshiko</h4>
            <div class="agent-status">
              <div class="status-dot"></div>
              <span>Messages sent to (402) 979-7184</span>
            </div>
          </div>
          <button onclick="safeToggleChat()" class="text-white hover:text-gray-200 transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <div class="chat-messages" id="chatMessages">
          <div class="chat-message agent">
            <div>Hi! üëã This is Yoshiko from Visual Vibe Studio!</div>
          </div>
          <div class="chat-message agent">
            <div>Your messages go directly to my phone so I can respond quickly. How can I help you with your design needs today?</div>
          </div>
          <div class="chat-message agent">
            <div>üí¨ <strong>For immediate help:</strong> Call me at (402) 979-7184</div>
          </div>
        </div>

        <div class="chat-input-area">
          <!-- Webhook Status Indicator -->
          <div id="webhookStatus" class="mb-2 text-center">
            <div class="flex items-center justify-center space-x-2 text-xs text-green-600">
              <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
              <span>Connected to (402) 979-7184 via Zapier</span>
            </div>
            <div class="text-xs text-gray-500 mt-1">
              Messages go directly to your phone
            </div>
          </div>

          <div class="chat-input-container">
            <textarea
              id="chatInput"
              class="chat-input"
              placeholder="Message Yoshiko directly..."
              rows="1"
              onkeypress="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();simpleSend();}"
              oninput="this.style.height='auto';this.style.height=Math.min(this.scrollHeight,100)+'px';enableSendButton();"
            ></textarea>
            <button
              id="chatSendBtn"
              class="chat-send-btn"
              onclick="simpleSend()"
              disabled
              title="Send message to Yoshiko"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
              </svg>
            </button>
          </div>

          <!-- Quick Actions -->
          <div class="mt-3 flex justify-center space-x-4 text-xs">
            <button onclick="callDirectly()" class="text-green-600 hover:text-green-800 flex items-center space-x-1 transition-colors">
              <span>üìû</span>
              <span>Call (402) 979-7184</span>
            </button>
            <button onclick="emailDirectly()" class="text-blue-600 hover:text-blue-800 flex items-center space-x-1 transition-colors">
              <span>üìß</span>
              <span>Email Support</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-center text-sm text-gray-500 py-4">
      &copy; 2025 Visual Vibe Studio | www.visualvibestudio.store. All rights
      reserved.
    </footer>

    <script>
      // Global error handling and recovery
      window.addEventListener("error", function (e) {
        console.error("JavaScript error:", e.error, "at", e.filename, ":", e.lineno);

        // Try to provide helpful error recovery
        const errorMsg = e.error ? e.error.message : 'Unknown error';

        // Only show user-facing errors for critical functions
        if (errorMsg.includes('element') || errorMsg.includes('null') || errorMsg.includes('undefined')) {
          // This might be a DOM-related error
          setTimeout(() => {
            if (typeof showAlert === 'function') {
              showAlert('A page element could not be loaded. Please refresh the page if features are not working properly.', 'info');
            }
          }, 2000);
        }

        // Don't crash the page, just log the error
        return true;
      });

      // Global unhandled promise rejection handler
      window.addEventListener("unhandledrejection", function(e) {
        console.error("Unhandled promise rejection:", e.reason);
        // Prevent the error from being logged to console as uncaught
        e.preventDefault();
      });

      // Ensure DOM is loaded before initializing
      document.addEventListener("DOMContentLoaded", function () {
        initializeWebsite();
      });

      var venmoPaymentShown = false;
      // chatInitialized already initialized at top of script

      // Track Venmo app clicks for analytics and fallback handling
      function trackVenmoClick() {
        try {
          console.log('Venmo app link clicked');

          // Show a brief message to help users
          setTimeout(() => {
            showAlert('If Venmo app didn\'t open, you can manually send payment to @Yoshiko-Swafford', 'info');
          }, 3000);
        } catch (error) {
          console.error('Error tracking Venmo click:', error);
        }
      }

      // System diagnostic and auto-repair function
      function diagnoseAndRepair() {
        console.log('üîß Running system diagnostics...');

        let issues = [];
        let repairs = [];

        // Check critical DOM elements
        const criticalElements = [
          'orderForm',
          'chatWindow',
          'chatBubble',
          'reviewForm',
          'signInModal',
          'signUpModal'
        ];

        criticalElements.forEach(id => {
          if (!document.getElementById(id)) {
            issues.push(`Missing element: ${id}`);
          }
        });

        // Check if chat is initialized
        if (!chatInitialized) {
          issues.push('Chat system not initialized');
          try {
            forceInitializeChat();
            repairs.push('Chat system reinitialized');
          } catch (error) {
            console.error('Failed to repair chat:', error);
          }
        }

        // Check if auth system is working
        try {
          updateAuthUI();
          repairs.push('Auth UI refreshed');
        } catch (error) {
          issues.push('Auth system error');
        }

        // Report results
        console.log('üîç Issues found:', issues);
        console.log('‚úÖ Repairs completed:', repairs);

        if (issues.length === 0 && repairs.length > 0) {
          if (typeof showAlert === 'function') {
            showAlert('System diagnostics completed. Some issues were automatically fixed.', 'success');
          }
        } else if (issues.length > 0) {
          if (typeof showAlert === 'function') {
            showAlert(`Found ${issues.length} system issues. Please refresh the page for optimal performance.`, 'warning');
          }
        }

        return { issues, repairs };
      }

      // Order form functions (defined at script start to fix ReferenceError)

      function setupOrderFormEnhancements() {
        try {
          const form = document.getElementById('orderForm');
          if (!form) return;

          // Add event listeners to form fields for real-time validation
          const fields = form.querySelectorAll('input[required], select[required], textarea[required]');
          fields.forEach(field => {
            field.addEventListener('input', updateButtonState);
            field.addEventListener('change', updateButtonState);
            field.addEventListener('blur', updateButtonState);
          });

          // Initial button state update
          updateButtonState();

          console.log('Order form enhancements set up successfully');
        } catch (error) {
          console.error('Error setting up order form enhancements:', error);
        }
      }

      // Manual chat initialization fallback
      function forceInitializeChat() {
        try {
          console.log('üîÑ Force initializing chat system...');

          // Reset chat state
          chatOpen = false;
          hasUnreadMessages = false;

          // Verify all required elements exist
          const requiredElements = {
            chatWindow: document.getElementById('chatWindow'),
            chatBubble: document.getElementById('chatBubble'),
            chatIcon: document.getElementById('chatIcon'),
            closeIcon: document.getElementById('closeIcon'),
            chatMessages: document.getElementById('chatMessages'),
            chatInput: document.getElementById('chatInput'),
            chatSendBtn: document.getElementById('chatSendBtn')
          };

          const missingElements = [];
          Object.keys(requiredElements).forEach(key => {
            if (!requiredElements[key]) {
              missingElements.push(key);
            }
          });

          if (missingElements.length > 0) {
            console.error('Missing chat elements:', missingElements);
            showAlert('Chat system elements missing. Please refresh the page.', 'error');
            return false;
          }

          // Reset button states
          const { chatBubble, chatIcon, closeIcon, chatWindow } = requiredElements;

          chatBubble.classList.remove('active');
          chatIcon.classList.remove('hidden');
          closeIcon.classList.add('hidden');
          chatWindow.classList.remove('open');
          chatWindow.style.display = 'none';

          // Set up event listeners if not already set
          const chatInput = requiredElements.chatInput;
          const chatSendBtn = requiredElements.chatSendBtn;

          if (chatInput && !chatInput.hasAttribute('data-initialized')) {
            chatInput.addEventListener('input', updateSendButton);
            chatInput.setAttribute('data-initialized', 'true');
          }

          if (chatSendBtn && !chatSendBtn.hasAttribute('data-initialized')) {
            console.log('üîß Adding click event listener to send button');
            chatSendBtn.addEventListener('click', function(event) {
              console.log('üñ±Ô∏è Send button clicked!', event);
              sendMessage();
            });
            chatSendBtn.setAttribute('data-initialized', 'true');
            console.log('‚úÖ Send button event listener added');
          } else {
            console.log('‚ö†Ô∏è Send button already initialized or not found', !!chatSendBtn);
          }

          // Initialize send button
          updateSendButton();

          chatInitialized = true;
          console.log('‚úÖ Chat force-initialized successfully');
          return true;
        } catch (error) {
          console.error('‚ùå Error force-initializing chat:', error);
          showAlert('Chat initialization failed. Please refresh the page.', 'error');
          return false;
        }
      }

      // Make chat functions globally accessible for debugging
      window.safeToggleChat = safeToggleChat;
      window.forceInitializeChat = forceInitializeChat;
      window.sendMessage = sendMessage;
      window.chatInitialized = () => chatInitialized;

      // Test function for chat system
      window.testChat = function() {
        console.log('Testing chat system...');
        console.log('Chat initialized:', chatInitialized);
        console.log('Chat elements:', {
          chatWindow: !!document.getElementById('chatWindow'),
          chatBubble: !!document.getElementById('chatBubble'),
          chatInput: !!document.getElementById('chatInput'),
          chatSendBtn: !!document.getElementById('chatSendBtn')
        });
        if (!chatInitialized) {
          console.log('Attempting to initialize chat...');
          forceInitializeChat();
        }
        console.log('Opening chat...');
        safeToggleChat();
      };

      function initializeWebsite() {
        try {
          // Validate required elements exist
          const orderForm = document.getElementById("orderForm");

          if (!orderForm) {
            console.error("Required form elements not found");
            return;
          }

          // Set minimum date for order form
          const dueDateInput = document.querySelector('input[name="dueDate"]');
          if (dueDateInput) {
            const today = new Date();
            const minDate = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000); // 7 days from now
            dueDateInput.min = minDate.toISOString().split("T")[0];
          }

          // Initialize user authentication
          console.log('Initializing authentication system...');
          try {
            initializeAuth();
            console.log('‚úÖ Authentication system initialized');
          } catch (error) {
            console.error('‚ùå Authentication initialization failed:', error);
            showAlert('Authentication system failed to initialize. Sign in/up may not work properly.', 'warning');
          }

          // Initialize review system
          console.log('Initializing review system...');
          try {
            initializeReviewSystem();
            console.log('‚úÖ Review system initialized');
          } catch (error) {
            console.error('‚ùå Review system initialization failed:', error);
          }

          // Initialize chat system
          console.log('Initializing chat system...');
          if (forceInitializeChat()) {
            console.log('‚úÖ Chat system initialized successfully');
          } else {
            console.warn('‚ö†Ô∏è Chat system initialization failed');
          }

        console.log("Website initialized successfully");
        } catch (error) {
          console.error("Error initializing website:", error);
        }
      }

      // User Authentication System
      // currentUser already initialized at top of script

      function initializeAuth() {
        // Check if user is already signed in
        const savedUser = localStorage.getItem('visualVibeUser');
        if (savedUser) {
          currentUser = JSON.parse(savedUser);
          updateAuthUI();
        }

        // Set up form event listeners with error handling
        const signInForm = document.getElementById('signInForm');
        const signUpForm = document.getElementById('signUpForm');

        if (signInForm) {
          signInForm.addEventListener('submit', handleSignIn);
        } else {
          console.warn('Sign in form not found during initialization');
        }

        if (signUpForm) {
          signUpForm.addEventListener('submit', handleSignUp);
        } else {
          console.warn('Sign up form not found during initialization');
        }
      }

      function updateAuthUI() {
        try {
          const signedOutState = document.getElementById('signedOutState');
          const signedInState = document.getElementById('signedInState');
          const userDisplayName = document.getElementById('userDisplayName');

          if (!signedOutState || !signedInState) {
            console.warn('Auth UI elements not found');
            return;
          }

          if (currentUser) {
            signedOutState.classList.add('hidden');
            signedInState.classList.remove('hidden');
            if (userDisplayName) {
              userDisplayName.textContent = currentUser.name;
            }
          } else {
            signedOutState.classList.remove('hidden');
            signedInState.classList.add('hidden');
          }
        } catch (error) {
          console.error('Error updating auth UI:', error);
        }
      }

      function handleSignIn(e) {
        e.preventDefault();

        try {
          const emailInput = document.getElementById('signInEmail');
          const passwordInput = document.getElementById('signInPassword');

          if (!emailInput || !passwordInput) {
            showAlert('Sign in form elements not found. Please refresh the page.', 'error');
            return;
          }

          const email = emailInput.value;
          const password = passwordInput.value;

          if (!email || !password) {
            showAlert('Please enter both email and password.', 'error');
            return;
          }

          // Get stored users
          const users = JSON.parse(localStorage.getItem('visualVibeUsers') || '[]');
          const user = users.find(u => u.email === email && u.password === password);

          if (user) {
            currentUser = { id: user.id, name: user.name, email: user.email };
            localStorage.setItem('visualVibeUser', JSON.stringify(currentUser));
            updateAuthUI();
            closeSignInModal();
            showAlert('Welcome back, ' + user.name + '!', 'success');
          } else {
            showAlert('Invalid email or password. Please try again.', 'error');
          }
        } catch (error) {
          console.error('Error in handleSignIn:', error);
          showAlert('Sign in error. Please try again.', 'error');
        }
      }

      function handleSignUp(e) {
        e.preventDefault();

        try {
          const nameInput = document.getElementById('signUpName');
          const emailInput = document.getElementById('signUpEmail');
          const passwordInput = document.getElementById('signUpPassword');
          const confirmPasswordInput = document.getElementById('signUpConfirmPassword');

          if (!nameInput || !emailInput || !passwordInput || !confirmPasswordInput) {
            showAlert('Sign up form elements not found. Please refresh the page.', 'error');
            return;
          }

          const name = nameInput.value.trim();
          const email = emailInput.value.trim();
          const password = passwordInput.value;
          const confirmPassword = confirmPasswordInput.value;

          if (!name || !email || !password || !confirmPassword) {
            showAlert('Please fill in all fields.', 'error');
            return;
          }

          if (password !== confirmPassword) {
            showAlert('Passwords do not match. Please try again.', 'error');
            return;
          }

          // Get existing users
          const users = JSON.parse(localStorage.getItem('visualVibeUsers') || '[]');

          // Check if email already exists
          if (users.find(u => u.email === email)) {
            showAlert('An account with this email already exists. Please sign in.', 'error');
            return;
          }

          // Create new user
          const newUser = {
            id: Date.now().toString(),
            name: name,
            email: email,
            password: password,
            orders: [],
            createdAt: new Date().toISOString()
          };

          users.push(newUser);
          localStorage.setItem('visualVibeUsers', JSON.stringify(users));

          // Sign in the new user
          currentUser = { id: newUser.id, name: newUser.name, email: newUser.email };
          localStorage.setItem('visualVibeUser', JSON.stringify(currentUser));
          updateAuthUI();
          closeSignUpModal();
          showAlert('Account created successfully! Welcome, ' + name + '!', 'success');
        } catch (error) {
          console.error('Error in handleSignUp:', error);
          showAlert('Sign up error. Please try again.', 'error');
        }
      }

      function signOut() {
        currentUser = null;
        localStorage.removeItem('visualVibeUser');
        updateAuthUI();
        showAlert('You have been signed out successfully.', 'success');
      }

      // Modal Functions (defined at script start, keeping these assignments for consistency)

      // Test function to verify modals work
      window.testModals = function() {
        console.log('Testing modals...');
        try {
          openSignInModal();
          console.log('‚úÖ Sign in modal test passed');
          setTimeout(() => {
            closeSignInModal();
            openSignUpModal();
            console.log('‚úÖ Sign up modal test passed');
            setTimeout(() => {
              closeSignUpModal();
              console.log('‚úÖ All modal tests completed');
            }, 2000);
          }, 2000);
        } catch (error) {
          console.error('‚ùå Modal test failed:', error);
        }
      };

      // Quick verification on page load
      window.addEventListener('load', function() {
        setTimeout(() => {
          console.log('üîç Verifying modal functions are available...');
          console.log('openSignInModal:', typeof window.openSignInModal === 'function');
          console.log('openSignUpModal:', typeof window.openSignUpModal === 'function');

          console.log('üîç Verifying chat functions are available...');
          console.log('safeToggleChat:', typeof window.safeToggleChat === 'function');
          console.log('sendMessage:', typeof window.sendMessage === 'function');
          console.log('handleChatKeyPress:', typeof window.handleChatKeyPress === 'function');

          console.log('üîç Verifying rating functions are available...');
          console.log('setRating:', typeof window.setRating === 'function');
          console.log('highlightStars:', typeof window.highlightStars === 'function');
          console.log('submitReview:', typeof window.submitReview === 'function');
          console.log('toggleAllReviews:', typeof window.toggleAllReviews === 'function');

          console.log('üîç Verifying order form functions are available...');
          console.log('updateButtonState:', typeof window.updateButtonState === 'function');
          console.log('validateAndSubmit:', typeof window.validateAndSubmit === 'function');

          if (typeof window.openSignInModal === 'function' && typeof window.openSignUpModal === 'function') {
            console.log('‚úÖ Modal functions are properly defined');
          } else {
            console.error('‚ùå Modal functions not properly defined');
          }

          if (typeof window.safeToggleChat === 'function' && typeof window.sendMessage === 'function') {
            console.log('‚úÖ Chat functions are properly defined');
          } else {
            console.error('‚ùå Chat functions not properly defined');
          }

          if (typeof window.setRating === 'function' && typeof window.submitReview === 'function' && typeof window.toggleAllReviews === 'function') {
            console.log('‚úÖ Rating and review functions are properly defined');
          } else {
            console.error('‚ùå Rating and review functions not properly defined');
          }

          if (typeof window.updateButtonState === 'function' && typeof window.validateAndSubmit === 'function') {
            console.log('‚úÖ Order form functions are properly defined');
          } else {
            console.error('‚ùå Order form functions not properly defined');
          }
        }, 500);
      });

      // Order History Functions
      function showOrderHistory() {
        const modal = document.getElementById('orderHistoryModal');
        const content = document.getElementById('orderHistoryContent');

        modal.classList.remove('hidden');

        if (!currentUser) {
          content.innerHTML = `
            <div class="text-center py-8">
              <p class="text-gray-500">Please sign in to view your orders.</p>
              <button onclick="closeOrderHistory(); openSignInModal();" class="mt-4 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700">
                Sign In
              </button>
            </div>
          `;
          return;
        }

        // Get user's orders
        const users = JSON.parse(localStorage.getItem('visualVibeUsers') || '[]');
        const user = users.find(u => u.id === currentUser.id);
        const orders = user ? user.orders || [] : [];

        if (orders.length === 0) {
          content.innerHTML = `
            <div class="text-center py-8">
              <div class="text-gray-400 text-6xl mb-4">üìã</div>
              <h4 class="text-xl font-semibold text-gray-600 mb-2">No Orders Yet</h4>
              <p class="text-gray-500 mb-4">You haven't placed any orders yet. Start by browsing our services!</p>
              <button onclick="closeOrderHistory(); document.getElementById('order').scrollIntoView();" class="bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700">
                Place Your First Order
              </button>
            </div>
          `;
        } else {
          const orderHTML = orders.map(order => `
            <div class="border rounded-lg p-6 bg-gray-50">
              <div class="flex justify-between items-start mb-4">
                <div>
                  <h4 class="text-lg font-semibold text-gray-800">Order #${order.orderNumber}</h4>
                  <p class="text-sm text-gray-500">${new Date(order.date).toLocaleDateString('en-US', {
                    year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
                  })}</p>
                </div>
                <span class="px-3 py-1 rounded-full text-sm font-medium ${
                  order.status === 'completed' ? 'bg-green-100 text-green-800' :
                  order.status === 'in-progress' ? 'bg-blue-100 text-blue-800' :
                  'bg-yellow-100 text-yellow-800'
                }">
                  ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                </span>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                  <p class="text-sm font-medium text-gray-600">Business Name:</p>
                  <p class="text-gray-800">${order.businessName}</p>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Industry:</p>
                  <p class="text-gray-800">${order.industry}</p>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Services:</p>
                  <p class="text-gray-800">${order.services.join(', ')}</p>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-600">Due Date:</p>
                  <p class="text-gray-800">${new Date(order.dueDate).toLocaleDateString()}</p>
                </div>
              </div>

              <div class="flex justify-between items-center pt-4 border-t">
                <div>
                  <p class="text-sm text-gray-600">Total: <span class="font-semibold text-lg text-gray-800">$${order.total}</span></p>
                  <p class="text-xs text-gray-500">Deposit Paid: $${order.deposit}</p>
                </div>
                <button onclick="downloadReceipt('${order.orderNumber}')" class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg hover:bg-indigo-200 text-sm font-medium">
                  üìÑ Download Receipt
                </button>
              </div>
            </div>
          `).join('');

          content.innerHTML = `
            <div class="mb-6">
              <p class="text-gray-600">You have ${orders.length} order${orders.length !== 1 ? 's' : ''} on record.</p>
            </div>
            ${orderHTML}
          `;
        }
      }

      function closeOrderHistory() {
        document.getElementById('orderHistoryModal').classList.add('hidden');
      }

      function downloadReceipt(orderNumber) {
        // Get the specific order
        const users = JSON.parse(localStorage.getItem('visualVibeUsers') || '[]');
        const user = users.find(u => u.id === currentUser.id);
        const order = user.orders.find(o => o.orderNumber === orderNumber);

        if (!order) {
          showAlert('Receipt not found.', 'error');
          return;
        }

        // Create receipt content
        const receiptContent = `
VISUAL VIBE STUDIO - RECEIPT
${'='.repeat(40)}

Order Number: ${order.orderNumber}
Date: ${new Date(order.date).toLocaleDateString('en-US', {
  year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
})}
Status: ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}

CUSTOMER INFORMATION:
${'-'.repeat(20)}
Business Name: ${order.businessName}
Industry: ${order.industry}
Email: ${order.email}
Phone: ${order.phone || 'N/A'}
Due Date: ${new Date(order.dueDate).toLocaleDateString()}

SERVICES ORDERED:
${'-'.repeat(16)}
${order.services.join('\n')}

PAYMENT SUMMARY:
${'-'.repeat(15)}
Total Project Cost: $${order.total}
Deposit Paid (50%): $${order.deposit}
Remaining Balance: $${(parseFloat(order.total) - parseFloat(order.deposit)).toFixed(2)}

CONTACT INFORMATION:
${'-'.repeat(20)}
Email: support@visualvibestudio.store
Phone: (402) 979-7184
Website: www.visualvibestudio.store

Thank you for choosing Visual Vibe Studio!
${'='.repeat(40)}
        `;

        // Create and download the receipt
        const blob = new Blob([receiptContent], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `VisualVibeStudio_Receipt_${orderNumber}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);

        showAlert('Receipt downloaded successfully!', 'success');
      }

      // Save order to user's account
      function saveOrderToAccount(orderData, pricing) {
        if (!currentUser) {
          return; // Guest orders are not saved
        }

        const users = JSON.parse(localStorage.getItem('visualVibeUsers') || '[]');
        const userIndex = users.findIndex(u => u.id === currentUser.id);

        if (userIndex === -1) {
          return;
        }

        const order = {
          orderNumber: 'VVS-' + Date.now().toString().slice(-6),
          date: new Date().toISOString(),
          status: 'pending',
          businessName: orderData.businessName,
          industry: orderData.industry,
          services: orderData.services,
          email: orderData.email,
          phone: orderData.phone,
          dueDate: orderData.dueDate,
          total: pricing.total,
          deposit: pricing.deposit
        };

        users[userIndex].orders = users[userIndex].orders || [];
        users[userIndex].orders.unshift(order); // Add to beginning of array

        localStorage.setItem('visualVibeUsers', JSON.stringify(users));

        return order.orderNumber;
      }

      function resetForm() {
        const submitBtn = document.querySelector('button[type="submit"]');
        const venmoContainer = document.getElementById(
          "paypal-button-container",
        );

        submitBtn.style.display = "block";
        venmoContainer.classList.add("hidden");
        venmoContainer.innerHTML = "";
        venmoPaymentShown = false;
      }

      function calculateOrderTotal() {
        try {
          const servicesSelect = document.querySelector(
            'select[name="services"]',
          );
          if (!servicesSelect) {
            throw new Error("Services select element not found");
          }

          const selectedServices = Array.from(servicesSelect.selectedOptions);

          if (selectedServices.length === 0) {
            return { total: "0.00", deposit: "0.00" };
          }

          // Calculate total based on individual service prices
          let basePrice = 0;
          selectedServices.forEach((option) => {
            const priceStr = option.getAttribute("data-price");
            const price = parseInt(priceStr) || 0;
            basePrice += price;
          });

          const depositAmount = (basePrice * 0.5).toFixed(2); // 50% deposit

          return {
            total: basePrice.toFixed(2),
            deposit: depositAmount,
          };
        } catch (error) {
          console.error("Error calculating order total:", error);
          return { total: "0.00", deposit: "0.00" };
        }
      }

      function generateVenmoLink(amount, note) {
        try {
          const venmoHandle = "Yoshiko-Swafford";

          // Validate inputs
          if (!amount || isNaN(parseFloat(amount)) || parseFloat(amount) <= 0) {
            console.error('Invalid amount for Venmo link:', amount);
            return null;
          }

          if (!note || typeof note !== 'string') {
            note = 'Visual Vibe Studio Payment';
          }

          // Venmo deep link format
          const venmoLink = `venmo://paycharge?txn=pay&recipients=${encodeURIComponent(venmoHandle)}&amount=${encodeURIComponent(amount)}&note=${encodeURIComponent(note)}`;

          console.log('Generated Venmo link:', venmoLink);
          return venmoLink;
        } catch (error) {
          console.error('Error generating Venmo link:', error);
          return null;
        }
      }

      function showVenmoPayment(pricing, orderData, orderNumber = null) {
        try {
          // Validate inputs
          if (!pricing || !orderData) {
            throw new Error('Missing pricing or order data');
          }

          if (!pricing.deposit || isNaN(parseFloat(pricing.deposit)) || parseFloat(pricing.deposit) <= 0) {
            throw new Error('Invalid deposit amount: ' + pricing.deposit);
          }

          if (!orderData.businessName || !orderData.services || !Array.isArray(orderData.services)) {
            throw new Error('Invalid order data structure');
          }

          const venmoContainer = document.getElementById(
            "paypal-button-container",
          );

          if (!venmoContainer) {
            throw new Error('Venmo payment container not found');
          }

          // Make container visible
          venmoContainer.classList.remove('hidden');
          venmoContainer.style.display = 'block';

          // Sanitize business name and services for note
          const businessName = orderData.businessName || 'Customer';
          const services = orderData.services.length > 0 ? orderData.services.join(", ") : 'Services';
          const venmoNote = `Visual Vibe Studio - 50% Deposit for ${businessName} (${services})`;
          const venmoLink = generateVenmoLink(pricing.deposit, venmoNote);

          if (!venmoLink) {
            throw new Error('Failed to generate Venmo payment link');
          }

        venmoContainer.innerHTML = `
                <div class="bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-blue-200 rounded-xl p-6">
                  <div class="text-center mb-6">
                    <div class="bg-blue-600 text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-3">
                      <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M13.454 9.046c-.633-.633-1.662-.633-2.294 0l-5.656 5.656c-.633.633-.633 1.662 0 2.294.633.633 1.662.633 2.294 0l5.656-5.656c.633-.633.633-1.662 0-2.294z"/>
                        <path d="M15.748 6.752c-.633-.633-1.662-.633-2.294 0l-5.656 5.656c-.633.633-.633 1.662 0 2.294.633.633 1.662.633 2.294 0l5.656-5.656c.633-.633.633-1.662 0-2.294z"/>
                      </svg>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800 mb-2">Pay with Venmo</h4>
                  </div>

                  <div class="bg-white rounded-lg p-4 mb-6 border border-gray-200">
                    <h5 class="font-semibold text-gray-800 mb-3">Order Summary</h5>
                    <div class="space-y-2 text-sm">
                      <div class="flex justify-between">
                        <span class="text-gray-600">Business:</span>
                        <span class="font-medium">${orderData.businessName}</span>
                      </div>
                      <div class="flex justify-between">
                        <span class="text-gray-600">Services:</span>
                        <span class="font-medium">${orderData.services.join(", ")}</span>
                      </div>
                      <div class="flex justify-between">
                        <span class="text-gray-600">Total Project Cost:</span>
                        <span class="font-medium">$${pricing.total}</span>
                      </div>
                      <div class="flex justify-between border-t pt-2 mt-2">
                        <span class="font-semibold text-gray-800">Deposit Required (50%):</span>
                        <span class="font-bold text-lg text-blue-600">$${pricing.deposit}</span>
                      </div>
                    </div>
                  </div>

                  ${currentUser && orderNumber ? `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                      <div class="flex items-center mb-2">
                        <svg class="w-5 h-5 text-green-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="font-semibold text-green-800">Order Saved to Your Account</span>
                      </div>
                      <p class="text-sm text-green-700">Order #${orderNumber}</p>
                      <p class="text-xs text-green-600 mt-1">You can track this order in "My Orders" after payment.</p>
                    </div>
                  ` : currentUser ? `
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                      <div class="flex items-center mb-2">
                        <svg class="w-5 h-5 text-blue-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                        </svg>
                        <span class="font-semibold text-blue-800">Signed In</span>
                      </div>
                      <p class="text-sm text-blue-700">This order will be saved to your account for tracking.</p>
                    </div>
                  ` : `
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                      <div class="flex items-center mb-2">
                        <svg class="w-5 h-5 text-yellow-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                        <span class="font-semibold text-yellow-800">Guest Order</span>
                      </div>
                      <p class="text-sm text-yellow-700">Sign in to save and track your orders.</p>
                      <button onclick="openSignInModal()" class="mt-2 text-sm text-yellow-600 underline hover:text-yellow-800">Sign In Now</button>
                    </div>
                  `}

                  <div class="text-center space-y-4">
                    <p class="text-gray-700 font-medium">Send payment to:</p>
                    <div class="bg-blue-100 rounded-lg p-3 inline-block">
                      <span class="text-2xl font-bold text-blue-800">@Yoshiko-Swafford</span>
                    </div>

                    <div class="space-y-3">
                      <button type="button" onclick="openVenmoAppFromOrder()" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                        üèß Open Venmo App
                      </button>

                      <button type="button" onclick="copyVenmoDetails()" class="w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-200 transition-colors">
                        üìã Copy Payment Details
                      </button>
                    </div>

                    <div class="text-sm text-gray-600 bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-4">
                      <p class="font-semibold text-yellow-800 mb-1">üì± Payment Instructions:</p>
                      <ol class="text-left space-y-1">
                        <li>1. Click "Open Venmo App" or search @Yoshiko-Swafford</li>
                        <li>2. Send exactly <strong>$${pricing.deposit}</strong></li>
                        <li>3. Include note: "${orderData.businessName} - Visual Vibe Studio"</li>
                        <li>4. We'll confirm your order within 24 hours</li>
                      </ol>
                    </div>

                    <div class="flex space-x-3 mt-6">
                      <button type="button" onclick="markPaymentSent()" class="flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-700 transition-colors">
                        ‚úÖ Payment Sent
                      </button>
                      <button type="button" onclick="resetForm()" class="flex-1 bg-gray-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-gray-600 transition-colors">
                        ‚Üê Back to Form
                      </button>
                    </div>
                  </div>
                </div>
              `;

          venmoContainer.classList.remove("hidden");
          venmoPaymentShown = true;
          console.log('‚úÖ Venmo payment displayed successfully');

          // Scroll to payment section
          setTimeout(() => {
            venmoContainer.scrollIntoView({
              behavior: 'smooth',
              block: 'center'
            });
          }, 300);
        } catch (error) {
          console.error('Error showing Venmo payment:', error);
          showAlert('Unable to display payment options. Please contact us directly at (402) 979-7184 or support@visualvibestudio.store', 'error');

          // Show fallback payment instructions
          const venmoContainer = document.getElementById("paypal-button-container");
          if (venmoContainer) {
            venmoContainer.innerHTML = `
              <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6">
                <div class="text-center mb-6">
                  <div class="text-red-600 text-4xl mb-4">‚ö†Ô∏è</div>
                  <h4 class="text-xl font-bold text-red-800 mb-2">Payment System Issue</h4>
                  <p class="text-red-700 mb-4">There was an error displaying the payment options. Please contact us directly to complete your order.</p>
                </div>

                <div class="bg-white rounded-lg p-4 mb-6 border border-red-200">
                  <h5 class="font-semibold text-gray-800 mb-3">Contact Information</h5>
                  <div class="space-y-2 text-sm">
                    <p><strong>Phone:</strong> <a href="tel:+14029797184" class="text-blue-600">(402) 979-7184</a></p>
                    <p><strong>Email:</strong> <a href="mailto:support@visualvibestudio.store" class="text-blue-600">support@visualvibestudio.store</a></p>
                    <p><strong>Venmo:</strong> @Yoshiko-Swafford</p>
                  </div>
                </div>

                <div class="text-center">
                  <button type="button" onclick="resetForm()" class="bg-gray-500 text-white py-3 px-6 rounded-lg font-semibold hover:bg-gray-600 transition-colors">
                    ‚Üê Back to Form
                  </button>
                </div>
              </div>
            `;
            venmoContainer.classList.remove("hidden");
          }
        }
      }

      function copyVenmoDetails() {
        try {
          const pricing = calculateOrderTotal();
          if (!pricing || !pricing.deposit || isNaN(parseFloat(pricing.deposit))) {
            throw new Error('Unable to calculate deposit amount');
          }

          const form = document.getElementById("orderForm");
          if (!form) {
            throw new Error("Order form not found");
          }

          const formData = new FormData(form);
          const businessName = formData.get("businessName") || "Customer";

          const details = `Venmo: @Yoshiko-Swafford\nAmount: $${pricing.deposit}\nNote: ${businessName} - Visual Vibe Studio`;

          // Check if clipboard API is supported
          if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard
              .writeText(details)
              .then(() => {
                showAlert("Payment details copied to clipboard!", "success");
              })
              .catch(() => {
                showAlert("Payment Details:\n\n" + details, "info");
              });
          } else {
            // Fallback for older browsers
            showAlert("Payment Details:\n\n" + details, "info");
          }
        } catch (error) {
          console.error("Error copying Venmo details:", error);
          showAlert(
            "Unable to copy details. Please note: @Yoshiko-Swafford",
            "error",
          );
        }
      }

      function showAlert(message, type = "info") {
        // Create a better alert system than browser alert
        const alertDiv = document.createElement("div");
        alertDiv.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm ${type === "success" ? "bg-green-100 text-green-800 border border-green-200" : type === "error" ? "bg-red-100 text-red-800 border border-red-200" : "bg-blue-100 text-blue-800 border border-blue-200"}`;
        alertDiv.innerHTML = `
                <div class="flex justify-between items-start">
                  <p class="text-sm whitespace-pre-line">${message}</p>
                  <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-lg leading-none">&times;</button>
                </div>
              `;
        document.body.appendChild(alertDiv);

        // Auto remove after 5 seconds
        setTimeout(() => {
          if (alertDiv.parentElement) {
            alertDiv.remove();
          }
        }, 5000);
      }

      function markPaymentSent() {
        const venmoContainer = document.getElementById(
          "paypal-button-container",
        );

        // Show processing message
        venmoContainer.innerHTML = `
                <div class="bg-blue-50 border-2 border-blue-200 rounded-xl p-8 text-center">
                  <div class="text-blue-600 text-4xl mb-4">‚è≥</div>
                  <h4 class="text-2xl font-bold text-blue-800 mb-3">Processing Order...</h4>
                  <p class="text-blue-700 mb-4">Sending your receipt and order confirmation...</p>
                </div>
              `;

        // Send receipt and confirmation emails
        sendOrderReceipt()
          .then(() => {
            venmoContainer.innerHTML = `
                  <div class="bg-green-50 border-2 border-green-200 rounded-xl p-8 text-center">
                    <div class="text-green-600 text-6xl mb-4">‚úÖ</div>
                    <h4 class="text-2xl font-bold text-green-800 mb-3">Order Confirmed!</h4>
                    <p class="text-green-700 mb-4">Thank you for your order! Your receipt has been sent to your email.</p>
                    <div class="bg-white rounded-lg p-4 mb-4 border border-green-200">
                      <p class="text-sm text-green-600 mb-2"><strong>What happens next:</strong></p>
                      <ul class="text-sm text-green-700 text-left space-y-1">
                        <li>üìß Receipt sent to your email address</li>
                        <li>üí∞ We'll confirm your Venmo payment within 24 hours</li>
                        <li>üìû We'll contact you to discuss project details</li>
                        <li>üé® Project work begins once payment is confirmed</li>
                      </ul>
                    </div>
                    <div class="text-sm text-green-600 mb-4">
                      <p><strong>Questions?</strong> Contact us:</p>
                      <p>üìß support@visualvibestudio.store</p>
                      <p>üìû (402) 979-7184</p>
                    </div>
                    <button type="button" onclick="location.reload()" class="bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors">
                      Place Another Order
                    </button>
                  </div>
                `;
          })
          .catch(() => {
            venmoContainer.innerHTML = `
                  <div class="bg-yellow-50 border-2 border-yellow-200 rounded-xl p-8 text-center">
                    <div class="text-yellow-600 text-4xl mb-4">üéâ</div>
                    <h4 class="text-2xl font-bold text-yellow-800 mb-3">Order Submitted!</h4>
                    <p class="text-yellow-700 mb-4">We've received your order. Receipt will be sent manually within 24 hours.</p>
                    <div class="bg-white rounded-lg p-4 mb-4 border border-yellow-200">
                      <p class="text-sm text-yellow-600 mb-2"><strong>Next Steps:</strong></p>
                      <ul class="text-sm text-yellow-700 text-left space-y-1">
                        <li>üìß Manual receipt will be sent within 24 hours</li>
                        <li>üí∞ We'll confirm your Venmo payment</li>
                        <li>üìû We'll contact you to discuss your project</li>
                        <li>üé® Project work begins once payment is confirmed</li>
                      </ul>
                    </div>
                    <button type="button" onclick="location.reload()" class="bg-yellow-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-yellow-700 transition-colors">
                      Place Another Order
                    </button>
                  </div>
                `;
          });
      }

      function sendOrderReceipt() {
        return new Promise((resolve, reject) => {
          try {
            const form = document.getElementById("orderForm");
            if (!form) {
              throw new Error("Order form not found");
            }

            const formData = new FormData(form);
            const pricing = calculateOrderTotal();

            const servicesSelect = form.querySelector(
              'select[name="services"]',
            );
            if (!servicesSelect) {
              throw new Error("Services select not found");
            }

            const selectedServices = Array.from(servicesSelect.selectedOptions);

            // Generate order number
            const orderNumber = "VVS-" + Date.now().toString().slice(-6);
            const orderDate = new Date().toLocaleDateString("en-US", {
              year: "numeric",
              month: "long",
              day: "numeric",
              hour: "2-digit",
              minute: "2-digit",
            });

            // Prepare customer receipt data
            const customerReceiptData = {
              to_email: formData.get("email"),
              to_name: formData.get("businessName"),
              order_number: orderNumber,
              order_date: orderDate,
              business_name: formData.get("businessName"),
              industry: formData.get("industry"),
              services: selectedServices
                .map((option) => option.text)
                .join(", "),
              total_amount: pricing.total,
              deposit_amount: pricing.deposit,
              remaining_amount: (
                parseFloat(pricing.total) - parseFloat(pricing.deposit)
              ).toFixed(2),
              due_date: formData.get("dueDate"),
              phone: formData.get("phone"),
              venmo_handle: "@Yoshiko-Swafford",
            };

            // Prepare business notification data
            const businessNotificationData = {
              to_email: "support@visualvibestudio.store",
              order_number: orderNumber,
              order_date: orderDate,
              customer_name: formData.get("businessName"),
              customer_email: formData.get("email"),
              customer_phone: formData.get("phone"),
              industry: formData.get("industry"),
              services: selectedServices
                .map((option) => option.text)
                .join(", "),
              total_amount: pricing.total,
              deposit_amount: pricing.deposit,
              due_date: formData.get("dueDate"),
            };

            // Send customer receipt
            const customerTemplate = {
              service_id: "YOUR_EMAILJS_SERVICE_ID", // Replace with your EmailJS service ID
              template_id: "customer_receipt_template", // Replace with your customer receipt template ID
              user_id: "YOUR_EMAILJS_USER_ID",
              template_params: customerReceiptData,
            };

            // Send business notification
            const businessTemplate = {
              service_id: "YOUR_EMAILJS_SERVICE_ID",
              template_id: "business_notification_template", // Replace with your business notification template ID
              user_id: "YOUR_EMAILJS_USER_ID",
              template_params: businessNotificationData,
            };

            // For now, use mailto as fallback since EmailJS requires setup
            // You can uncomment and configure EmailJS later

            /*
                Promise.all([
                  emailjs.send(customerTemplate.service_id, customerTemplate.template_id, customerTemplate.template_params),
                  emailjs.send(businessTemplate.service_id, businessTemplate.template_id, businessTemplate.template_params)
                ]).then(() => {
                  resolve();
                }).catch((error) => {
                  console.error('EmailJS error:', error);
                  reject(error);
                });
                */

            // Fallback: Generate mailto links for receipts
            const customerReceiptSubject = encodeURIComponent(
              `Order Receipt #${orderNumber} - Visual Vibe Studio`,
            );
            const customerReceiptBody =
              encodeURIComponent(`Dear ${formData.get("businessName")},

      Thank you for your order! Here's your receipt:

      ORDER DETAILS:
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅÔøΩÔøΩ‚îÅ‚îÅ
      Order Number: ${orderNumber}
      Order Date: ${orderDate}
      Business Name: ${formData.get("businessName")}
      Industry: ${formData.get("industry")}
      Services: ${selectedServices.map((option) => option.text).join(", ")}
      Due Date: ${formData.get("dueDate")}

      PAYMENT SUMMARY:
      üí∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      Total Project Cost: $${pricing.total}
      Deposit Paid (50%): $${pricing.deposit}
      Remaining Balance: $${(parseFloat(pricing.total) - parseFloat(pricing.deposit)).toFixed(2)}
      Payment Method: Venmo (@Yoshiko-Swafford)

      NEXT STEPS:
      ‚û°Ô∏è‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅÔøΩÔøΩÔøΩ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      ‚Ä¢ We'll confirm your Venmo payment within 24 hours
      üìã Project discussion and planning will begin
      ‚Ä¢ Final 50% payment due upon project completion
      ‚Ä¢ Estimated completion: ${formData.get("dueDate")}

      CONTACT INFORMATION:
      üìû‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      Email: support@visualvibestudio.store
      Phone: (402) 979-7184
      Website: www.visualvibestudio.store

      Thank you for choosing Visual Vibe Studio!

      Best regards,
      Yoshiko Swafford
      Visual Vibe Studio`);

            const businessNotificationSubject = encodeURIComponent(
              `New Order #${orderNumber} - ${formData.get("businessName")}`,
            );
            const businessNotificationBody =
              encodeURIComponent(`New order received!

      Order #${orderNumber}
      Date: ${orderDate}

      Customer: ${formData.get("businessName")}
      Email: ${formData.get("email")}
      Phone: ${formData.get("phone")}
      Industry: ${formData.get("industry")}

      Services: ${selectedServices.map((option) => option.text).join(", ")}
      Total: $${pricing.total}
      Deposit: $${pricing.deposit}
      Due Date: ${formData.get("dueDate")}

      Please confirm Venmo payment and begin project planning.`);

            // Open customer receipt email
            const customerMailto = `mailto:${formData.get("email")}?subject=${customerReceiptSubject}&body=${customerReceiptBody}`;

            // Check if email can be opened
            try {
              window.open(customerMailto, "_blank");
            } catch (emailError) {
              console.warn("Could not open customer email client:", emailError);
            }

            // Open business notification email
            setTimeout(() => {
              try {
                const businessMailto = `mailto:support@visualvibestudio.store?subject=${businessNotificationSubject}&body=${businessNotificationBody}`;
                window.open(businessMailto, "_blank");
                resolve();
              } catch (emailError) {
                console.warn(
                  "Could not open business email client:",
                  emailError,
                );
                resolve(); // Still resolve to show success
              }
            }, 1000);
          } catch (error) {
            console.error("Error in sendOrderReceipt:", error);
            reject(error);
          }
        });
      }

      // Live Chat Functionality
      // chatOpen already initialized at top of script
      var hasUnreadMessages = false;

      // Chat toggle function (defined at script start to fix ReferenceError)
      const agentResponses = [
        "Thanks for reaching out! I'm here to help with your design needs. What type of project are you interested in?",
        "Great question! Our business websites start at $100 and the final price depends on features like e-commerce, multiple pages, and custom functionality. Would you like me to explain more about what's included?",
        "Absolutely! We specialize in professional business cards, flyers, brochures, logos, and websites. Each service is designed to help your business stand out. Which service interests you most?",
        "Our typical turnaround time is 5-10 business days, but we can discuss rush orders if needed. What's your preferred timeline?",
        "Yes, we do revisions! Each project includes up to 3 rounds of revisions to ensure you're completely satisfied with the final design.",
        "We accept payment through Venmo (@Yoshiko-Swafford). We require a 50% deposit to start, and the remaining 50% is due when you approve the final design.",
        "Of course! We can work with your existing branding guidelines, colors, and logos to ensure consistency across all your materials.",
        "That sounds like a perfect project for us! Would you like to place an order through our website, or do you have specific questions about the process first?",
        "I'd be happy to provide a custom quote based on your specific needs. Can you tell me more about what you're looking for?",
        "You can reach our team at support@visualvibestudio.store or (402) 979-7184. We typically respond within 2-4 hours during business hours."
      ];

      function toggleChat() {
        try {
          const chatWindow = document.getElementById('chatWindow');
          const chatBubble = document.getElementById('chatBubble');
          const chatIcon = document.getElementById('chatIcon');
          const closeIcon = document.getElementById('closeIcon');
          const notification = document.getElementById('chatNotification');

          // Check if required elements exist
          if (!chatWindow || !chatBubble || !chatIcon || !closeIcon) {
            console.error('Chat elements not found:', {
              chatWindow: !!chatWindow,
              chatBubble: !!chatBubble,
              chatIcon: !!chatIcon,
              closeIcon: !!closeIcon
            });
            throw new Error('Required chat elements missing');
          }

          chatOpen = !chatOpen;

          if (chatOpen) {
            chatWindow.classList.add('open');
            chatBubble.classList.add('active');
            chatIcon.classList.add('hidden');
            closeIcon.classList.remove('hidden');

            if (notification) {
              notification.classList.add('hidden');
            }
            hasUnreadMessages = false;

            // Focus on input when opening with better error handling
            setTimeout(() => {
              try {
                const chatInput = document.getElementById('chatInput');
                if (chatInput) {
                  chatInput.focus();
                } else {
                  console.warn('Chat input not found for focus');
                }
              } catch (focusError) {
                console.warn('Could not focus chat input:', focusError);
              }
            }, 300);

            // Show welcome message with notification after 2 seconds if no interaction
            setTimeout(() => {
              try {
                if (chatOpen && !hasUserSentMessage()) {
                  addAgentMessage("Need help getting started? Feel free to ask about our services, pricing, or turnaround times! üòä");
                }
              } catch (welcomeError) {
                console.warn('Could not show welcome message:', welcomeError);
              }
            }, 2000);
          } else {
            chatWindow.classList.remove('open');
            chatBubble.classList.remove('active');
            chatIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
          }

          console.log('Chat toggled successfully. Open:', chatOpen);
        } catch (error) {
          console.error('Error in toggleChat:', error);
          showAlert('Chat system error. Please try refreshing the page or contact us directly at (402) 979-7184', 'error');

          // Enhanced fallback
          const chatWindow = document.getElementById('chatWindow');
          if (chatWindow) {
            const currentDisplay = window.getComputedStyle(chatWindow).display;
            if (currentDisplay === 'none' || !chatWindow.classList.contains('open')) {
              chatWindow.style.display = 'flex';
              chatWindow.classList.add('open');
              chatOpen = true;
            } else {
              chatWindow.style.display = 'none';
              chatWindow.classList.remove('open');
              chatOpen = false;
            }
          }
        }
      }

      function hasUserSentMessage() {
        const messages = document.querySelectorAll('.chat-message.user');
        return messages.length > 0;
      }

      // sendMessage function (defined at script start to fix ReferenceError)

      function addUserMessage(message) {
        try {
          const messagesContainer = document.getElementById('chatMessages');
          if (!messagesContainer) {
            console.error('Chat messages container not found');
            return;
          }

          const messageElement = document.createElement('div');
          messageElement.className = 'chat-message user';
          const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
          messageElement.innerHTML = `
            <div>
              <div>${escapeHtml(message)}</div>
              <div class="text-xs opacity-70 mt-1">Sent ${timestamp}</div>
            </div>
          `;
          messagesContainer.appendChild(messageElement);
          scrollToBottom();

          // Save message to session storage for potential recovery
          try {
            saveChatMessage('user', message, timestamp);
          } catch (saveError) {
            console.warn('Could not save chat message:', saveError);
          }
        } catch (error) {
          console.error('Error adding user message:', error);
        }
      }

      function addAgentMessage(message) {
        try {
          const messagesContainer = document.getElementById('chatMessages');
          if (!messagesContainer) {
            console.error('Chat messages container not found');
            return;
          }

          const messageElement = document.createElement('div');
          messageElement.className = 'chat-message agent';
          messageElement.innerHTML = `<div>${message}</div>`;
          messagesContainer.appendChild(messageElement);
          scrollToBottom();

          // Show notification if chat is closed
          if (!chatOpen) {
            try {
              showChatNotification();
            } catch (notificationError) {
              console.warn('Could not show chat notification:', notificationError);
            }
          }
        } catch (error) {
          console.error('Error adding agent message:', error);
        }
      }

      function showSendingIndicator() {
        const messagesContainer = document.getElementById('chatMessages');
        const typingElement = document.createElement('div');
        typingElement.className = 'chat-typing';
        typingElement.id = 'typingIndicator';
        typingElement.innerHTML = `
          <div class="flex items-center space-x-2">
            <div class="typing-dots">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
            <span class="text-sm">Sending to Yoshiko...</span>
          </div>
        `;
        messagesContainer.appendChild(typingElement);
        scrollToBottom();
      }

      function removeSendingIndicator() {
        const typingIndicator = document.getElementById('typingIndicator');
        if (typingIndicator) {
          typingIndicator.remove();
        }
      }

      function showTypingIndicator() {
        const messagesContainer = document.getElementById('chatMessages');
        const typingElement = document.createElement('div');
        typingElement.className = 'chat-typing';
        typingElement.id = 'typingIndicator';
        typingElement.innerHTML = `
          <div class="typing-dots">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
        `;
        messagesContainer.appendChild(typingElement);
        scrollToBottom();
      }

      async function sendMessageToBusinessOwner(message) {
        const customerInfo = getCurrentUser() || { name: 'Website Visitor', email: 'Not provided' };
        const timestamp = new Date().toLocaleString();

        // Get customer's contact info if available
        let customerContact = '';
        if (currentUser) {
          customerContact = `${currentUser.name} (${currentUser.email})`;
        } else {
          customerContact = 'Website Visitor (not signed in)';
        }

        // Prepare data for Zapier webhook
        const webhookData = {
          message: message,
          customer: customerContact,
          timestamp: timestamp,
          page: window.location.pathname,
          phone: '402-979-7184',
          source: 'Visual Vibe Studio Chat'
        };

        try {
          // Zapier Webhook - Configured and Active
          const ZAPIER_WEBHOOK_URL = 'https://hooks.zapier.com/hooks/catch/24056566/u4i7xid/';

          // Webhook is now properly configured
          console.log('üîó Sending to Zapier webhook:', ZAPIER_WEBHOOK_URL);
          console.log('üì§ Webhook data:', webhookData);

          // Send to Zapier webhook
          const response = await fetch(ZAPIER_WEBHOOK_URL, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(webhookData)
          });

          console.log('‚úÖ Message sent to Zapier webhook successfully');
          return Promise.resolve();
        } catch (error) {
          console.error('‚ùå Zapier webhook error:', error);
          console.log('üìß Falling back to email notification...');
          // Fallback to opening email client
          const fullMessage = `New chat message from ${customerContact}: ${message}`;
          await sendEmailNotification(fullMessage);
          return Promise.resolve(); // Don't fail the chat
        }
      }

      async function sendSMSViaEmailGateway(message) {
        // Using multiple email-to-SMS gateways for reliability
        const smsGateways = [
          '4029797184@vtext.com',    // Verizon
          '4029797184@txt.att.net',   // AT&T
          '4029797184@messaging.sprintpcs.com', // Sprint
          '4029797184@tmomail.net',   // T-Mobile
          '4029797184@mymetropcs.com' // Metro PCS
        ];

        const emailSubject = 'VVS Chat';

        // Try multiple gateways simultaneously for better delivery
        const promises = smsGateways.map(gateway =>
          sendEmailToGateway(gateway, emailSubject, message)
        );

        try {
          await Promise.any(promises);
          console.log('SMS sent successfully via email gateway');
        } catch (error) {
          console.log('All SMS gateways failed, using fallback');
          throw error;
        }
      }

      async function sendEmailToGateway(toEmail, subject, message) {
        // Format message for SMS (160 character limit consideration)
        const shortMessage = message.length > 140 ?
          message.substring(0, 137) + '...' : message;

        const emailBody = encodeURIComponent(shortMessage);
        const emailSubject = encodeURIComponent(subject);

        // Use modern fetch API to send via web service if available
        try {
          // Try web-based SMS service first
          const response = await fetch('https://api.web2sms.com/send', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              to: '4029797184',
              message: shortMessage,
              from: 'VisualVibe'
            })
          });

          if (response.ok) {
            return Promise.resolve();
          }
        } catch (error) {
          console.log('Web SMS service unavailable, trying email gateway...');
        }

        // Fallback to email-to-SMS gateway
        const mailtoLink = `mailto:${toEmail}?subject=${emailSubject}&body=${emailBody}`;

        // Create hidden form submission
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `mailto:${toEmail}`;
        form.style.display = 'none';

        const subjectInput = document.createElement('input');
        subjectInput.name = 'subject';
        subjectInput.value = subject;
        form.appendChild(subjectInput);

        const bodyInput = document.createElement('input');
        bodyInput.name = 'body';
        bodyInput.value = shortMessage;
        form.appendChild(bodyInput);

        document.body.appendChild(form);

        // Try to submit via mailto
        window.location.href = mailtoLink;

        // Clean up
        setTimeout(() => {
          if (document.body.contains(form)) {
            document.body.removeChild(form);
          }
        }, 2000);

        return new Promise((resolve) => {
          setTimeout(resolve, 1000);
        });
      }

      async function sendWebPushNotification(message, customerContact) {
        // Modern browser push notification (if user has granted permission)
        if ('Notification' in window && Notification.permission === 'granted') {
          new Notification('New Chat Message - Visual Vibe Studio', {
            body: `From ${customerContact}: "${message}"`,
            icon: 'https://cdn.builder.io/api/v1/image/assets%2F5015b2985ffe4a9ca5064ae99f72812a%2Fff0a451500144e83b9957a3f0ca320e8?format=webp&width=64',
            badge: 'https://cdn.builder.io/api/v1/image/assets%2F5015b2985ffe4a9ca5064ae99f72812a%2Fff0a451500144e83b9957a3f0ca320e8?format=webp&width=32',
            tag: 'vvs-chat',
            requireInteraction: true,
            vibrate: [200, 100, 200]
          });
        } else if ('Notification' in window && Notification.permission !== 'denied') {
          // Request permission for future notifications
          await Notification.requestPermission();
        }
      }

      async function sendEmailNotification(message) {
        // Send to both business email and create backup
        const emailSubject = encodeURIComponent('üö® VVS Chat Alert - Respond ASAP');
        const emailBody = encodeURIComponent(message);

        // Primary notification to business email
        const businessMailto = `mailto:support@visualvibestudio.store?subject=${emailSubject}&body=${emailBody}`;

        // Backup notification to personal email (if different)
        const personalMailto = `mailto:swaffordyoshiko@gmail.com?subject=${emailSubject}&body=${emailBody}`;

        // Try to send to both
        try {
          window.open(businessMailto, '_blank');
          setTimeout(() => {
            window.open(personalMailto, '_blank');
          }, 1000);
        } catch (error) {
          // Fallback: create downloadable message file
          downloadMessageFile(message);
        }
      }

      function downloadMessageFile(message) {
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const filename = `VVS-Chat-${timestamp}.txt`;
        const blob = new Blob([message], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }

      function saveChatMessage(sender, message, timestamp) {
        const chatSession = {
          id: Date.now().toString(),
          sender: sender,
          message: message,
          timestamp: timestamp,
          user: currentUser ? currentUser.name : 'Guest',
          userEmail: currentUser ? currentUser.email : null,
          page: window.location.pathname,
          sent: sender === 'user'
        };

        // Save to session storage
        const chatHistory = JSON.parse(sessionStorage.getItem('vvsChatHistory') || '[]');
        chatHistory.push(chatSession);
        sessionStorage.setItem('vvsChatHistory', JSON.stringify(chatHistory));

        // Also save to local storage for persistence
        const persistentChat = JSON.parse(localStorage.getItem('vvsPersistentChat') || '[]');
        persistentChat.push(chatSession);

        // Keep only last 50 messages to avoid storage bloat
        if (persistentChat.length > 50) {
          persistentChat.splice(0, persistentChat.length - 50);
        }
        localStorage.setItem('vvsPersistentChat', JSON.stringify(persistentChat));
      }

      function loadChatHistory() {
        const chatHistory = JSON.parse(sessionStorage.getItem('vvsChatHistory') || '[]');
        chatHistory.forEach(msg => {
          if (msg.sender === 'user') {
            addUserMessageFromHistory(msg.message, msg.timestamp);
          } else {
            addAgentMessageFromHistory(msg.message, msg.timestamp);
          }
        });
      }

      function addUserMessageFromHistory(message, timestamp) {
        const messagesContainer = document.getElementById('chatMessages');
        const messageElement = document.createElement('div');
        messageElement.className = 'chat-message user';
        messageElement.innerHTML = `
          <div>
            <div>${escapeHtml(message)}</div>
            <div class="text-xs opacity-70 mt-1">${timestamp}</div>
          </div>
        `;
        messagesContainer.appendChild(messageElement);
      }

      function addAgentMessageFromHistory(message, timestamp) {
        const messagesContainer = document.getElementById('chatMessages');
        const messageElement = document.createElement('div');
        messageElement.className = 'chat-message agent';
        messageElement.innerHTML = `
          <div>
            <div>${message}</div>
            <div class="text-xs opacity-70 mt-1">${timestamp}</div>
          </div>
        `;
        messagesContainer.appendChild(messageElement);
      }

      function getCurrentUser() {
        return currentUser;
      }

      // Enhanced SMS delivery with retry logic
      async function sendSMSWithRetry(message, maxRetries = 3) {
        for (let attempt = 1; attempt <= maxRetries; attempt++) {
          try {
            await sendSMSViaEmailGateway(message);
            console.log(`SMS sent successfully on attempt ${attempt}`);
            trackChatEvent('sms_sent', { attempt, message: message.substring(0, 50) });
            return true;
          } catch (error) {
            console.log(`SMS attempt ${attempt} failed:`, error);
            if (attempt === maxRetries) {
              trackChatEvent('sms_failed', { attempts: maxRetries, error: error.message });
              throw error;
            }
            // Wait before retry (exponential backoff)
            await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
          }
        }
        return false;
      }

      // Chat analytics and tracking
      function trackChatEvent(eventType, data = {}) {
        const event = {
          type: eventType,
          timestamp: new Date().toISOString(),
          user: currentUser ? currentUser.name : 'Guest',
          userEmail: currentUser ? currentUser.email : null,
          page: window.location.pathname,
          sessionId: getSessionId(),
          data: data
        };

        // Save to analytics storage
        const analytics = JSON.parse(localStorage.getItem('vvsChatAnalytics') || '[]');
        analytics.push(event);

        // Keep only last 100 events
        if (analytics.length > 100) {
          analytics.splice(0, analytics.length - 100);
        }
        localStorage.setItem('vvsChatAnalytics', JSON.stringify(analytics));

        console.log('Chat Event:', event);
      }

      function getSessionId() {
        let sessionId = sessionStorage.getItem('vvsSessionId');
        if (!sessionId) {
          sessionId = 'vvs_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          sessionStorage.setItem('vvsSessionId', sessionId);
        }
        return sessionId;
      }

      function initializeChatSystem() {
        try {
          // Track chat system initialization
          trackChatEvent('chat_initialized');

          // Load previous chat history if exists
          loadChatHistory();

          // Set up periodic connection check
          setInterval(checkConnectionStatus, 30000); // Check every 30 seconds

          // Set up automatic message retry queue
          processRetryQueue();

          console.log('‚úÖ Chat system initialized with Zapier webhook to (402) 979-7184');
        } catch (error) {
          console.error('‚ùå Error initializing chat system:', error);
          console.log('‚ÑπÔ∏è Chat will still work with basic functionality');
        }
      }

      function checkConnectionStatus() {
        if (navigator.onLine) {
          updateConnectionStatus('online');
        } else {
          updateConnectionStatus('offline');
          // Queue messages for retry when back online
          queueOfflineMessages();
        }
      }

      function updateConnectionStatus(status) {
        const statusElement = document.querySelector('.agent-status span');
        if (statusElement) {
          if (status === 'online') {
            statusElement.textContent = 'Messages sent to (402) 979-7184';
            statusElement.style.color = '';
          } else {
            statusElement.textContent = 'Offline - messages queued';
            statusElement.style.color = '#ef4444';
          }
        }
      }

      let messageRetryQueue = [];

      function queueOfflineMessages() {
        // This would queue messages when offline
        console.log('Queuing messages for retry when online');
      }

      function processRetryQueue() {
        if (messageRetryQueue.length > 0 && navigator.onLine) {
          const message = messageRetryQueue.shift();
          sendSMSWithRetry(message).catch(() => {
            // If still fails, put back in queue
            messageRetryQueue.push(message);
          });
        }

        // Process queue every 10 seconds
        setTimeout(processRetryQueue, 10000);
      }

      // Quick action functions (COMMENTED OUT - DUPLICATES MOVED TO TOP)
      /*function callDirectly() {
        trackChatEvent('call_attempted');
        window.location.href = 'tel:+14029797184';
        addAgentMessage("üìû Calling now... If I don't answer, please leave a voicemail and I'll call you back ASAP!");
      }

      function emailDirectly() {
        try {
          trackChatEvent('email_attempted');
          const subject = encodeURIComponent('Visual Vibe Studio - Inquiry from Website Chat');
          const body = encodeURIComponent(`Hi Yoshiko,

I was using the chat on your website and wanted to reach out directly.

Customer Information:
${currentUser ? `Name: ${currentUser.name}\nEmail: ${currentUser.email}` : 'Website Visitor (not signed in)'}

Please get back to me when you have a chance!

Thanks,
`);

          const emailUrl = `mailto:support@visualvibestudio.store?subject=${subject}&body=${body}`;

          // Check if we're on mobile
          const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

          if (isMobile) {
            // On mobile, try to open email app directly
            window.open(emailUrl, '_blank');
            addAgentMessage("üìß Opening your email app! I'll respond to your email as soon as possible.");
          } else {
            // On desktop, provide options
            showEmailOptionsModal('support@visualvibestudio.store');
            addAgentMessage("üìß I've opened contact options for you. Choose your preferred way to email me!");
          }
        } catch (error) {
          console.error('Error in emailDirectly:', error);
          addAgentMessage("üìß To email me directly, please use: support@visualvibestudio.store or call me at (402) 979-7184");
        }
      }

      // Make chat action functions globally available (COMMENTED OUT - MOVED TO TOP)
      // window.callDirectly = callDirectly;
      // window.emailDirectly = emailDirectly;*/

      // Enhanced message sending with delivery confirmation
      function addAgentMessage(message) {
        const messagesContainer = document.getElementById('chatMessages');
        const messageElement = document.createElement('div');
        messageElement.className = 'chat-message agent';
        const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        messageElement.innerHTML = `
          <div>
            <div>${message}</div>
            <div class="text-xs opacity-70 mt-1">${timestamp}</div>
          </div>
        `;
        messagesContainer.appendChild(messageElement);
        scrollToBottom();

        // Save message to history
        saveChatMessage('agent', message, timestamp);

        // Show notification if chat is closed
        if (!chatOpen) {
          showChatNotification();
        }
      }

      function hideTypingIndicator() {
        const typingIndicator = document.getElementById('typingIndicator');
        if (typingIndicator) {
          typingIndicator.remove();
        }
      }

      function generateAgentResponse(userMessage) {
        const message = userMessage.toLowerCase();

        // Simple keyword-based responses
        if (message.includes('price') || message.includes('cost') || message.includes('how much')) {
          return "Our services range from $25 for logos to $100+ for websites. The exact price depends on your specific needs. Would you like detailed pricing for a particular service?";
        }

        if (message.includes('website') || message.includes('site')) {
          return "Our business websites start at $100 and include responsive design, professional layout, and mobile optimization. The final price depends on features like e-commerce, number of pages, and custom functionality. What type of website are you looking for?";
        }

        if (message.includes('logo')) {
          return "Our logo design service is $25 and includes a professional, unique design that represents your brand identity. We provide the logo in multiple formats suitable for web and print. Would you like to get started with a logo design?";
        }

        if (message.includes('business card')) {
          return "Business card design is $50 and includes a unique, professional design that matches your brand. We provide print-ready files. Do you have existing branding we should match?";
        }

        if (message.includes('flyer') || message.includes('brochure')) {
          return "We offer flyer design for $65 and brochure design for $80. Both include professional layouts perfect for marketing your business. What type of content will you be promoting?";
        }

        if (message.includes('time') || message.includes('when') || message.includes('delivery')) {
          return "Our typical turnaround time is 5-10 business days depending on the project complexity. We can discuss rush orders if you need something faster. What's your ideal timeline?";
        }

        if (message.includes('payment') || message.includes('pay')) {
          return "We accept payment through Venmo (@Yoshiko-Swafford). We require a 50% deposit to start your project, and the remaining 50% is due when you approve the final design.";
        }

        if (message.includes('revision') || message.includes('change')) {
          return "Yes! Each project includes up to 3 rounds of revisions to ensure you're completely satisfied. We want to make sure the final design is exactly what you need for your business.";
        }

        if (message.includes('hello') || message.includes('hi') || message.includes('hey')) {
          return "Hello! Welcome to Visual Vibe Studio! I'm here to help you with any questions about our design services. Are you looking for a website, logo, business cards, or something else?";
        }

        if (message.includes('help') || message.includes('question')) {
          return "I'm here to help! You can ask me about our services, pricing, turnaround times, payment methods, or anything else related to your design needs. What would you like to know?";
        }

        if (message.includes('contact') || message.includes('phone') || message.includes('email')) {
          return "You can reach us at support@visualvibestudio.store or call (402) 979-7184. We typically respond within 2-4 hours during business hours (Mon-Fri 9AM-6PM, Sat 10AM-4PM).";
        }

        if (message.includes('order') || message.includes('start') || message.includes('begin')) {
          return "Great! You can place an order directly through our website by scrolling up to the 'Place Your Order' section. If you have specific questions about your project, I'm here to help first!";
        }

        // Default responses
        return agentResponses[Math.floor(Math.random() * agentResponses.length)];
      }

      function showChatNotification() {
        try {
          const notification = document.getElementById('chatNotification');
          if (notification) {
            notification.classList.remove('hidden');
            hasUnreadMessages = true;
          } else {
            console.warn('Chat notification element not found');
          }
        } catch (error) {
          console.error('Error showing chat notification:', error);
        }
      }

      function scrollToBottom() {
        try {
          const messagesContainer = document.getElementById('chatMessages');
          if (messagesContainer) {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
          } else {
            console.warn('Messages container not found for scroll');
          }
        } catch (error) {
          console.error('Error scrolling to bottom:', error);
        }
      }

      // handleChatKeyPress function (defined at script start to fix ReferenceError)

      function updateSendButton() {
        try {
          const input = document.getElementById('chatInput');
          const sendBtn = document.getElementById('chatSendBtn');

          if (!input || !sendBtn) {
            console.warn('Chat input or send button not found for update');
            return;
          }

          sendBtn.disabled = !input.value.trim();
        } catch (error) {
          console.error('Error updating send button:', error);
        }
      }

      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // Enhanced email click handler with better functionality
      function handleEnhancedEmailClick(event, emailAddress) {
        try {
          const button = event.target.closest('a');
          const buttonText = document.getElementById('sendEmailBtnText');

          // Provide visual feedback
          if (buttonText) {
            buttonText.textContent = 'Opening...';
            button.classList.add('opacity-75');
          }

          // Reset button after a short delay
          setTimeout(() => {
            if (buttonText) {
              buttonText.textContent = 'Send Email';
              button.classList.remove('opacity-75');
            }
          }, 2000);

          // Check if we're on a mobile device
          const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

          if (isMobile) {
            // On mobile, let the default mailto behavior work
            showAlert('Opening your email app...', 'info');
            return true;
          }

          // On desktop, check if mailto is supported
          const mailtoSupported = 'mailto:' === document.createElement('a').protocol ||
                                 window.navigator.userAgent.includes('mailto');

          if (mailtoSupported) {
            // Try mailto first
            showAlert('Opening your default email client...', 'info');
            return true;
          } else {
            // Fallback to modal with multiple options
            event.preventDefault();
            showEmailOptionsModal(emailAddress);
            return false;
          }
        } catch (error) {
          console.error('Error in enhanced email click:', error);
          // Fallback to default behavior
          return true;
        }
      }

      // Desktop-friendly email functions
      function handleEmailClick(event, emailAddress) {
        // Check if we're on a mobile device or if mailto is supported
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        if (isMobile) {
          // On mobile, let the default mailto behavior work
          return true;
        }

        // On desktop, provide fallback options
        event.preventDefault();
        showEmailOptionsModal(emailAddress);
      }

      function showEmailOptionsModal(emailAddress) {
        // Create modal overlay
        const modal = document.createElement('div');
        modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        modal.onclick = (e) => {
          if (e.target === modal) closeEmailModal();
        };

        modal.innerHTML = `
          <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-2xl font-bold text-gray-800">Contact Options</h3>
              <button onclick="closeEmailModal()" class="text-gray-500 hover:text-gray-700">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>

            <div class="space-y-4">
              <div class="bg-gray-50 rounded-lg p-4">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="font-medium text-gray-800">Email Address</p>
                    <p class="text-indigo-600 font-mono">${emailAddress}</p>
                  </div>
                  <button
                    onclick="copyToClipboard('${emailAddress}', 'Email copied!'); closeEmailModal();"
                    class="bg-indigo-100 text-indigo-600 px-4 py-2 rounded-lg hover:bg-indigo-200 transition-colors"
                  >
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                    </svg>
                  </button>
                </div>
              </div>

              <div class="space-y-3">
                <button
                  onclick="window.location.href='mailto:${emailAddress}'; closeEmailModal();"
                  class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-indigo-700 transition-colors flex items-center justify-center gap-2"
                >
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                  </svg>
                  Open in Email App
                </button>

                <button
                  onclick="window.open('https://mail.google.com/mail/?view=cm&fs=1&to=${emailAddress}', '_blank'); closeEmailModal();"
                  class="w-full bg-red-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-red-600 transition-colors flex items-center justify-center gap-2"
                >
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-.887.732-1.636 1.636-1.636h3.819l6.545 4.91 6.545-4.91h3.819c.904 0 1.636.749 1.636 1.636z"/>
                  </svg>
                  Open in Gmail
                </button>

                <button
                  onclick="window.open('https://outlook.live.com/mail/0/deeplink/compose?to=${emailAddress}', '_blank'); closeEmailModal();"
                  class="w-full bg-blue-500 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-600 transition-colors flex items-center justify-center gap-2"
                >
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M7.88 12.04q0 .45-.11.87-.1.41-.33.74-.22.33-.58.52-.37.2-.87.2t-.85-.2q-.35-.21-.57-.55-.22-.33-.33-.75-.1-.42-.1-.83 0-.43.1-.85.11-.41.33-.74.22-.34.57-.55.35-.2.85-.2t.87.2q.36.19.58.52.22.33.33.74.11.42.11.88zM24 12v9.38q0 .46-.33.8-.33.32-.8.32H7.13q-.46 0-.8-.33-.32-.33-.32-.8V18H1q-.41 0-.7-.3-.3-.29-.3-.7V7q0-.41.3-.7Q.58 6 1 6h6.5L9 4.4q.25-.4.65-.7.4-.3.9-.3H23q.41 0 .7.3.3.29.3.7v7.6z"/>
                  </svg>
                  Open in Outlook
                </button>
              </div>

              <div class="text-center pt-4 border-t">
                <p class="text-sm text-gray-600">Or call us directly:</p>
                <a href="tel:+14029797184" class="text-green-600 font-semibold hover:text-green-800 transition-colors">
                  (402) 979-7184
                </a>
              </div>
            </div>
          </div>
        `;

        document.body.appendChild(modal);
      }

      function openEmailWithFeedback(url) {
        try {
          window.open(url, '_blank');
          showAlert('Opening email application...', 'info');
        } catch (error) {
          console.error('Error opening email:', error);
          showAlert('Unable to open email. Please copy the email address and contact us manually.', 'error');
        }
      }

      function closeEmailModal() {
        const modal = document.querySelector('.fixed.inset-0.bg-black.bg-opacity-50');
        if (modal) {
          modal.remove();
        }
      }

      // Review System Functionality (selectedRating defined at script start)

      function initializeReviewSystem() {
        try {
          console.log('Initializing review system...');

          // Debug: Check if elements exist
          const reviewForm = document.getElementById('reviewForm');
          const reviewsContainer = document.getElementById('reviewsContainer');
          console.log('Review form found:', !!reviewForm);
          console.log('Reviews container found:', !!reviewsContainer);

          // Set up star rating functionality
          const starButtons = document.querySelectorAll('.star-rating');
          console.log('‚≠ê Found', starButtons.length, 'star buttons');

          // Remove any existing event listeners first
          starButtons.forEach(star => {
            star.replaceWith(star.cloneNode(true));
          });

          // Re-select the newly cloned star buttons
          const newStarButtons = document.querySelectorAll('.star-rating');

          newStarButtons.forEach(star => {
            // Click handler for setting rating
            star.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              const rating = parseInt(this.dataset.rating);
              console.log('‚≠ê Star clicked:', rating);
              setRating(rating);
            });

            // Hover effects
            star.addEventListener('mouseenter', function() {
              const hoverRating = parseInt(this.dataset.rating);
              highlightStars(hoverRating);
            });

            star.addEventListener('mouseleave', function() {
              updateStarDisplay();
            });
          });

          // Reset star display on container mouse leave
          const starContainer = document.querySelector('.star-rating');
          if (starContainer && starContainer.parentElement) {
            starContainer.parentElement.addEventListener('mouseleave', function() {
              updateStarDisplay();
            });
          }

          console.log('‚úÖ Star rating event listeners attached successfully');

          // Force initial star display update
          updateStarDisplay();

          // Test star functionality immediately
          setTimeout(() => {
            console.log('üß™ Testing star rating system...');
            const testStarButtons = document.querySelectorAll('.star-rating');
            if (testStarButtons.length === 5) {
              console.log('‚úÖ All 5 star buttons found and ready');
            } else {
              console.error('‚ùå Expected 5 star buttons, found:', testStarButtons.length);
            }
          }, 100);

          // Character counter for review text
          const reviewTextArea = document.getElementById('reviewText');
          const charCount = document.getElementById('charCount');

          if (reviewTextArea && charCount) {
            reviewTextArea.addEventListener('input', function() {
              charCount.textContent = this.value.length;
            });
          }

          // Review form submission
          const reviewForm = document.getElementById('reviewForm');
          if (reviewForm) {
            reviewForm.addEventListener('submit', handleReviewSubmission);
            console.log('‚úÖ Review form event listener added');

            // Also add onclick to submit button as backup
            const submitButton = reviewForm.querySelector('button[type="submit"]');
            if (submitButton) {
              // Add backup onclick handler
              submitButton.onclick = function(e) {
                console.log('üìù Submit button clicked directly');
                e.preventDefault();
                return submitReview(e);
              };
              console.log('‚úÖ Review submit button onclick added as backup');
            } else {
              console.warn('‚ö†Ô∏è Review submit button not found');
            }
          } else {
            console.error('‚ùå Review form not found');
          }

          // Verify all review form elements exist
          const formElements = {
            reviewerName: document.getElementById('reviewerName'),
            businessType: document.getElementById('businessType'),
            serviceUsed: document.getElementById('serviceUsed'),
            reviewText: document.getElementById('reviewText'),
            selectedRating: document.getElementById('selectedRating')
          };

          console.log('üìã Review form elements verification:');
          Object.keys(formElements).forEach(key => {
            console.log(`  ${key}:`, !!formElements[key]);
          });

          // Load and display existing reviews
          console.log('Loading reviews...');
          loadReviews();

          // Force reload after a short delay to ensure DOM is ready
          setTimeout(() => {
            console.log('üîÑ Force loading reviews after delay...');
            const storedReviews = JSON.parse(localStorage.getItem('visualVibeReviews') || '[]');
            console.log('üì¶ Found stored reviews:', storedReviews.length);
            if (storedReviews.length > 0) {
              console.log('üìù First review:', storedReviews[0]);
              loadReviews();
            }
          }, 1000);

          console.log('‚úÖ Review system initialized successfully');
        } catch (error) {
          console.error('Error initializing review system:', error);
        }
      }

      // highlightStars function (defined at script start to fix ReferenceError)

      // Rating functions (defined at script start to fix ReferenceError)

      // submitReview function (defined at script start to fix ReferenceError)

      // Test function for debugging review submission
      function testReviewSubmission() {
        console.log('üß™ Testing review submission...');

        // Set test values
        const testName = document.getElementById('reviewerName');
        const testBusiness = document.getElementById('businessType');
        const testService = document.getElementById('serviceUsed');
        const testReview = document.getElementById('reviewText');

        if (testName) testName.value = 'Test Customer';
        if (testBusiness) testBusiness.value = 'Test Business';
        if (testService) testService.value = 'Business Website';
        if (testReview) testReview.value = 'This is a test review to verify the submission system is working.';

        // Set test rating
        setRating(5);

        // Try to submit
        submitReview();
      }

      // Debug function for troubleshooting review system
      function debugReviewSystem() {
        console.log('üîß DEBUG: Review System Status');
        console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');

        // Check form elements
        const elements = {
          reviewerName: document.getElementById('reviewerName'),
          businessType: document.getElementById('businessType'),
          serviceUsed: document.getElementById('serviceUsed'),
          reviewText: document.getElementById('reviewText'),
          selectedRating: document.getElementById('selectedRating')
        };

        console.log('üìã Form Elements:');
        Object.keys(elements).forEach(key => {
          const el = elements[key];
          console.log(`  ${key}:`, el ? `‚úÖ Found (value: "${el.value}")` : '‚ùå Not found');
        });

        // Check rating variables
        console.log('‚≠ê Rating Variables:');
        console.log('  selectedRating (local):', selectedRating);
        console.log('  window.selectedRating:', window.selectedRating);
        console.log('  hidden input value:', elements.selectedRating ? elements.selectedRating.value : 'N/A');

        // Check star buttons
        const starButtons = document.querySelectorAll('.star-rating');
        console.log('‚≠ê Star Buttons:');
        console.log('  Found:', starButtons.length, 'star buttons');
        starButtons.forEach((star, index) => {
          console.log(`  Star ${index + 1}:`, star.dataset.rating, star.classList.contains('active') ? '(active)' : '(inactive)');
        });

        // Check functions
        console.log('üîß Functions:');
        console.log('  setRating:', typeof setRating);
        console.log('  submitReview:', typeof submitReview);
        console.log('  loadReviews:', typeof loadReviews);

        // Check localStorage
        const reviews = JSON.parse(localStorage.getItem('visualVibeReviews') || '[]');
        console.log('üíæ Local Storage:');
        console.log('  Stored reviews:', reviews.length);

        alert(`Debug completed! Check console for details.\n\nQuick Status:\n- Form elements: ${Object.values(elements).filter(el => el).length}/5 found\n- Current rating: ${selectedRating || 'None'}\n- Stored reviews: ${reviews.length}\n- Star buttons: ${starButtons.length}`);
      }

      // Make functions globally accessible
      window.submitReview = submitReview;
      window.setRating = setRating;
      window.toggleAllReviews = toggleAllReviews;
      window.loadReviews = loadReviews;
      window.testReviewSubmission = testReviewSubmission;
      window.debugReviewSystem = debugReviewSystem;

      // Quick test function
      function quickTestReview() {
        console.log('‚ö° Quick test review starting...');

        // Fill form with test data
        document.getElementById('reviewerName').value = 'Test Customer';
        document.getElementById('businessType').value = 'Test Business';
        document.getElementById('serviceUsed').value = 'Business Website';
        document.getElementById('reviewText').value = 'This is a test review to verify the system is working correctly.';

        // Set rating
        window.setRating(5);

        console.log('Test data filled, submitting...');

        // Submit after a short delay
        setTimeout(() => {
          window.submitReview();
        }, 500);
      }

      window.quickTestReview = quickTestReview;

      // toggleAllReviews function (defined at script start to fix ReferenceError)

      function handleReviewSubmission(e) {
        try {
          console.log('üìù Form submission event triggered:', e);
          console.log('üìù Event type:', e.type);
          return submitReview(e);
        } catch (error) {
          console.error('‚ùå Error in handleReviewSubmission:', error);
          if (e) e.preventDefault();
          alert('Error processing review submission. Please try again.');
          return false;
        }
      }

      function saveReview(review) {
        const reviews = JSON.parse(localStorage.getItem('visualVibeReviews') || '[]');
        reviews.unshift(review); // Add to beginning of array
        localStorage.setItem('visualVibeReviews', JSON.stringify(reviews));
      }





      // Advanced SMS Integration (Optional - requires Twilio setup)
      async function sendSMSViaTwilio(message) {
        // To enable this feature:
        // 1. Sign up for Twilio at https://www.twilio.com
        // 2. Get your Account SID and Auth Token
        // 3. Purchase a phone number
        // 4. Set up a server endpoint to handle SMS sending

        const twilioConfig = {
          // accountSid: 'your_account_sid_here',
          // authToken: 'your_auth_token_here',
          // fromNumber: 'your_twilio_phone_number',
          toNumber: '+14029797184' // Yoshiko's phone number
        };

        // This would require a server-side endpoint due to CORS and security
        // Example server endpoint: POST /api/send-sms
        /*
        const response = await fetch('/api/send-sms', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            to: twilioConfig.toNumber,
            message: message
          })
        });

        if (!response.ok) {
          throw new Error('Failed to send SMS');
        }

        return response.json();
        */

        // For now, we'll use the email-to-SMS gateway approach
        console.log('Twilio integration not configured, using email-to-SMS gateway');
        return Promise.resolve();
      }

      // Initialize chat input event listener
      document.addEventListener('DOMContentLoaded', function() {
        // Wait a bit to ensure all DOM elements are fully loaded
        setTimeout(() => {
          try {
            // Verify all required chat elements exist
            const requiredElements = [
              'chatWindow',
              'chatBubble',
              'chatIcon',
              'closeIcon',
              'chatMessages',
              'chatInput',
              'chatSendBtn'
            ];

            const missingElements = [];
            requiredElements.forEach(id => {
              if (!document.getElementById(id)) {
                missingElements.push(id);
              }
            });

            if (missingElements.length > 0) {
              console.error('Missing chat elements:', missingElements);
              showAlert('Chat system initialization failed. Some elements are missing. Please refresh the page.', 'error');
              return;
            }

            // Set up chat input event listener
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
              chatInput.addEventListener('input', function() {
                updateSendButton();
              });

              // Initialize send button state
              updateSendButton();
            }

            // Initialize chat system
            initializeChatSystem();

            // Mark as initialized
            chatInitialized = true;

            // Set up order form enhancements
            setupOrderFormEnhancements();

            console.log('‚úÖ Chat system initialized successfully');

            // Run diagnostics after everything is initialized
            setTimeout(() => {
              diagnoseAndRepair();
            }, 1000);
          } catch (error) {
            console.error('‚ùå Error initializing chat system:', error);
            showAlert('Chat system failed to initialize. Please refresh the page or contact us directly.', 'error');
          }
        }, 100);
      });

        // Show notification after 10 seconds if user hasn't opened chat
        setTimeout(() => {
          if (!chatOpen && !hasUnreadMessages) {
            showChatNotification();
          }
        }, 10000);
      });

      // Order Form Handler (DISABLED - now using simpleOrderSubmit for button clicks)
      // The order form is now handled by the simpleOrderSubmit() function called via button onclick
      /*
      if (document.getElementById("orderForm")) {
        document
          .getElementById("orderForm")
          .addEventListener("submit", function (e) {
            e.preventDefault();

            try {
              // Validate form
              const form = e.target;
              if (!form.checkValidity()) {
                form.reportValidity();
                return;
              }

              const submitBtn = form.querySelector('button[type="submit"]');
              if (submitBtn) {
                submitBtn.style.display = "none";
              }

              // Calculate pricing
            const pricing = calculateOrderTotal();

            // Validate pricing
            if (!pricing || !pricing.total || !pricing.deposit) {
              showAlert("Error calculating order total. Please refresh and try again.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

            if (parseFloat(pricing.total) <= 0) {
              showAlert("Please select at least one service.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

            if (parseFloat(pricing.deposit) <= 0) {
              showAlert("Error calculating deposit amount. Please contact us directly.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

              // Get form data
            const formData = new FormData(form);
            const servicesSelect = form.querySelector(
              'select[name="services"]',
            );

            if (!servicesSelect || servicesSelect.selectedOptions.length === 0) {
              showAlert("Please select at least one service.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

            const selectedServices = Array.from(servicesSelect.selectedOptions).map(
              (option) => option.text || 'Unknown Service',
            );

            // Validate required fields
            const businessName = formData.get("businessName");
            const email = formData.get("email");
            const industry = formData.get("industry");

            if (!businessName || businessName.trim() === '') {
              showAlert("Please enter your business name.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

            if (!email || email.trim() === '' || !email.includes('@')) {
              showAlert("Please enter a valid email address.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

            if (!industry || industry.trim() === '') {
              showAlert("Please enter your business industry.", "error");
              if (submitBtn) submitBtn.style.display = "block";
              return;
            }

              const orderData = {
              businessName: businessName.trim(),
              industry: industry.trim(),
              services: selectedServices,
              email: email.trim(),
              phone: formData.get("phone") || "N/A",
              dueDate: formData.get("dueDate") || "N/A",
            };

              // Save order to user account if signed in
              const orderNumber = saveOrderToAccount(orderData, pricing);

              // Show Venmo payment
              showVenmoPayment(pricing, orderData, orderNumber);
            } catch (error) {
              console.error("Error in order form submission:", error);
              showAlert(
                "An error occurred. Please try again or contact us directly.",
                "error",
              );
              const submitBtn = form.querySelector('button[type="submit"]');
              if (submitBtn) submitBtn.style.display = "block";
            }
          });
      }
      */

      // Business hours check for online status
      function isBusinessHours() {
        const now = new Date();
        const day = now.getDay(); // 0 = Sunday, 1 = Monday, etc.
        const hour = now.getHours();

        // Business hours: Monday-Friday 9 AM to 6 PM (18:00)
        // Adjust timezone if needed - currently using local time
        if (day >= 1 && day <= 5) { // Monday to Friday
          return hour >= 9 && hour < 18; // 9 AM to 6 PM
        }

        return false; // Not business hours on weekends
      }

      function updateOnlineStatus() {
        const onlineStatusElement = document.getElementById('onlineStatus');
        if (!onlineStatusElement) return;

        if (isBusinessHours()) {
          onlineStatusElement.style.display = 'flex';
        } else {
          onlineStatusElement.style.display = 'none';
        }
      }

      // Update online status immediately
      updateOnlineStatus();

      // Update online status every minute to handle hour changes
      setInterval(updateOnlineStatus, 60000);

      // Make functions globally available for testing
      window.isBusinessHours = isBusinessHours;
      window.updateOnlineStatus = updateOnlineStatus;
    </script>
    <!-- Hidden Netlify form for order submissions -->
    <form name="order-submissions" netlify style="display: none;">
      <input type="text" name="business-name" />
      <input type="text" name="industry" />
      <input type="email" name="email" />
      <input type="tel" name="phone" />
      <input type="text" name="services" />
      <input type="text" name="total-amount" />
      <input type="text" name="deposit-amount" />
      <input type="date" name="due-date" />
      <textarea name="details"></textarea>
      <textarea name="message"></textarea>
      <input type="text" name="subject" />
    </form>
  </body>
</html>
